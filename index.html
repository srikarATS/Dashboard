<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Dairy Management System - Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #0077b6;
            --secondary: #00b4d8;
            --dark: #caf0f8;
            --light: #ffffff;
            --text: #03045e;
            --success: #2a9d8f;
            --warning: #e9c46a;
            --danger: #e76f51;
            --gray: #adb5bd;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--text);
        }

        /* ============ HEADER ============ */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 90px;
            background: #fff;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .hdr-left,
        .hdr-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .hdr-left button {
            font-size: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
            color: var(--primary);
        }

        .hdr-left button:hover {
            transform: scale(1.1);
        }

        .hdr-logo {
            height: 60px;
            cursor: pointer;
            transition: transform 0.2s;
            width: 150px;
        }



        .hdr-search {
            padding: 8px 15px;
            border-radius: 6px;
            border: 1px solid #ccc;
            min-width: 200px;
            transition: all 0.3s;
        }

        .hdr-search:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .hdr-icon {
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.2s;
            padding: 8px;
            border-radius: 50%;
            color: var(--text);
        }

        .hdr-icon:hover {
            background: #f3f4f6;
            transform: scale(1.1);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        /* Dropdown styles */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #fff;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            z-index: 1;
            border-radius: 8px;
            padding: 8px 0;
            right: 0;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .dropdown-item {
            padding: 8px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .dropdown-item:hover {
            background-color: #f3f4f6;
        }

        .dropdown-btn {
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 1rem;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.2s;
            color: var(--text);
        }

        .dropdown-btn:hover {
            background-color: #f3f4f6;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .dot.green {
            background: var(--success);
        }

        .dot.red {
            background: var(--danger);
        }

        .dot.gray {
            background: var(--gray);
        }

        /* Profile section */
        .profile-section {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .profile-section:hover {
            background-color: #f3f4f6;
        }

        .profile-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .profile-name {
            font-weight: 600;
            margin-right: 5px;
        }

        /* Main container */
        .main-container {
            display: flex;
            margin-top: 2px;
            min-height: calc(100vh - 80px);
        }

        /* Sidebar styles */
        .sidebar {
            width: 275px;
            background-color: var(--light);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px 0;
            transition: transform 0.3s ease;
            z-index: 900;
        }

        .sidebar-menu ul {
            list-style: none;
        }

        .sidebar-menu li {
            position: relative;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            color: var(--text);
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 20px;
        }

        .sidebar-menu a:hover {
            background-color: var(--dark);
            color: var(--primary);
        }

        .sidebar-menu a.active {
            background-color: var(--primary);
            color: white;
        }

        .sidebar-menu a i {
            width: 20px;
            text-align: center;
        }

        .submenu {
            list-style: none;
            padding-left: 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .submenu.show {
            max-height: 500px;
        }

        .submenu a {
            padding: 10px 20px 10px 30px;
            font-size: 16px;
        }

        .has-submenu>a::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            margin-left: auto;
            font-size: 0.8rem;
            transition: transform 0.3s ease;
        }

        .has-submenu>a.expanded::after {
            transform: rotate(180deg);
        }

        .content-area {
            flex: 1;
            padding: 2px;
            background-color: #f5f7fa;
            overflow-y: auto;
        }

        /* Child section styles */
        .child-section {
            display: none;
            padding: 20px;
        }

        .child-section.active {
            display: block;
        }

        .back-button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 20px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .back-button:hover {
            background-color: var(--secondary);
        }

        .content-section {
            background-color: var(--light);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--dark);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--dark);
        }

        .section-title {
            color: var(--primary);
            font-size: 1.4rem;
        }

        .section-link {
            color: var(--primary);
            text-decoration: none;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: color 0.3s;
        }

        .section-link:hover {
            color: var(--secondary);
        }

        /* Table styles */
        .recent-orders {
            width: 100%;
            border-collapse: collapse;
        }

        .recent-orders th,
        .recent-orders td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--dark);
        }

        .recent-orders th {
            font-weight: 600;
            color: var(--primary);
            background-color: var(--dark);
        }

        .recent-orders tr:hover {
            background-color: var(--dark);
        }

        /* Status badges */
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status.completed {
            background-color: rgba(102, 187, 106, 0.1);
            color: var(--success);
        }

        .status.pending {
            background-color: rgba(239, 83, 80, 0.1);
            color: var(--danger);
        }

        .status.scheduled {
            background-color: rgba(66, 165, 245, 0.1);
            color: var(--secondary);
        }

        /* Buttons */
        .btn-primary {
            background-color: var(--primary);
            color: white;
            border-radius: 4px;
            padding: 8px 15px;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn-primary:hover {
            background-color: #3949ab;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
            border-radius: 4px;
            padding: 8px 15px;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn-success:hover {
            background-color: #43a047;
        }

        .edit-btn {
            background-color: var(--warning);
            color: #5d4037;
            border-radius: 4px;
            padding: 8px 15px;
            margin-top: 10px;
            font-weight: 500;
            border: none;
            cursor: pointer;
        }

        .edit-btn:hover {
            background-color: #fbc02d;
        }

        /* Profile form styles */
        .profile-grid {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .profile-grid label {
            font-size: 1.1rem;
            font-weight: bold;
            align-self: center;
            color: var(--primary);
        }

        .avatar-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            align-items: center;
        }

        .avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 36px;
            font-weight: bold;
            flex-shrink: 0;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .avatar-input {
            display: none;
        }

        /* Form elements */
        input,
        textarea,
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--dark);
            border-radius: 4px;
            margin-bottom: 10px;
            transition: border 0.3s;
            font-size: 1rem;
        }

        input:focus,
        textarea:focus,
        select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(92, 107, 192, 0.2);
        }

        input[readonly],
        textarea[readonly] {
            background-color: #f5f5f5;
            cursor: not-allowed;
        }

        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background-color: var(--light);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .stat-title {
            font-size: 0.9rem;
            font-weight: bold;
            color: black;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 0.8rem;
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stat-change.down {
            color: var(--danger);
        }

        .stat-chart {
            height: 170px;
            margin-top: auto;
        }

        /* Activity list */
        .activity-list {
            list-style: none;
        }

        .activity-item {
            display: flex;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid var(--dark);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--dark);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 500;
            margin-bottom: 5px;
        }

        .activity-time {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Product cards */
        .top-products {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .product-card {
            background-color: var(--light);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .product-image {
            height: 120px;
            background-color: var(--dark);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-image img {
            max-width: 100%;
            max-height: 100%;
        }

        .product-info {
            padding: 15px;
        }

        .product-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .product-category {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .product-stats {
            display: flex;
            justify-content: space-between;
        }

        .product-price {
            font-weight: 600;
            color: var(--primary);
        }

        .product-sales {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Add these styles to your existing CSS */
        .activity-timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline-item {
            position: relative;
            padding-bottom: 20px;
        }

        .timeline-marker {
            position: absolute;
            left: -30px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .timeline-marker.success {
            background-color: var(--success);
        }

        .timeline-marker.warning {
            background-color: var(--warning);
        }

        .timeline-marker.danger {
            background-color: var(--danger);
        }

        .timeline-marker.info {
            background-color: var(--secondary);
        }

        .timeline-content {
            padding: 10px 15px;
            background-color: white;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .timeline-title {
            font-weight: 600;
        }

        .timeline-time {
            color: var(--gray);
            font-size: 0.8rem;
        }

        .timeline-details {
            font-size: 0.9rem;
            color: #555;
        }

        .permission-matrix {
            width: 100%;
            border-collapse: collapse;
        }

        .permission-matrix th,
        .permission-matrix td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid var(--dark);
        }

        .permission-matrix th {
            background-color: var(--dark);
            font-weight: 600;
        }

        .permission-matrix td:first-child {
            text-align: left;
            font-weight: 500;
        }

        .success {
            color: var(--success);
        }

        .danger {
            color: var(--danger);
        }

        /* Toggle switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            background-color: #ccc;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--success);
        }

        input:checked+.slider:before {
            transform: translateX(24px);
        }

        /* Settings items */
        .setting-item {
            margin-bottom: 20px;
        }

        .setting-label {
            font-weight: bold;
            display: block;
            margin-bottom: 8px;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-group label {
            font-size: 1rem;
        }

        /* Responsive styles */
        @media (max-width: 992px) {
            .sidebar {
                position: fixed;
                top: 80px;
                bottom: 0;
                left: 0;
                transform: translateX(-100%);
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .content-area {
                margin-left: 0;
            }
        }

        /* Ensure proper scrolling */
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .main-container {
            position: fixed;
            top: 80px;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            overflow: hidden;
        }

        .sidebar {
            height: 100%;
            overflow-y: auto;
        }

        .content-area {
            flex: 1;
            height: 100%;
            overflow-y: auto;
        }

        .feedback-theme {
            --primary: #9b5de5;
            --secondary: #f15bb5;
            --success: #00bbf9;
            --danger: #f71735;
            --warning: #ff9f1c;
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .content-area.expanded {
            margin-left: 0 !important;
            flex: 1;
        }


        .sidebar.collapsed {
            display: none !important;
        }

        .content-area.expanded {
            width: 100% !important;
            margin: 0 !important;
            padding: 20px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</head>

<body>
    <!-- Header/Navbar -->
    <header>
        <div class="hdr-left">
            <img alt="Logo" class="hdr-logo" onclick="showSection('dashboard-section')"
                src="https://www.astrolitetech.com/assets/images/logo.png" />
            <button onclick="toggleSidebar()">☰</button>
        </div>
        <div class="hdr-right">
            <input class="hdr-search" placeholder="Search..." type="text" />
            <i class="fas fa-bell hdr-icon"></i>
            <i class="fas fa-envelope hdr-icon"></i>
            <!-- Language Dropdown -->
            <div class="dropdown">
                <button class="dropdown-btn">
                    <span class="dot green"></span> English
                </button>
                <div class="dropdown-content">
                    <div class="dropdown-item" onclick="setLanguage('en')">
                        <span class="dot green"></span> English
                    </div>
                    <div class="dropdown-item" onclick="setLanguage('hi')">
                        <span class="dot red"></span> Hindi
                    </div>
                    <div class="dropdown-item" onclick="setLanguage('te')">
                        <span class="dot gray"></span> Telugu
                    </div>
                    <div class="dropdown-item" onclick="setLanguage('de')">
                        <span class="dot gray"></span> German
                    </div>
                </div>
            </div>
            <!-- Work Mode Dropdown -->
            <div class="dropdown">
                <button class="dropdown-btn">
                    <span class="dot green"></span> Active
                </button>
                <div class="dropdown-content">
                    <div class="dropdown-item" onclick="setWorkMode('active')">
                        <span class="dot green"></span> Active
                    </div>
                    <div class="dropdown-item" onclick="setWorkMode('away')">
                        <span class="dot gray"></span> Away
                    </div>
                    <div class="dropdown-item" onclick="setWorkMode('dnd')">
                        <span class="dot red"></span> Do Not Disturb
                    </div>
                </div>
            </div>
            <!-- Profile Section -->
            <div class="profile-section" onclick="showSection('profile-section')">
                <span class="profile-name">John Doe</span>
                <img alt="Profile" class="profile-img"
                    src="https://t4.ftcdn.net/jpg/02/14/74/61/360_F_214746128_31JkeaP6rU0NzzzdFC4khGkmqc8noe6h.jpg" />
            </div>
        </div>
    </header>
    <!-- Top Navigation Bar -->
    <div class="top-navbar">
        <div class="nav-left">
            <div class="logo">
                <img alt="Dairy Company Logo" src="https://www.astrolitetech.com/assets/images/logo.png" />
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
        <div class="nav-right">
            <div class="search-bar">
                <input placeholder="Search..." type="text" />
            </div>
            <div class="language-selector">
                <button class="language-button" id="languageButton">
                    <img alt="English" class="language-flag" src="https://flagcdn.com/w20/gb.png" />
                    <span>EN</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="language-dropdown" id="languageDropdown">
                    <div class="language-option" data-lang="en">
                        <img alt="English" class="language-flag" src="https://flagcdn.com/w20/gb.png" />
                        <span>English</span>
                    </div>
                    <div class="language-option" data-lang="es">
                        <img alt="Spanish" class="language-flag" src="https://flagcdn.com/w20/es.png" />
                        <span>Español</span>
                    </div>
                    <div class="language-option" data-lang="fr">
                        <img alt="French" class="language-flag" src="https://flagcdn.com/w20/fr.png" />
                        <span>Français</span>
                    </div>
                    <div class="language-option" data-lang="de">
                        <img alt="German" class="language-flag" src="https://flagcdn.com/w20/de.png" />
                        <span>Deutsch</span>
                    </div>
                </div>
            </div>
            <button class="icon-button">
                <svg fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                    stroke-width="2" viewbox="0 0 24 24" width="20">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
                <span class="notification-badge">3</span>
            </button>
            <button class="icon-button">
                <svg fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                    stroke-width="2" viewbox="0 0 24 24" width="20">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                <span class="notification-badge">5</span>
            </button>
            <div class="user-profile" id="userProfile">
                <div class="user-avatar">
                    <img alt="User Profile"
                        src="https://t4.ftcdn.net/jpg/02/14/74/61/360_F_214746128_31JkeaP6rU0NzzzdFC4khGkmqc8noe6h.jpg" />
                    <span class="status-indicator status-active"></span>
                </div>
                <div class="user-name">John Doe</div>
                <div class="status-dropdown" id="statusDropdown">
                    <div class="status-option" data-status="active">
                        <span class="status-indicator status-active"></span>
                        <span>Active</span>
                    </div>
                    <div class="status-option" data-status="away">
                        <span class="status-indicator status-away"></span>
                        <span>Away</span>
                    </div>
                    <div class="status-option" data-status="busy">
                        <span class="status-indicator status-busy"></span>
                        <span>Busy</span>
                    </div>
                    <div class="status-option" data-status="offline">
                        <span class="status-indicator status-offline"></span>
                        <span>Offline</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Main Content Area -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-menu">
                <ul>
                    <li><a class="active nav-link" data-section="dashboard-section" href="#"><i
                                class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a class="nav-link" data-section="profile-section" href="#"><i class="fas fa-user"></i> My
                            Profile</a></li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="farmer-management-section" href="#"><i
                                class="fas fa-user-tie"></i> Farmer Management</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="farmer-registration-section" href="#">Registration</a>
                            </li>
                            <li><a class="nav-link" data-section="payments-section" href="#"> Payments</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="milk-collection-section" href="#"><i
                                class="fas fa-faucet"></i> Milk Collection</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="collection-schedule-section" href="#">Collection
                                    Schedule</a></li>
                            <li><a class="nav-link" data-section="quality-testing-section" href="#">Quality Testing</a>
                            </li>

                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="chilling-centers-section" href="#"><i
                                class="fas fa-warehouse"></i> Chilling Centers</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="inventory-section" href="#">Inventory</a></li>
                            <li><a class="nav-link" data-section="temperature-section" href="#">Temperature
                                    Monitoring</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="processing-plants-section" href="#"><i
                                class="fas fa-industry"></i> Processing Plants</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="production-lines-section" href="#">Production
                                    Lines</a></li>
                            <li><a class="nav-link" data-section="equipment-maintenance-section" href="#">Equipment
                                    Maintenance</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="quality-control-section" href="#"><i class="fas fa-flask"></i>
                            Quality Control</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="product-testing-section" href="#">Product Testing</a>
                            </li>
                            <li><a class="nav-link" data-section="quality-standards-section" href="#">Quality
                                    Standards</a></li>
                            <li><a class="nav-link" data-section="feedback-complaints-section" href="#">Feedback &amp;
                                    Complaints</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="product-inventory-section" href="#"><i
                                class="fas fa-boxes"></i> Product Inventory</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="current-stock-section" href="#">Current Stock</a></li>
                            <li><a class="nav-link" data-section="inventory-movements-section" href="#">Inventory
                                    Movements</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="distribution-section" href="#"><i class="fas fa-truck"></i>
                            Distribution</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="delivery-routes-section" href="#">Delivery Routes</a>
                            </li>
                            <li><a class="nav-link" data-section="fleet-management-section" href="#">Fleet
                                    Management</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="retail-section" href="#"><i class="fas fa-store"></i>
                            Retail</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="retail-outlets-section" href="#">Retail Outlets</a>
                            </li>
                            <li><a class="nav-link" data-section="sales-data-section" href="#">Sales Data</a></li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="reports-section" href="#"><i class="fas fa-chart-pie"></i>
                            Reports</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="production-reports-section" href="#">Production
                                    Reports</a></li>
                            <li><a href="#" onclick="showSection('financial-reports-section')">Financial Reports</a>
                            </li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="settings-section" href="#"><i class="fas fa-cog"></i>
                            Settings</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="user-management-section" href="#">User Management</a>
                            </li>
                            <li><a class="nav-link" data-section="system-settings-section" href="#">System Settings</a>
                            </li>
                        </ul>
                    </li>
                    <li class="has-submenu">
                        <a class="nav-link" data-section="access-control-section" href="#"><i
                                class="fas fa-shield-alt"></i> Access Control</a>
                        <ul class="submenu">
                            <li><a class="nav-link" data-section="user-management-section" href="#">User Management</a>
                            </li>
                            <li><a class="nav-link" data-section="role-permissions-section" href="#">Role
                                    Permissions</a></li>
                            <li><a class="nav-link" data-section="activity-logs-section" href="#">Activity Logs</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Right Content Area -->
        <div class="content-area">
            <!-- Dashboard Section -->
            <div class="child-section active" id="dashboard-section">
                <div class="welcome-message">
                </div>
                <div class="stats-grid">
                    <!-- Card 1: Milk Production -->
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Milk Production</div>
                                <div class="stat-value">250,000 L</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    12.5%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="milkChart"></canvas>
                        </div>
                    </div>
                    <!-- Card 2: Sales Revenue -->
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Sales Revenue</div>
                                <div class="stat-value">$1,200</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    8.3%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="revenueChart"></canvas>
                        </div>
                    </div>
                    <!-- Card 3: Active Farmers -->
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Active Farmers</div>
                                <div class="stat-value">5,000+</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    5.7%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="farmersChart"></canvas>
                        </div>
                    </div>
                    <!-- Card 4: Retail Network -->
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Retail Network</div>
                                <div class="stat-value">1,200</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    8.3%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="retailChart"></canvas>
                        </div>
                    </div>
                    <!-- Card 5: Quality Metrics -->
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Quality Metrics</div>
                                <div class="stat-value">85%</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    95%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="qualityChart"></canvas>
                        </div>
                    </div>
                    <!-- Card 6: Sustainability -->
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Sustainability</div>
                                <div class="stat-value">78%</div>
                                <div class="stat-change down">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                    5.0%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="sustainabilityChart"></canvas>
                        </div>
                    </div>
                </div>
                <!-- Recent Orders Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Recent Milk Collections</h2>
                        <a class="section-link" href="#">View All <i class="fas fa-chevron-right"></i></a>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Collection ID</th>
                                <th>Farmer</th>
                                <th>Center</th>
                                <th>Quantity (L)</th>
                                <th>Fat %</th>
                                <th>SNF %</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>#MC-1001</td>
                                <td>Rajesh Patel</td>
                                <td>Ahmedabad Center</td>
                                <td>45.5</td>
                                <td>4.2</td>
                                <td>8.5</td>
                                <td><span class="status completed">Completed</span></td>
                            </tr>
                            <tr>
                                <td>#MC-1002</td>
                                <td>Sunita Sharma</td>
                                <td>Gandhinagar Center</td>
                                <td>38.0</td>
                                <td>3.8</td>
                                <td>8.3</td>
                                <td><span class="status completed">Completed</span></td>
                            </tr>
                            <tr>
                                <td>#MC-1003</td>
                                <td>Vijay Singh</td>
                                <td>Vadodara Center</td>
                                <td>52.0</td>
                                <td>4.5</td>
                                <td>8.7</td>
                                <td><span class="status processing">Processing</span></td>
                            </tr>
                            <tr>
                                <td>#MC-1004</td>
                                <td>Meena Desai</td>
                                <td>Surat Center</td>
                                <td>41.5</td>
                                <td>4.0</td>
                                <td>8.4</td>
                                <td><span class="status pending">Pending</span></td>
                            </tr>
                            <tr>
                                <td>#MC-1005</td>
                                <td>Arun Gupta</td>
                                <td>Rajkot Center</td>
                                <td>47.0</td>
                                <td>4.3</td>
                                <td>8.6</td>
                                <td><span class="status completed">Completed</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Recent Activity Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Recent Activity</h2>
                        <a class="section-link" href="#">View All <i class="fas fa-chevron-right"></i></a>
                    </div>
                    <ul class="activity-list">
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-truck"></i>
                            </div>
                            <div class="activity-content">
                                <h3 class="activity-title">New milk collection from Farmer ID #4567</h3>
                                <p class="activity-time">10 minutes ago</p>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-flask"></i>
                            </div>
                            <div class="activity-content">
                                <h3 class="activity-title">Quality test completed for Batch #MC-1003</h3>
                                <p class="activity-time">25 minutes ago</p>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <div class="activity-content">
                                <h3 class="activity-title">New farmer registered: Sunil Verma</h3>
                                <p class="activity-time">1 hour ago</p>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-warehouse"></i>
                            </div>
                            <div class="activity-content">
                                <h3 class="activity-title">Inventory updated at Gandhinagar Center</h3>
                                <p class="activity-time">2 hours ago</p>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="activity-content">
                                <h3 class="activity-title">Daily production report generated</h3>
                                <p class="activity-time">3 hours ago</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <!-- Top Products Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Top Dairy Products</h2>
                        <a class="section-link" href="#">View All </a>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="top-products">
                        <div class="product-card">
                            <div class="product-image">
                                <img alt="Standard Milk"
                                    src="https://www.bbassets.com/media/uploads/p/xxl/40151386_2-dodla-standardised-milk.jpg" />
                            </div>
                            <div class="product-info">
                                <h3 class="product-name">Standard Milk</h3>
                                <p class="product-category">Liquid Milk</p>
                                <div class="product-stats">
                                    <span class="product-price">₹45/L</span>
                                    <span class="product-sales">1,200 sales</span>
                                </div>
                            </div>
                        </div>
                        <div class="product-card">
                            <div class="product-image">
                                <img alt="Toned Milk"
                                    src="https://dodladairy.com/wp-content/uploads/2024/12/toned-milk.png" />
                            </div>
                            <div class="product-info">
                                <h3 class="product-name">Toned Milk</h3>
                                <p class="product-category">Liquid Milk</p>
                                <div class="product-stats">
                                    <span class="product-price">₹40/L</span>
                                    <span class="product-sales">950 sales</span>
                                </div>
                            </div>
                        </div>
                        <div class="product-card">
                            <div class="product-image">
                                <img alt="Ghee"
                                    src="https://www.bigbasket.com/media/uploads/p/xxl/40058589_6-dodla-pure-cow-ghee-rich-natural-aroma.jpg" />
                            </div>
                            <div class="product-info">
                                <h3 class="product-name">Pure Ghee</h3>
                                <p class="product-category">Dairy Fat</p>
                                <div class="product-stats">
                                    <span class="product-price">₹500/kg</span>
                                    <span class="product-sales">320 sales</span>
                                </div>
                            </div>
                        </div>
                        <div class="product-card">
                            <div class="product-image">
                                <img alt="Paneer"
                                    src="https://www.bigbasket.com/media/uploads/p/l/40221064_1-dodla-paneer-rich-in-protein.jpg" />
                            </div>
                            <div class="product-info">
                                <h3 class="product-name">Fresh Paneer</h3>
                                <p class="product-category">Cheese</p>
                                <div class="product-stats">
                                    <span class="product-price">₹200/kg</span>
                                    <span class="product-sales">280 sales</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Profile Section -->
            <div class="child-section" id="profile-section">
                <button class="back-button" onclick="showSection('dashboard-section')">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Basic Information</h2>
                        <button class="edit-btn" id="editProfileBtn">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                    </div>
                    <div class="avatar-container" style="justify-content: center;">
                        <div class="avatar" id="avatarDisplay">JD</div>
                        <div>
                            <input accept="image/*" class="avatar-input" id="avatarInput" type="file" />
                            <button class="btn-primary" id="changeAvatarBtn" style="margin-top: 10px;">
                                <i class="fas fa-camera"></i> Change Photo
                            </button>
                        </div>
                    </div>
                    <form id="profileForm">
                        <div class="profile-grid">
                            <label for="fullName">Full Name</label>
                            <input id="fullName" name="fullName" readonly="" type="text" value="D. JOY" />
                            <label for="phone">Phone</label>
                            <input id="phone" name="phone" readonly="" type="tel" value="+91" />
                            <label for="email">Email</label>
                            <input id="email" name="email" readonly="" type="email" value="" />
                            <label for="address">Address</label>
                            <textarea id="address" name="address" readonly="" rows="3"></textarea>
                        </div>
                        <div id="formActions" style="display: none;">
                            <button class="btn-success" id="saveProfileBtn" type="button">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                            <button id="cancelEditBtn" style="margin-left: 10px;" type="button">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- Farmer Management Section -->
            <div class="child-section" id="farmer-management-section">
                <button class="back-button" onclick="showSection('dashboard-section')">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                <h3>Farmer Management</h3>
                <div style="margin: 20px 0; display: flex; gap: 15px; flex-wrap: wrap;">
                    <button
                        style="padding: 10px 20px; background: white; border: 1px solid #ddd; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 16px; font-weight: 500; cursor: pointer;">Daily</button>
                    <button
                        style="padding: 10px 20px; background: white; border: 1px solid #ddd; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 16px; font-weight: 500; cursor: pointer;">Weekly</button>
                    <button
                        style="padding: 10px 20px; background: white; border: 1px solid #ddd; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 16px; font-weight: 500; cursor: pointer;">Monthly</button>
                    <button
                        style="padding: 10px 20px; background: white; border: 1px solid #ddd; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 16px; font-weight: 500; cursor: pointer;">Custom</button>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Total Farmers</div>
                                <div class="stat-value">5,247</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    5.7%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="totalFarmersChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Active Farmers</div>
                                <div class="stat-value">4,892</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    4.2%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" height="120" id="activeFarmersChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Avg. Milk Production</div>
                                <div class="stat-value">42.5 L</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    2.3%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" height="120" id="avgMilkChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Recent Farmer Registrations</h2>
                        <a class="section-link" href="#">View All <i class="fas fa-chevron-right"></i></a>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Farmer ID</th>
                                <th>Name</th>
                                <th>Location</th>
                                <th>Date Joined</th>
                                <th>Cattle Count</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>#F-10045</td>
                                <td>Ramesh Patel</td>
                                <td>Anand District</td>
                                <td>2023-06-15</td>
                                <td>12</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                            <tr>
                                <td>#F-10044</td>
                                <td>Priya Sharma</td>
                                <td>Mehsana District</td>
                                <td>2023-06-14</td>
                                <td>8</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                            <tr>
                                <td>#F-10043</td>
                                <td>Vikram Singh</td>
                                <td>Kheda District</td>
                                <td>2023-06-12</td>
                                <td>15</td>
                                <td><span class="status processing">Pending Approval</span></td>
                            </tr>
                            <tr>
                                <td>#F-10042</td>
                                <td>Anjali Desai</td>
                                <td>Sabarkantha District</td>
                                <td>2023-06-10</td>
                                <td>10</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                            <tr>
                                <td>#F-10041</td>
                                <td>Harish Gupta</td>
                                <td>Gandhinagar District</td>
                                <td>2023-06-08</td>
                                <td>20</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                        </tbody>
                    </table>
                    <!-- Additional Farmer Management Features -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Farmer Income Trend (Monthly)</h2>
                        </div>
                        <canvas height="150" id="incomeChart"></canvas>
                    </div>
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Top Performing Farmers</h2>
                            <button class="btn-primary"><i class="fas fa-download"></i> Export Report</button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Farmer ID</th>
                                    <th>Name</th>
                                    <th>Region</th>
                                    <th>Monthly Yield (L)</th>
                                    <th>Income (₹)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>F-10201</td>
                                    <td>Suresh Yadav</td>
                                    <td>Nashik</td>
                                    <td>550</td>
                                    <td>₹22,000</td>
                                </tr>
                                <tr>
                                    <td>F-10204</td>
                                    <td>Meena Kumari</td>
                                    <td>Guntur</td>
                                    <td>520</td>
                                    <td>₹21,200</td>
                                </tr>
                                <tr>
                                    <td>F-10198</td>
                                    <td>Ravi Singh</td>
                                    <td>Moradabad</td>
                                    <td>490</td>
                                    <td>₹20,100</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Farmer Engagement</h2>
                        </div>
                        <p>Training Attendance</p>
                        <div style="background: #ddd; border-radius: 5px; overflow: hidden;">
                            <div style="width: 75%; background: #00b4d8; color: white; padding: 5px;">75%</div>
                        </div>
                        <p style="margin-top:10px;">Portal Login Activity</p>
                        <div style="background: #ddd; border-radius: 5px; overflow: hidden;">
                            <div style="width: 60%; background: #0077b6; color: white; padding: 5px;">60%</div>
                        </div>
                    </div>
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Recent Notifications</h2>
                        </div>
                        <ul class="activity-list">
                            <li class="activity-item">
                                <div class="activity-icon"><i class="fas fa-bullhorn"></i></div>
                                <div class="activity-content">
                                    <h3 class="activity-title">New subsidy announced for cattle feed</h3>
                                    <p class="activity-time">2 days ago</p>
                                </div>
                            </li>
                            <li class="activity-item">
                                <div class="activity-icon"><i class="fas fa-tractor"></i></div>
                                <div class="activity-content">
                                    <h3 class="activity-title">Equipment maintenance training scheduled</h3>
                                    <p class="activity-time">3 days ago</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <!-- Monthly Income Trend Chart Script -->
                    <script>
                        const ctxIncome = document.getElementById('incomeChart').getContext('2d');
                        new Chart(ctxIncome, {
                            type: 'bar',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    label: 'Income (₹)',
                                    data: [18000, 19000, 20000, 21500, 22500, 24000],
                                    backgroundColor: '#2a9d8f'
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Monthly Farmer Income Trend'
                                    }
                                }
                            }
                        });
                    </script>
                </div>
            </div>

            <div class="child-section" id="farmer-registration-section">
                <button class="back-button" onclick="showSection('farmer-management-section')">
                    <i class="fas fa-arrow-left"></i> Back to Farmer Management
                </button>

                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Farmer Registration</h2>
                        <button class="btn-primary" id="viewFarmersBtn" onclick="showFarmerList()">
                            <i class="fas fa-list"></i> View Registered Farmers
                        </button>
                    </div>

                    <form id="farmerRegistrationForm">
                        <div class="profile-grid">
                            <!-- Personal Information -->
                            <label for="farmerId">Farmer ID</label>
                            <input type="text" id="farmerId" readonly>

                            <label for="registrationDate">Registration Date</label>
                            <input type="date" id="registrationDate" required>

                            <label for="fullName">Full Name</label>
                            <input type="text" id="fullName" required placeholder="Enter full name">

                            <label for="gender">Gender</label>
                            <select id="gender" required>
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>

                            <label for="dob">Date of Birth</label>
                            <input type="date" id="dob" required>

                            <label for="aadharNumber">Aadhar Number</label>
                            <input type="text" id="aadharNumber" required placeholder="12-digit Aadhar number"
                                pattern="[0-9]{12}">

                            <label for="phoneNumber">Phone Number</label>
                            <input type="tel" id="phoneNumber" required placeholder="10-digit mobile number"
                                pattern="[0-9]{10}">

                            <label for="email">Email</label>
                            <input type="email" id="email" placeholder="Enter email address">

                            <!-- Address Information -->
                            <label for="address">Address</label>
                            <textarea id="address" rows="3" required placeholder="Full address"></textarea>

                            <label for="village">Village/Town</label>
                            <input type="text" id="village" required>

                            <label for="district">District</label>
                            <input type="text" id="district" required>

                            <label for="state">State</label>
                            <input type="text" id="state" required>

                            <label for="pincode">Pincode</label>
                            <input type="text" id="pincode" required pattern="[0-9]{6}">

                            <!-- Farm Information -->
                            <label for="farmName">Farm Name</label>
                            <input type="text" id="farmName" placeholder="Name of the farm">

                            <label for="farmSize">Farm Size (acres)</label>
                            <input type="number" id="farmSize" step="0.01" placeholder="Farm area in acres">

                            <label for="cattleCount">Total Cattle Count</label>
                            <input type="number" id="cattleCount" required>

                            <label for="milkProduction">Daily Milk Production (liters)</label>
                            <input type="number" id="milkProduction" step="0.1" required>

                            <label for="cattleBreeds">Cattle Breeds</label>
                            <select id="cattleBreeds" multiple>
                                <option value="Holstein Friesian">Holstein Friesian</option>
                                <option value="Jersey">Jersey</option>
                                <option value="Sahiwal">Sahiwal</option>
                                <option value="Gir">Gir</option>
                                <option value="Red Sindhi">Red Sindhi</option>
                                <option value="Local">Local</option>
                            </select>

                            <!-- Bank Details -->
                            <label for="bankName">Bank Name</label>
                            <input type="text" id="bankName" required>

                            <label for="accountNumber">Account Number</label>
                            <input type="text" id="accountNumber" required>

                            <label for="ifscCode">IFSC Code</label>
                            <input type="text" id="ifscCode" required>

                            <label for="accountHolder">Account Holder Name</label>
                            <input type="text" id="accountHolder" required>

                            <!-- Documents Upload -->
                            <label for="aadharUpload">Aadhar Card</label>
                            <input type="file" id="aadharUpload" accept="image/*,.pdf">

                            <label for="landProof">Land Ownership Proof</label>
                            <input type="file" id="landProof" accept="image/*,.pdf">

                            <label for="bankProof">Bank Proof</label>
                            <input type="file" id="bankProof" accept="image/*,.pdf">

                            <label for="photo">Farmer Photo</label>
                            <input type="file" id="photo" accept="image/*">
                        </div>

                        <div style="margin-top: 20px;">
                            <button type="submit" class="btn-success">
                                <i class="fas fa-save"></i> Register Farmer
                            </button>
                            <button type="reset" class="btn-primary" style="margin-left: 10px;">
                                <i class="fas fa-undo"></i> Reset Form
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Registered Farmers List (hidden by default) -->
                <div class="content-section" id="registeredFarmersList" style="display: none;">
                    <div class="section-header">
                        <h2 class="section-title">Registered Farmers</h2>
                        <button class="btn-primary" onclick="showRegistrationForm()">
                            <i class="fas fa-plus"></i> Add New Farmer
                        </button>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <input type="text" id="farmerSearch" placeholder="Search farmers..."
                            style="padding: 8px; width: 300px;">
                        <button class="btn-primary" onclick="searchFarmers()" style="margin-left: 10px;">
                            <i class="fas fa-search"></i> Search
                        </button>
                        <button class="btn-primary" onclick="exportFarmersToExcel()" style="margin-left: 10px;">
                            <i class="fas fa-file-excel"></i> Export to Excel
                        </button>
                        <button class="btn-primary" onclick="printFarmersList()" style="margin-left: 10px;">
                            <i class="fas fa-print"></i> Print
                        </button>
                    </div>

                    <table class="recent-orders" id="farmersTable">
                        <thead>
                            <tr>
                                <th>Farmer ID</th>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Village</th>
                                <th>Cattle Count</th>
                                <th>Milk Production</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="farmersTableBody">
                            <!-- Farmers will be loaded here -->
                        </tbody>
                    </table>

                    <div style="margin-top: 20px; display: flex; justify-content: space-between;">
                        <div id="farmerPaginationInfo">
                            Showing 0 to 0 of 0 farmers
                        </div>
                        <div>
                            <button class="btn-primary" id="prevPageBtn" onclick="changePage(-1)" disabled>
                                <i class="fas fa-chevron-left"></i> Previous
                            </button>
                            <button class="btn-primary" id="nextPageBtn" onclick="changePage(1)" disabled
                                style="margin-left: 10px;">
                                Next <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Farmer Details Modal (hidden by default) -->
                <div id="farmerDetailsModal"
                    style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.5); z-index: 10000; justify-content: center; align-items: center;">
                    <div
                        style="background-color: white; padding: 20px; border-radius: 8px; max-width: 800px; max-height: 90vh; overflow-y: auto;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                            <h2 id="modalFarmerName">Farmer Details</h2>
                            <button onclick="closeFarmerModal()"
                                style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">&times;</button>
                        </div>

                        <div id="farmerDetailsContent">
                            <!-- Farmer details will be loaded here -->
                        </div>

                        <div style="margin-top: 20px; text-align: right;">
                            <button class="btn-primary" onclick="closeFarmerModal()">
                                Close
                            </button>
                            <button class="btn-success" id="editFarmerBtn" style="margin-left: 10px;">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn-danger" id="deleteFarmerBtn" style="margin-left: 10px;">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payments Section -->
            <div class="child-section" id="payments-section">
                <button class="back-button" onclick="showSection('dashboard-section')">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>

                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Payment Management</h2>
                        <button class="btn-primary" id="addPaymentBtn">
                            <i class="fas fa-plus"></i> Add New Payment
                        </button>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Total Payments</div>
                                    <div class="stat-value" id="totalPaymentsValue">₹0</div>
                                    <div class="stat-change" id="paymentChange">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        0%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="totalPaymentsChart"></canvas>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Pending Payments</div>
                                    <div class="stat-value" id="pendingPaymentsValue">₹0</div>
                                    <div class="stat-change" id="pendingChange">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        0
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="pendingPaymentsChart"></canvas>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Avg. Payment</div>
                                    <div class="stat-value" id="avgPaymentValue">₹0</div>
                                    <div class="stat-change" id="avgPaymentChange">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        0%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="avgPaymentChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Payment Filters -->
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Payment Records</h3>
                            <div>
                                <input type="text" id="paymentSearch" placeholder="Search payments..."
                                    class="hdr-search">
                                <select id="paymentFilter" style="margin-left: 10px; padding: 8px;">
                                    <option value="all">All Payments</option>
                                    <option value="completed">Completed</option>
                                    <option value="pending">Pending</option>
                                    <option value="overdue">Overdue</option>
                                </select>
                                <input type="date" id="paymentDateFilter" style="margin-left: 10px; padding: 7px;">
                            </div>
                        </div>

                        <!-- Payments Table -->
                        <table class="recent-orders" id="paymentsTable">
                            <thead>
                                <tr>
                                    <th>Payment ID</th>
                                    <th>Date</th>
                                    <th>Recipient</th>
                                    <th>Amount</th>
                                    <th>Method</th>
                                    <th>Reference</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="paymentsTableBody">
                                <!-- Payments will be loaded here -->
                            </tbody>
                        </table>

                        <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                            <div id="paymentPaginationInfo">
                                Showing 0 to 0 of 0 payments
                            </div>
                            <div>
                                <button class="btn-primary" id="prevPaymentPage" disabled>
                                    <i class="fas fa-chevron-left"></i> Previous
                                </button>
                                <button class="btn-primary" id="nextPaymentPage" disabled style="margin-left: 10px;">
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Payment Trends -->
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Payment Trends</h3>
                            <select id="paymentTrendFilter" style="padding: 8px;">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                                <option value="12m">Last 12 Months</option>
                            </select>
                        </div>
                        <canvas height="100" id="paymentTrendChart"></canvas>
                    </div>
                </div>

                <!-- Add Payment Form (hidden by default) -->
                <div class="content-section" id="addPaymentForm" style="display: none;">
                    <div class="section-header">
                        <h3 class="section-title">Add New Payment</h3>
                        <button class="btn-primary" id="closePaymentForm">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                    <form id="paymentForm">
                        <div class="profile-grid">
                            <label for="paymentDate">Payment Date</label>
                            <input type="date" id="paymentDate" required>

                            <label for="paymentRecipient">Recipient</label>
                            <select id="paymentRecipient" required>
                                <option value="">Select Recipient</option>
                                <option value="farmer">Farmer</option>
                                <option value="supplier">Supplier</option>
                                <option value="employee">Employee</option>
                                <option value="other">Other</option>
                            </select>

                            <label for="paymentRecipientId">Recipient ID/Name</label>
                            <input type="text" id="paymentRecipientId" required placeholder="Enter ID or name">

                            <label for="paymentAmount">Amount (₹)</label>
                            <input type="number" id="paymentAmount" required step="0.01" min="0">

                            <label for="paymentMethod">Payment Method</label>
                            <select id="paymentMethod" required>
                                <option value="">Select Method</option>
                                <option value="cash">Cash</option>
                                <option value="bank_transfer">Bank Transfer</option>
                                <option value="cheque">Cheque</option>
                                <option value="upi">UPI</option>
                                <option value="other">Other</option>
                            </select>

                            <label for="paymentReference">Reference/Note</label>
                            <input type="text" id="paymentReference" placeholder="Optional reference">

                            <label for="paymentStatus">Status</label>
                            <select id="paymentStatus" required>
                                <option value="completed">Completed</option>
                                <option value="pending">Pending</option>
                                <option value="failed">Failed</option>
                            </select>
                        </div>

                        <div style="margin-top: 20px;">
                            <button type="submit" class="btn-success">
                                <i class="fas fa-save"></i> Save Payment
                            </button>
                            <button type="button" id="cancelPaymentForm" class="btn-primary" style="margin-left: 10px;">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Edit Payment Modal (hidden by default) -->
                <div id="editPaymentModal"
                    style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
                    <div
                        style="background-color: white; padding: 20px; border-radius: 8px; width: 600px; max-width: 90%;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                            <h3>Edit Payment</h3>
                            <button onclick="closeEditPaymentModal()"
                                style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">&times;</button>
                        </div>
                        <form id="editPaymentForm">
                            <input type="hidden" id="editPaymentId">
                            <div class="profile-grid">
                                <label for="editPaymentDate">Payment Date</label>
                                <input type="date" id="editPaymentDate" required>

                                <label for="editPaymentRecipient">Recipient</label>
                                <select id="editPaymentRecipient" required>
                                    <option value="">Select Recipient</option>
                                    <option value="farmer">Farmer</option>
                                    <option value="supplier">Supplier</option>
                                    <option value="employee">Employee</option>
                                    <option value="other">Other</option>
                                </select>

                                <label for="editPaymentRecipientId">Recipient ID/Name</label>
                                <input type="text" id="editPaymentRecipientId" required placeholder="Enter ID or name">

                                <label for="editPaymentAmount">Amount (₹)</label>
                                <input type="number" id="editPaymentAmount" required step="0.01" min="0">

                                <label for="editPaymentMethod">Payment Method</label>
                                <select id="editPaymentMethod" required>
                                    <option value="">Select Method</option>
                                    <option value="cash">Cash</option>
                                    <option value="bank_transfer">Bank Transfer</option>
                                    <option value="cheque">Cheque</option>
                                    <option value="upi">UPI</option>
                                    <option value="other">Other</option>
                                </select>

                                <label for="editPaymentReference">Reference/Note</label>
                                <input type="text" id="editPaymentReference" placeholder="Optional reference">

                                <label for="editPaymentStatus">Status</label>
                                <select id="editPaymentStatus" required>
                                    <option value="completed">Completed</option>
                                    <option value="pending">Pending</option>
                                    <option value="failed">Failed</option>
                                </select>
                            </div>

                            <div style="margin-top: 20px; text-align: right;">
                                <button type="submit" class="btn-success">
                                    <i class="fas fa-save"></i> Update Payment
                                </button>
                                <button type="button" onclick="closeEditPaymentModal()" class="btn-primary"
                                    style="margin-left: 10px;">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Milk Collection Section -->
            <div class="child-section" id="milk-collection-section">
                <button class="back-button" onclick="showSection('dashboard-section')">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                <h3>Milk Collection</h3>
                <div style="margin: 20px 0; display: flex; gap: 15px; flex-wrap: wrap;">
                    <button
                        style="padding: 10px 20px; background: white; border: 1px solid #ddd; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 16px; font-weight: 500; cursor: pointer;">Daily</button>
                    <button
                        style="padding: 10px 20px; background: white; border: 1px solid #ddd; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 16px; font-weight: 500; cursor: pointer;">Weekly</button>
                    <button
                        style="padding: 10px 20px; background: white; border: 1px solid #ddd; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 16px; font-weight: 500; cursor: pointer;">Monthly</button>
                    <button
                        style="padding: 10px 20px; background: white; border: 1px solid #ddd; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 16px; font-weight: 500; cursor: pointer;">Custom</button>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Today's Collection</div>
                                <div class="stat-value">12,450 L</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    3.2%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="todayCollectionChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Avg. Fat %</div>
                                <div class="stat-value">4.1%</div>
                                <div class="stat-change down">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                    0.5%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="fatContentChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Avg. SNF %</div>
                                <div class="stat-value">8.5%</div>
                                <div class="stat-change">
                                    <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                        stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    0.2%
                                </div>
                            </div>
                        </div>
                        <div class="stat-chart">
                            <canvas class="mini-chart" id="snfContentChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="content-section">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Milk Collection Data</h2>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Farmer Name</th>
                                    <th>Quantity (Liters)</th>
                                    <th>Fat %</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2025-05-01</td>
                                    <td>John Doe</td>
                                    <td>15.5</td>
                                    <td>3.8%</td>
                                </tr>
                                <tr>
                                    <td>2025-05-02</td>
                                    <td>Mary Smith</td>
                                    <td>18.2</td>
                                    <td>4.0%</td>
                                </tr>
                                <tr>
                                    <td>2025-05-03</td>
                                    <td>Ali Khan</td>
                                    <td>12.7</td>
                                    <td>3.6%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Milk Collection Trend</h2>
                        </div>
                        <canvas height="100" id="milkCollectionTrendChart" width="600"></canvas>
                        <script>
                            const trendCtx = document.getElementById('milkCollectionTrendChart').getContext('2d');
                            new Chart(trendCtx, {
                                type: 'line',
                                data: {
                                    labels: ['May 1', 'May 2', 'May 3'],
                                    datasets: [{
                                        label: 'Milk Collected (L)',
                                        data: [15.5, 18.2, 12.7],
                                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                        borderColor: 'rgba(54, 162, 235, 1)',
                                        borderWidth: 2,
                                        tension: 0.3
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    scales: {
                                        y: { beginAtZero: true }
                                    }
                                }
                            });
                        </script>
                    </div>
                    <div class="section-header">
                        <h2 class="section-title">Collection Centers Performance</h2>
                        <a class="section-link" href="#">View All <i class="fas fa-chevron-right"></i></a>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Center</th>
                                <th>Today's Collection</th>
                                <th>Avg. Fat %</th>
                                <th>Avg. SNF %</th>
                                <th>Quality Score</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Ahmedabad Center</td>
                                <td>3,450 L</td>
                                <td>4.2%</td>
                                <td>8.6%</td>
                                <td>92%</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                            <tr>
                                <td>Gandhinagar Center</td>
                                <td>2,890 L</td>
                                <td>4.0%</td>
                                <td>8.4%</td>
                                <td>88%</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                            <tr>
                                <td>Vadodara Center</td>
                                <td>3,120 L</td>
                                <td>4.3%</td>
                                <td>8.7%</td>
                                <td>94%</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                            <tr>
                                <td>Surat Center</td>
                                <td>2,560 L</td>
                                <td>3.9%</td>
                                <td>8.3%</td>
                                <td>85%</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                            <tr>
                                <td>Rajkot Center</td>
                                <td>2,430 L</td>
                                <td>4.1%</td>
                                <td>8.5%</td>
                                <td>90%</td>
                                <td><span class="status completed">Active</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>



            <!-- Collection Schedule Section -->
            <div class="child-section" id="collection-schedule-section">


                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Milk Collection Schedule</h2>
                        <button class="btn-primary" id="addCollectionBtn">
                            <i class="fas fa-plus"></i> Add Schedule
                        </button>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Scheduled Today</div>
                                    <div class="stat-value" id="scheduledToday">0</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        <span id="scheduledChange">0%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="scheduledChart"></canvas>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Completed Today</div>
                                    <div class="stat-value" id="completedToday">0</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        <span id="completedChange">0%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="completedChart"></canvas>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Pending Collections</div>
                                    <div class="stat-value" id="pendingCollections">0</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        <span id="pendingChange">0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="pendingChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div style="margin: 20px 0; display: flex; gap: 15px; flex-wrap: wrap;">
                        <select id="collectionCenterFilter" class="hdr-search">
                            <option value="">All Centers</option>
                            <option value="Ahmedabad">Ahmedabad Center</option>
                            <option value="Gandhinagar">Gandhinagar Center</option>
                            <option value="Vadodara">Vadodara Center</option>
                            <option value="Surat">Surat Center</option>
                            <option value="Rajkot">Rajkot Center</option>
                        </select>

                        <select id="collectionStatusFilter" class="hdr-search">
                            <option value="">All Statuses</option>
                            <option value="scheduled">Scheduled</option>
                            <option value="in-progress">In Progress</option>
                            <option value="completed">Completed</option>
                            <option value="cancelled">Cancelled</option>
                        </select>

                        <input type="date" id="collectionDateFilter" class="hdr-search">

                        <button class="btn-primary" id="applyFiltersBtn">
                            <i class="fas fa-filter"></i> Apply Filters
                        </button>

                        <button class="btn-primary" id="resetFiltersBtn">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>

                    <!-- Collection Schedule Table -->
                    <table class="recent-orders" id="collectionTable">
                        <thead>
                            <tr>
                                <th>Collection ID</th>
                                <th>Date</th>
                                <th>Farmer</th>
                                <th>Center</th>
                                <th>Expected Qty (L)</th>
                                <th>Actual Qty (L)</th>
                                <th>Time Slot</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="collectionTableBody">
                            <!-- Data will be loaded here -->
                        </tbody>
                    </table>

                    <!-- Pagination -->
                    <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                        <div id="collectionPaginationInfo">
                            Showing 0 to 0 of 0 collections
                        </div>
                        <div>
                            <button class="btn-primary" id="prevCollectionPage" disabled>
                                <i class="fas fa-chevron-left"></i> Previous
                            </button>
                            <button class="btn-primary" id="nextCollectionPage" disabled style="margin-left: 10px;">
                                Next <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Add/Edit Collection Form (hidden by default) -->
                <div class="content-section" id="collectionFormContainer" style="display: none;">
                    <div class="section-header">
                        <h2 class="section-title" id="collectionFormTitle">Add New Collection</h2>
                        <button class="btn-primary" id="closeCollectionForm">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>

                    <form id="collectionForm">
                        <input type="hidden" id="collectionId">

                        <div class="profile-grid">
                            <label for="collectionFarmer">Farmer</label>
                            <select id="collectionFarmer" required>
                                <option value="">Select Farmer</option>
                                <!-- Options will be populated by JavaScript -->
                            </select>

                            <label for="collectionCenter">Collection Center</label>
                            <select id="collectionCenter" required>
                                <option value="">Select Center</option>
                                <option value="Ahmedabad">Ahmedabad Center</option>
                                <option value="Gandhinagar">Gandhinagar Center</option>
                                <option value="Vadodara">Vadodara Center</option>
                                <option value="Surat">Surat Center</option>
                                <option value="Rajkot">Rajkot Center</option>
                            </select>

                            <label for="collectionDate">Collection Date</label>
                            <input type="date" id="collectionDate" required>

                            <label for="collectionTimeSlot">Time Slot</label>
                            <select id="collectionTimeSlot" required>
                                <option value="">Select Time Slot</option>
                                <option value="Morning (6-9 AM)">Morning (6-9 AM)</option>
                                <option value="Late Morning (9-12 PM)">Late Morning (9-12 PM)</option>
                                <option value="Afternoon (12-3 PM)">Afternoon (12-3 PM)</option>
                                <option value="Evening (3-6 PM)">Evening (3-6 PM)</option>
                            </select>

                            <label for="collectionExpectedQty">Expected Quantity (Liters)</label>
                            <input type="number" id="collectionExpectedQty" step="0.1" min="0" required>

                            <label for="collectionActualQty">Actual Quantity (Liters)</label>
                            <input type="number" id="collectionActualQty" step="0.1" min="0">

                            <label for="collectionStatus">Status</label>
                            <select id="collectionStatus" required>
                                <option value="scheduled">Scheduled</option>
                                <option value="in-progress">In Progress</option>
                                <option value="completed">Completed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>

                            <label for="collectionNotes">Notes</label>
                            <textarea id="collectionNotes" rows="3"></textarea>
                        </div>

                        <div style="margin-top: 20px;">
                            <button type="submit" class="btn-success">
                                <i class="fas fa-save"></i> Save Collection
                            </button>
                            <button type="button" id="cancelCollectionForm" class="btn-primary"
                                style="margin-left: 10px;">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>


            <div id="quality-testing-section" class="child-section">
                <div class="content-section">
                    <div class="section-header">
                        <span class="section-title">Quality Testing</span>
                        <button class="btn-primary" onclick="showQualityTestForm()">+ Add Test</button>
                    </div>

                    <!-- Description / Info -->
                    <div
                        style="margin-bottom: 20px; background: #f1f8fe; border-radius: 7px; padding: 15px; border: 1px solid #caf0f8;">
                        <b>About Quality Testing:</b><br>
                        This section allows you to record, track, and visualize the results of quality tests performed
                        on milk batches. Monitoring metrics such as fat content, SNF, adulteration, and microbial tests
                        helps ensure product safety and consistency.<br>
                        <ul style="margin: 8px 0 0 18px;">
                            <li><b>Add</b> a new test result for each milk batch.</li>
                            <li><b>Edit</b> or <b>delete</b> records as needed.</li>
                            <li>Check the <b>charts</b> for trends and pass/fail rates.</li>
                        </ul>
                    </div>

                    <!-- Statistics (calculated) -->
                    <div style="display: flex; gap: 20px; margin-bottom: 25px;">
                        <div
                            style="flex:1; background: #e9f7ef; border-radius: 8px; padding: 16px; text-align: center; border:1px solid #b7e4c7;">
                            <div style="font-size:24px;" id="qt-total-tests">0</div>
                            <div>Total Tests Conducted</div>
                        </div>
                        <div
                            style="flex:1; background: #fff3cd; border-radius: 8px; padding: 16px; text-align: center; border:1px solid #ffe066;">
                            <div style="font-size:24px;" id="qt-pass-rate">0%</div>
                            <div>Pass Rate</div>
                        </div>
                        <div
                            style="flex:1; background: #f8d7da; border-radius: 8px; padding: 16px; text-align: center; border:1px solid #f5c2c7;">
                            <div style="font-size:24px;" id="qt-failed-tests">0</div>
                            <div>Failed Tests</div>
                        </div>
                    </div>

                    <!-- Graphs Overview -->
                    <div class="stats-grid" style="margin-bottom: 32px; grid-template-columns: 1fr 1fr;">
                        <div class="stat-card" style="height: 350px; display: flex; flex-direction: column;">
                            <div class="stat-header">
                                <span class="stat-title">Test Results Overview</span>
                            </div>
                            <div style="flex: 1; display: flex; align-items: center; justify-content: center;">
                                <canvas id="qtResultPie"
                                    style="max-width: 340px; max-height: 280px; width:100%; height:100%;"></canvas>
                            </div>
                        </div>
                        <div class="stat-card" style="height: 350px; display: flex; flex-direction: column;">
                            <div class="stat-header">
                                <span class="stat-title">Tests by Type</span>
                            </div>
                            <div style="flex: 1; display: flex; align-items: center; justify-content: center;">
                                <canvas id="qtTypeBar"
                                    style="max-width: 340px; max-height: 280px; width:100%; height:100%;"></canvas>
                            </div>
                        </div>
                    </div>
                    <!-- Form -->
                    <div id="quality-test-form" style="display: none; margin-bottom: 20px;">
                        <h3>Add / Edit Quality Test</h3>
                        <form id="qtForm">
                            <input type="hidden" id="qtIndex" value="">
                            <div class="profile-grid">
                                <label for="qtDate">Date</label>
                                <input type="date" id="qtDate" required>
                            </div>
                            <div class="profile-grid">
                                <label for="qtBatch">Batch Number</label>
                                <input type="text" id="qtBatch" required>
                            </div>
                            <div class="profile-grid">
                                <label for="qtType">Test Type</label>
                                <select id="qtType" required>
                                    <option value="">Select Type</option>
                                    <option value="Fat Content">Fat Content</option>
                                    <option value="SNF">SNF</option>
                                    <option value="Adulteration">Adulteration</option>
                                    <option value="Microbial">Microbial</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="profile-grid">
                                <label for="qtResult">Result</label>
                                <select id="qtResult" required>
                                    <option value="">Select Result</option>
                                    <option value="Pass">Pass</option>
                                    <option value="Fail">Fail</option>
                                    <option value="Pending">Pending</option>
                                </select>
                            </div>
                            <div class="profile-grid">
                                <label for="qtRemarks">Remarks</label>
                                <textarea id="qtRemarks" rows="2"></textarea>
                            </div>
                            <button type="submit" class="btn-success">Save</button>
                            <button type="button" class="btn-primary" onclick="hideQualityTestForm()">Cancel</button>
                        </form>
                    </div>
                    <!-- Table -->
                    <table class="recent-orders" id="quality-test-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Batch #</th>
                                <th>Test Type</th>
                                <th>Result</th>
                                <th>Remarks</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Quality Test Rows Here -->
                        </tbody>
                    </table>
                    <!-- Export Data Button -->
                    <div style="margin-top:18px;">
                        <button class="btn-primary" onclick="exportQualityTests()">Export Data as CSV</button>
                    </div>
                </div>
            </div>
            <!-- Add similar sections for other main menu items here -->
            <!-- Chilling Centers Section -->
            <!-- Chilling Centers Section -->
            <div class="child-section" id="chilling-centers-section">
                <button class="back-button" onclick="showSection('dashboard-section')">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Chilling Centers Overview</h2>
                        <button class="btn-primary" id="addCenterBtn">
                            <i class="fas fa-plus"></i> Add New Center
                        </button>
                    </div>
                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Total Centers</div>
                                    <div class="stat-value">12</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        8.3%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="totalCentersChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Total Capacity</div>
                                    <div class="stat-value">150,000 L</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        12.5%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="totalCapacityChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Current Storage</div>
                                    <div class="stat-value">112,500 L</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        5.7%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="currentStorageChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Avg. Temp</div>
                                    <div class="stat-value">4.2°C</div>
                                    <div class="stat-change down">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                        0.3°C
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="avgTempChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Center Performance Table -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Center Performance</h2>
                        <a class="section-link" href="#">View All <i class="fas fa-chevron-right"></i></a>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Center ID</th>
                                <th>Location</th>
                                <th>Capacity (L)</th>
                                <th>Current Storage</th>
                                <th>Avg. Temp</th>
                                <th>Quality Score</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>CC-1001</td>
                                <td>Ahmedabad</td>
                                <td>15,000</td>
                                <td>12,500 (83%)</td>
                                <td>4.1°C</td>
                                <td>94%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                            <tr>
                                <td>CC-1002</td>
                                <td>Gandhinagar</td>
                                <td>12,000</td>
                                <td>10,800 (90%)</td>
                                <td>4.3°C</td>
                                <td>92%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                            <tr>
                                <td>CC-1003</td>
                                <td>Vadodara</td>
                                <td>18,000</td>
                                <td>15,300 (85%)</td>
                                <td>4.0°C</td>
                                <td>95%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                            <tr>
                                <td>CC-1004</td>
                                <td>Surat</td>
                                <td>20,000</td>
                                <td>16,000 (80%)</td>
                                <td>4.2°C</td>
                                <td>91%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                            <tr>
                                <td>CC-1005</td>
                                <td>Rajkot</td>
                                <td>15,000</td>
                                <td>13,500 (90%)</td>
                                <td>4.4°C</td>
                                <td>93%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Temperature Monitoring Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Temperature Monitoring</h2>
                        <select id="tempTimeRange" style="padding: 8px;">
                            <option value="24h">Last 24 Hours</option>
                            <option value="7d">Last 7 Days</option>
                            <option value="30d">Last 30 Days</option>
                        </select>
                    </div>
                    <canvas height="100" id="tempMonitoringChart"></canvas>
                </div>
                <!-- Inventory Movement Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Inventory Movement</h2>
                        <button class="btn-primary" id="exportInventoryBtn">
                            <i class="fas fa-download"></i> Export Data
                        </button>
                    </div>
                    <canvas height="100" id="inventoryMovementChart"></canvas>
                </div>
                <!-- Maintenance Logs -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Maintenance Logs</h2>
                        <button class="btn-primary" id="addMaintenanceBtn">
                            <i class="fas fa-plus"></i> Add Log
                        </button>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Center</th>
                                <th>Issue</th>
                                <th>Action Taken</th>
                                <th>Technician</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2023-06-15</td>
                                <td>CC-1001</td>
                                <td>Temperature fluctuation</td>
                                <td>Thermostat replaced</td>
                                <td>Rajesh Patel</td>
                                <td><span class="status completed">Resolved</span></td>
                            </tr>
                            <tr>
                                <td>2023-06-10</td>
                                <td>CC-1003</td>
                                <td>Coolant leak</td>
                                <td>Seals replaced</td>
                                <td>Vijay Singh</td>
                                <td><span class="status completed">Resolved</span></td>
                            </tr>
                            <tr>
                                <td>2023-06-08</td>
                                <td>CC-1002</td>
                                <td>Power supply issue</td>
                                <td>Backup generator serviced</td>
                                <td>Sunil Sharma</td>
                                <td><span class="status completed">Resolved</span></td>
                            </tr>
                            <tr>
                                <td>2023-06-05</td>
                                <td>CC-1004</td>
                                <td>Door seal damage</td>
                                <td>New seal installed</td>
                                <td>Anil Gupta</td>
                                <td><span class="status completed">Resolved</span></td>
                            </tr>
                            <tr>
                                <td>2023-06-01</td>
                                <td>CC-1005</td>
                                <td>Compressor noise</td>
                                <td>Pending diagnosis</td>
                                <td>Mohan Kumar</td>
                                <td><span class="status pending">In Progress</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Add Center Form (hidden by default) -->
                <div class="content-section" id="addCenterForm" style="display: none;">
                    <div class="section-header">
                        <h3 class="section-title">Add New Chilling Center</h3>
                        <button class="btn-primary" id="closeCenterForm">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                    <form id="centerForm">
                        <div class="profile-grid">
                            <label for="centerName">Center Name</label>
                            <input id="centerName" required="" type="text" />
                            <label for="centerLocation">Location</label>
                            <input id="centerLocation" required="" type="text" />
                            <label for="centerCapacity">Capacity (Liters)</label>
                            <input id="centerCapacity" required="" type="number" />
                            <label for="centerManager">Manager</label>
                            <input id="centerManager" required="" type="text" />
                            <label for="centerContact">Contact Number</label>
                            <input id="centerContact" required="" type="tel" />
                            <label for="centerStatus">Status</label>
                            <select id="centerStatus" required="">
                                <option value="active">Active</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="btn-success" type="submit">
                                <i class="fas fa-save"></i> Save Center
                            </button>
                            <button class="btn-primary" id="cancelCenterForm" style="margin-left: 10px;" type="button">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- Processing Plants Section -->
            <div class="child-section" id="processing-plants-section">
                <button class="back-button" onclick="showSection('dashboard-section')">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Processing Plants Overview</h2>
                        <button class="btn-primary" id="addPlantBtn">
                            <i class="fas fa-plus"></i> Add New Plant
                        </button>
                    </div>
                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Total Plants</div>
                                    <div class="stat-value">8</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        14.3%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="totalPlantsChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Daily Capacity</div>
                                    <div class="stat-value">250,000 L</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        8.7%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="dailyCapacityChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Current Utilization</div>
                                    <div class="stat-value">78%</div>
                                    <div class="stat-change down">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                        5.2%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="utilizationChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Avg. Efficiency</div>
                                    <div class="stat-value">82%</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        1.5%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="efficiencyChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Plant Performance Table -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Plant Performance</h2>
                        <a class="section-link" href="#">View All <i class="fas fa-chevron-right"></i></a>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Plant ID</th>
                                <th>Location</th>
                                <th>Capacity (L/day)</th>
                                <th>Current Output</th>
                                <th>Efficiency</th>
                                <th>Downtime</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>PP-1001</td>
                                <td>Ahmedabad</td>
                                <td>50,000</td>
                                <td>42,500 (85%)</td>
                                <td>88%</td>
                                <td>2.1%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                            <tr>
                                <td>PP-1002</td>
                                <td>Gandhinagar</td>
                                <td>40,000</td>
                                <td>32,800 (82%)</td>
                                <td>85%</td>
                                <td>3.5%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                            <tr>
                                <td>PP-1003</td>
                                <td>Vadodara</td>
                                <td>45,000</td>
                                <td>36,900 (82%)</td>
                                <td>84%</td>
                                <td>2.8%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                            <tr>
                                <td>PP-1004</td>
                                <td>Surat</td>
                                <td>35,000</td>
                                <td>28,000 (80%)</td>
                                <td>82%</td>
                                <td>4.2%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                            <tr>
                                <td>PP-1005</td>
                                <td>Rajkot</td>
                                <td>30,000</td>
                                <td>25,500 (85%)</td>
                                <td>87%</td>
                                <td>1.9%</td>
                                <td><span class="status completed">Operational</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Production Lines Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Production Lines</h2>
                        <button class="btn-primary" id="addProductionLineBtn">
                            <i class="fas fa-plus"></i> Add Line
                        </button>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Line ID</th>
                                <th>Plant</th>
                                <th>Product Type</th>
                                <th>Capacity (L/hr)</th>
                                <th>Current Rate</th>
                                <th>Uptime</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>PL-101</td>
                                <td>PP-1001 (Ahmedabad)</td>
                                <td>Pasteurized Milk</td>
                                <td>5,000</td>
                                <td>4,750</td>
                                <td>98.2%</td>
                                <td><span class="status completed">Running</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-chart-line"></i></button>
                                    <button class="btn-success"><i class="fas fa-edit"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>PL-102</td>
                                <td>PP-1001 (Ahmedabad)</td>
                                <td>Flavored Milk</td>
                                <td>3,500</td>
                                <td>3,200</td>
                                <td>96.5%</td>
                                <td><span class="status completed">Running</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-chart-line"></i></button>
                                    <button class="btn-success"><i class="fas fa-edit"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>PL-201</td>
                                <td>PP-1002 (Gandhinagar)</td>
                                <td>Yogurt</td>
                                <td>2,800</td>
                                <td>2,600</td>
                                <td>97.8%</td>
                                <td><span class="status completed">Running</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-chart-line"></i></button>
                                    <button class="btn-success"><i class="fas fa-edit"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>PL-301</td>
                                <td>PP-1003 (Vadodara)</td>
                                <td>Cheese</td>
                                <td>1,500</td>
                                <td>1,350</td>
                                <td>95.2%</td>
                                <td><span class="status pending">Maintenance</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-chart-line"></i></button>
                                    <button class="btn-success"><i class="fas fa-edit"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Production Trends Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Production Trends</h2>
                        <select id="productionTimeRange" style="padding: 8px;">
                            <option value="7d">Last 7 Days</option>
                            <option value="30d">Last 30 Days</option>
                            <option value="90d">Last 90 Days</option>
                        </select>
                    </div>
                    <canvas height="100" id="productionTrendChart"></canvas>
                </div>
                <!-- Equipment Monitoring Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Equipment Monitoring</h2>
                        <button class="btn-primary" id="exportEquipmentDataBtn">
                            <i class="fas fa-download"></i> Export Data
                        </button>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Critical Alerts</div>
                                    <div class="stat-value">3</div>
                                    <div class="stat-change down">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                        25%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="criticalAlertsChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Preventive Maint.</div>
                                    <div class="stat-value">12</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        8%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="preventiveMaintenanceChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Avg. Temp</div>
                                    <div class="stat-value">4.2°C</div>
                                    <div class="stat-change down">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                        0.3°C
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="avgTempChart"></canvas>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Energy Usage</div>
                                    <div class="stat-value">1,250 kWh</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        3.5%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="energyUsageChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <table class="recent-orders" style="margin-top: 20px;">
                        <thead>
                            <tr>
                                <th>Equipment ID</th>
                                <th>Name</th>
                                <th>Plant</th>
                                <th>Last Maintenance</th>
                                <th>Next Maintenance</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>EQ-1001</td>
                                <td>Pasteurizer</td>
                                <td>PP-1001</td>
                                <td>2023-05-15</td>
                                <td>2023-07-15</td>
                                <td><span class="status completed">Operational</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-info-circle"></i></button>
                                    <button class="btn-success"><i class="fas fa-wrench"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>EQ-1002</td>
                                <td>Homogenizer</td>
                                <td>PP-1001</td>
                                <td>2023-06-01</td>
                                <td>2023-08-01</td>
                                <td><span class="status completed">Operational</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-info-circle"></i></button>
                                    <button class="btn-success"><i class="fas fa-wrench"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>EQ-1003</td>
                                <td>Filling Machine</td>
                                <td>PP-1001</td>
                                <td>2023-06-10</td>
                                <td>2023-07-10</td>
                                <td><span class="status pending">Maintenance Due</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-info-circle"></i></button>
                                    <button class="btn-success"><i class="fas fa-wrench"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>EQ-2001</td>
                                <td>Cheese Vat</td>
                                <td>PP-1003</td>
                                <td>2023-05-20</td>
                                <td>2023-07-20</td>
                                <td><span class="status pending">In Maintenance</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-info-circle"></i></button>
                                    <button class="btn-success"><i class="fas fa-wrench"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>EQ-2002</td>
                                <td>Yogurt Fermenter</td>
                                <td>PP-1002</td>
                                <td>2023-06-05</td>
                                <td>2023-08-05</td>
                                <td><span class="status completed">Operational</span></td>
                                <td>
                                    <button class="btn-primary"><i class="fas fa-info-circle"></i></button>
                                    <button class="btn-success"><i class="fas fa-wrench"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Maintenance Logs -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Maintenance Logs</h2>
                        <button class="btn-primary" id="addMaintenanceLogBtn">
                            <i class="fas fa-plus"></i> Add Log
                        </button>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Equipment</th>
                                <th>Plant</th>
                                <th>Issue</th>
                                <th>Action Taken</th>
                                <th>Technician</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2023-06-15</td>
                                <td>Pasteurizer (EQ-1001)</td>
                                <td>PP-1001</td>
                                <td>Temperature fluctuation</td>
                                <td>Thermostat replaced</td>
                                <td>Rajesh Patel</td>
                                <td><span class="status completed">Resolved</span></td>
                            </tr>
                            <tr>
                                <td>2023-06-10</td>
                                <td>Cheese Vat (EQ-2001)</td>
                                <td>PP-1003</td>
                                <td>Coolant leak</td>
                                <td>Seals replaced</td>
                                <td>Vijay Singh</td>
                                <td><span class="status completed">Resolved</span></td>
                            </tr>
                            <tr>
                                <td>2023-06-08</td>
                                <td>Filling Machine (EQ-1003)</td>
                                <td>PP-1001</td>
                                <td>Power supply issue</td>
                                <td>Backup generator serviced</td>
                                <td>Sunil Sharma</td>
                                <td><span class="status completed">Resolved</span></td>
                            </tr>
                            <tr>
                                <td>2023-06-05</td>
                                <td>Homogenizer (EQ-1002)</td>
                                <td>PP-1001</td>
                                <td>Unusual noise</td>
                                <td>Bearings lubricated</td>
                                <td>Anil Gupta</td>
                                <td><span class="status completed">Resolved</span></td>
                            </tr>
                            <tr>
                                <td>2023-06-01</td>
                                <td>Yogurt Fermenter (EQ-2002)</td>
                                <td>PP-1002</td>
                                <td>Compressor noise</td>
                                <td>Pending diagnosis</td>
                                <td>Mohan Kumar</td>
                                <td><span class="status pending">In Progress</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Add Plant Form (hidden by default) -->
                <div class="content-section" id="addPlantForm" style="display: none;">
                    <div class="section-header">
                        <h3 class="section-title">Add New Processing Plant</h3>
                        <button class="btn-primary" id="closePlantForm">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                    <form id="plantForm">
                        <div class="profile-grid">
                            <label for="plantName">Plant Name</label>
                            <input id="plantName" required="" type="text" />
                            <label for="plantLocation">Location</label>
                            <input id="plantLocation" required="" type="text" />
                            <label for="plantCapacity">Daily Capacity (Liters)</label>
                            <input id="plantCapacity" required="" type="number" />
                            <label for="plantManager">Plant Manager</label>
                            <input id="plantManager" required="" type="text" />
                            <label for="plantContact">Contact Number</label>
                            <input id="plantContact" required="" type="tel" />
                            <label for="plantStatus">Status</label>
                            <select id="plantStatus" required="">
                                <option value="active">Active</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="btn-success" type="submit">
                                <i class="fas fa-save"></i> Save Plant
                            </button>
                            <button class="btn-primary" id="cancelPlantForm" style="margin-left: 10px;" type="button">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- Quality Control Section -->
            <div class="child-section" id="quality-control-section">
                <button class="back-button" onclick="showSection('dashboard-section')">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>

                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Quality Control Dashboard</h2>
                        <button class="btn-primary" id="addQualityTestBtn">
                            <i class="fas fa-plus"></i> Add Test Result
                        </button>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Pass Rate</div>
                                    <div class="stat-value">94.5%</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        1.2%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="passRateChart"></canvas>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Avg. Fat Content</div>
                                    <div class="stat-value">4.2%</div>
                                    <div class="stat-change down">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                        0.1%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="fatContentChart"></canvas>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Avg. SNF Content</div>
                                    <div class="stat-value">8.6%</div>
                                    <div class="stat-change">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="18 15 12 9 6 15"></polyline>
                                        </svg>
                                        0.2%
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="snfContentChart"></canvas>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Failed Tests</div>
                                    <div class="stat-value">12</div>
                                    <div class="stat-change down">
                                        <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                            stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                        3
                                    </div>
                                </div>
                            </div>
                            <div class="stat-chart">
                                <canvas class="mini-chart" id="failedTestsChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Quality Tests -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Recent Quality Tests</h2>
                        <div>
                            <input id="qualitySearch" placeholder="Search tests..." type="text" />
                            <select id="qualityFilter" style="margin-left: 10px;">
                                <option value="all">All Tests</option>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="pending">Pending</option>
                            </select>
                        </div>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Test ID</th>
                                <th>Batch No.</th>
                                <th>Product</th>
                                <th>Test Type</th>
                                <th>Fat %</th>
                                <th>SNF %</th>
                                <th>Test Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="qualityTestsTableBody">
                            <!-- Test data will be loaded here -->
                        </tbody>
                    </table>
                    <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                        <div>
                            Showing <span id="qualityShowingFrom">1</span> to <span id="qualityShowingTo">5</span> of
                            <span id="qualityTotalTests">0</span> tests
                        </div>
                        <div>
                            <button class="btn-primary" id="qualityPrevPage">Previous</button>
                            <button class="btn-primary" id="qualityNextPage">Next</button>
                        </div>
                    </div>
                </div>

                <!-- Quality Trends Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Quality Trends</h2>
                        <select id="qualityTimeRange" style="padding: 8px;">
                            <option value="7d">Last 7 Days</option>
                            <option value="30d">Last 30 Days</option>
                            <option value="90d">Last 90 Days</option>
                        </select>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Fat Content Trend</h3>
                            <canvas height="200" id="fatTrendChart"></canvas>
                        </div>
                        <div class="stat-card">
                            <h3>SNF Content Trend</h3>
                            <canvas height="200" id="snfTrendChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Quality Standards Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">Quality Standards</h2>
                        <button class="btn-primary" id="editStandardsBtn">
                            <i class="fas fa-edit"></i> Edit Standards
                        </button>
                    </div>
                    <table class="recent-orders">
                        <thead>
                            <tr>
                                <th>Product Type</th>
                                <th>Min Fat %</th>
                                <th>Max Fat %</th>
                                <th>Min SNF %</th>
                                <th>Max SNF %</th>
                                <th>Bacterial Count</th>
                                <th>Temperature</th>
                            </tr>
                        </thead>
                        <tbody id="qualityStandardsBody">
                            <!-- Standards data will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Add Test Form (hidden by default) -->
                <div class="content-section" id="addTestForm" style="display: none;">
                    <div class="section-header">
                        <h3 class="section-title">Add New Quality Test</h3>
                        <button class="btn-primary" id="closeTestForm">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                    <form id="testForm">
                        <div class="profile-grid">
                            <label for="testBatchNo">Batch Number</label>
                            <input id="testBatchNo" required type="text" />

                            <label for="testProduct">Product</label>
                            <select id="testProduct" required>
                                <option value="">Select Product</option>
                                <option value="standard_milk">Standard Milk</option>
                                <option value="toned_milk">Toned Milk</option>
                                <option value="flavored_milk">Flavored Milk</option>
                                <option value="yogurt">Yogurt</option>
                                <option value="paneer">Paneer</option>
                                <option value="ghee">Ghee</option>
                            </select>

                            <label for="testType">Test Type</label>
                            <select id="testType" required>
                                <option value="routine">Routine</option>
                                <option value="random">Random</option>
                                <option value="complaint">Complaint Investigation</option>
                                <option value="batch">Batch Release</option>
                            </select>

                            <label for="testFat">Fat Content (%)</label>
                            <input id="testFat" required type="number" step="0.1" min="0" max="10" />

                            <label for="testSnf">SNF Content (%)</label>
                            <input id="testSnf" required type="number" step="0.1" min="0" max="15" />

                            <label for="testBacteria">Bacterial Count (CFU/ml)</label>
                            <input id="testBacteria" required type="number" />

                            <label for="testTemp">Temperature (°C)</label>
                            <input id="testTemp" required type="number" step="0.1" />

                            <label for="testStatus">Status</label>
                            <select id="testStatus" required>
                                <option value="passed">Passed</option>
                                <option value="failed">Failed</option>
                                <option value="pending">Pending</option>
                            </select>

                            <label for="testNotes">Notes</label>
                            <textarea id="testNotes" rows="3"></textarea>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="btn-success" type="submit">
                                <i class="fas fa-save"></i> Save Test
                            </button>
                            <button class="btn-primary" id="cancelTestForm" style="margin-left: 10px;" type="button">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Edit Standards Form (hidden by default) -->
                <div class="content-section" id="editStandardsForm" style="display: none;">
                    <div class="section-header">
                        <h3 class="section-title">Edit Quality Standards</h3>
                        <button class="btn-primary" id="closeStandardsForm">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                    <form id="standardsForm">
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Product Type</th>
                                    <th>Min Fat %</th>
                                    <th>Max Fat %</th>
                                    <th>Min SNF %</th>
                                    <th>Max SNF %</th>
                                    <th>Max Bacterial Count</th>
                                    <th>Max Temp (°C)</th>
                                </tr>
                            </thead>
                            <tbody id="editStandardsBody">
                                <!-- Standards edit rows will be loaded here -->
                            </tbody>
                        </table>
                        <div style="margin-top: 20px;">
                            <button class="btn-success" type="submit">
                                <i class="fas fa-save"></i> Save Standards
                            </button>
                            <button class="btn-primary" id="cancelStandardsForm" style="margin-left: 10px;"
                                type="button">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="feedback-theme">
                <div class="child-section" id="feedback-complaints-section">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Feedback &amp; Complaint Management</h2>
                            <button class="btn-primary" id="addFeedbackBtn">
                                <i class="fas fa-plus"></i> Add New Feedback
                            </button>
                        </div>
                        <!-- Stats Cards -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">CSAT Score</div>
                                        <div class="stat-value">84%</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            2%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="csatChart"></canvas>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">NPS</div>
                                        <div class="stat-value">62</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            5
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="npsChart"></canvas>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Open Complaints</div>
                                        <div class="stat-value">14</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            3
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="complaintsChart"></canvas>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Avg Resolution</div>
                                        <div class="stat-value">2.1d</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            0.5d
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="resolutionChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="content-section">
                            <div class="section-header">
                                <h2 class="section-title">Sentiment Analysis Charts</h2>
                            </div>
                            <div class="stats-grid">
                                <div class="stat-card"><canvas height="200" id="sentimentPieChart"></canvas></div>
                                <div class="stat-card"><canvas height="200" id="sentimentLineChart"></canvas></div>
                                <div class="stat-card"><canvas height="200" id="sentimentRadarChart"></canvas></div>
                            </div>
                        </div>
                        <!-- Feedback Table -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Recent Feedback</h3>
                                <div>
                                    <input id="feedbackSearch" placeholder="Search feedback..."
                                        style="padding: 8px; margin-right: 10px;" type="text" />
                                    <select id="feedbackFilter" style="padding: 8px;">
                                        <option value="all">All</option>
                                        <option value="positive">Positive</option>
                                        <option value="negative">Negative</option>
                                        <option value="neutral">Neutral</option>
                                    </select>
                                </div>
                            </div>
                            <table class="recent-orders">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Customer</th>
                                        <th>Feedback</th>
                                        <th>Sentiment</th>
                                        <th>Category</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>2023-06-15</td>
                                        <td>John Smith</td>
                                        <td>Very happy with the quick response to my issue</td>
                                        <td><span class="status completed">Positive</span></td>
                                        <td>Service</td>
                                        <td><span class="status completed">Resolved</span></td>
                                        <td>
                                            <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                            <button class="btn-success"><i class="fas fa-edit"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2023-06-14</td>
                                        <td>Sarah Johnson</td>
                                        <td>The product didn't meet my expectations</td>
                                        <td><span class="status pending">Negative</span></td>
                                        <td>Product Quality</td>
                                        <td><span class="status pending">In Progress</span></td>
                                        <td>
                                            <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                            <button class="btn-success"><i class="fas fa-edit"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2023-06-13</td>
                                        <td>Mike Brown</td>
                                        <td>Delivery was late by 2 hours</td>
                                        <td><span class="status pending">Negative</span></td>
                                        <td>Delivery</td>
                                        <td><span class="status scheduled">Pending</span></td>
                                        <td>
                                            <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                            <button class="btn-success"><i class="fas fa-edit"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2023-06-12</td>
                                        <td>Emily Davis</td>
                                        <td>Excellent milk quality this week</td>
                                        <td><span class="status completed">Positive</span></td>
                                        <td>Product Quality</td>
                                        <td><span class="status completed">Acknowledged</span></td>
                                        <td>
                                            <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                            <button class="btn-success"><i class="fas fa-edit"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                                <div>
                                    Showing 1 to 4 of 12 entries
                                </div>
                                <div>
                                    <button class="btn-primary">Previous</button>
                                    <button class="btn-primary">Next</button>
                                </div>
                            </div>
                        </div>
                        <!-- Add Feedback Form (hidden by default) -->
                        <div class="content-section" id="addFeedbackForm" style="display: none;">
                            <div class="section-header">
                                <h3 class="section-title">Add New Feedback/Complaint</h3>
                                <button class="btn-primary" id="closeFeedbackForm">
                                    <i class="fas fa-times"></i> Close
                                </button>
                            </div>
                            <form id="feedbackForm">
                                <div class="profile-grid">
                                    <label for="feedbackDate">Date</label>
                                    <input id="feedbackDate" required="" type="date" />
                                    <label for="feedbackCustomer">Customer</label>
                                    <select id="feedbackCustomer" required="">
                                        <option value="">Select Customer</option>
                                        <option value="1">John Smith</option>
                                        <option value="2">Sarah Johnson</option>
                                        <option value="3">Mike Brown</option>
                                        <option value="4">Emily Davis</option>
                                    </select>
                                    <label for="feedbackType">Type</label>
                                    <select id="feedbackType" required="">
                                        <option value="feedback">Feedback</option>
                                        <option value="complaint">Complaint</option>
                                        <option value="suggestion">Suggestion</option>
                                    </select>
                                    <label for="feedbackCategory">Category</label>
                                    <select id="feedbackCategory" required="">
                                        <option value="product">Product Quality</option>
                                        <option value="service">Service</option>
                                        <option value="delivery">Delivery</option>
                                        <option value="packaging">Packaging</option>
                                        <option value="other">Other</option>
                                    </select>
                                    <label for="feedbackSentiment">Sentiment</label>
                                    <select id="feedbackSentiment" required="">
                                        <option value="positive">Positive</option>
                                        <option value="neutral">Neutral</option>
                                        <option value="negative">Negative</option>
                                    </select>
                                    <label for="feedbackDetails">Details</label>
                                    <textarea id="feedbackDetails" required="" rows="4"></textarea>
                                    <label for="feedbackStatus">Status</label>
                                    <select id="feedbackStatus" required="">
                                        <option value="pending">Pending</option>
                                        <option value="in-progress">In Progress</option>
                                        <option value="resolved">Resolved</option>
                                        <option value="acknowledged">Acknowledged</option>
                                    </select>
                                </div>
                                <div style="margin-top: 20px;">
                                    <button class="btn-success" type="submit">
                                        <i class="fas fa-save"></i> Save Feedback
                                    </button>
                                    <button class="btn-primary" id="cancelFeedbackForm" style="margin-left: 10px;"
                                        type="button">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- Team Performance Section -->
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Team Performance</h3>
                            <select id="performanceTimeFilter" style="padding: 8px;">
                                <option value="7days">Last 7 Days</option>
                                <option value="30days">Last 30 Days</option>
                                <option value="90days">Last 90 Days</option>
                            </select>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Team Member</th>
                                    <th>Assigned</th>
                                    <th>Resolved</th>
                                    <th>Avg. Resolution Time</th>
                                    <th>CSAT</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Alex Johnson</td>
                                    <td>24</td>
                                    <td>18</td>
                                    <td>1.8d</td>
                                    <td>88%</td>
                                    <td>
                                        <button class="btn-primary">View</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Maria Garcia</td>
                                    <td>18</td>
                                    <td>15</td>
                                    <td>2.1d</td>
                                    <td>85%</td>
                                    <td>
                                        <button class="btn-primary">View</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>David Kim</td>
                                    <td>15</td>
                                    <td>12</td>
                                    <td>2.5d</td>
                                    <td>82%</td>
                                    <td>
                                        <button class="btn-primary">View</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>


                <div class="child-section" id="product-inventory-section">
                    <button class="back-button" onclick="showSection('dashboard-section')">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Product Inventory Overview</h2>
                            <button class="btn-primary" id="addInventoryBtn">
                                <i class="fas fa-plus"></i> Add Product
                            </button>
                        </div>

                        <!-- Stats Cards -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Total Products</div>
                                        <div class="stat-value">28</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            12%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="totalProductsChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Total Stock Value</div>
                                        <div class="stat-value">₹2.8M</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            8.5%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="stockValueChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Avg. Stock Days</div>
                                        <div class="stat-value">14</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            2
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="stockDaysChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Low Stock Items</div>
                                        <div class="stat-value">5</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            1
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="lowStockChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Current Stock Table -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Current Stock Levels</h2>
                            <div>
                                <input id="inventorySearch" placeholder="Search products..." type="text" />
                                <select id="inventoryFilter" style="margin-left: 10px;">
                                    <option value="all">All Products</option>
                                    <option value="low">Low Stock</option>
                                    <option value="liquid">Liquid Milk</option>
                                    <option value="cheese">Cheese Products</option>
                                    <option value="dairy">Dairy Fat</option>
                                </select>
                            </div>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Product ID</th>
                                    <th>Product Name</th>
                                    <th>Category</th>
                                    <th>Current Stock</th>
                                    <th>Min. Stock</th>
                                    <th>Unit Price</th>
                                    <th>Stock Value</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>PD-1001</td>
                                    <td>Standard Milk (1L)</td>
                                    <td>Liquid Milk</td>
                                    <td>12,500</td>
                                    <td>5,000</td>
                                    <td>₹45</td>
                                    <td>₹562,500</td>
                                    <td><span class="status completed">In Stock</span></td>
                                </tr>
                                <tr>
                                    <td>PD-1002</td>
                                    <td>Toned Milk (1L)</td>
                                    <td>Liquid Milk</td>
                                    <td>10,800</td>
                                    <td>5,000</td>
                                    <td>₹40</td>
                                    <td>₹432,000</td>
                                    <td><span class="status completed">In Stock</span></td>
                                </tr>
                                <tr>
                                    <td>PD-1003</td>
                                    <td>Pure Ghee (1kg)</td>
                                    <td>Dairy Fat</td>
                                    <td>1,350</td>
                                    <td>500</td>
                                    <td>₹500</td>
                                    <td>₹675,000</td>
                                    <td><span class="status completed">In Stock</span></td>
                                </tr>
                                <tr>
                                    <td>PD-1004</td>
                                    <td>Fresh Paneer (1kg)</td>
                                    <td>Cheese</td>
                                    <td>850</td>
                                    <td>300</td>
                                    <td>₹200</td>
                                    <td>₹170,000</td>
                                    <td><span class="status completed">In Stock</span></td>
                                </tr>
                                <tr>
                                    <td>PD-1005</td>
                                    <td>Flavored Milk (500ml)</td>
                                    <td>Liquid Milk</td>
                                    <td>3,200</td>
                                    <td>2,000</td>
                                    <td>₹30</td>
                                    <td>₹96,000</td>
                                    <td><span class="status completed">In Stock</span></td>
                                </tr>
                                <tr>
                                    <td>PD-1006</td>
                                    <td>Yogurt (500g)</td>
                                    <td>Fermented</td>
                                    <td>2,600</td>
                                    <td>1,500</td>
                                    <td>₹50</td>
                                    <td>₹130,000</td>
                                    <td><span class="status completed">In Stock</span></td>
                                </tr>
                                <tr>
                                    <td>PD-1007</td>
                                    <td>Cheese Slice (200g)</td>
                                    <td>Cheese</td>
                                    <td>420</td>
                                    <td>500</td>
                                    <td>₹80</td>
                                    <td>₹33,600</td>
                                    <td><span class="status pending">Low Stock</span></td>
                                </tr>
                                <tr>
                                    <td>PD-1008</td>
                                    <td>Butter (100g)</td>
                                    <td>Dairy Fat</td>
                                    <td>380</td>
                                    <td>500</td>
                                    <td>₹60</td>
                                    <td>₹22,800</td>
                                    <td><span class="status pending">Low Stock</span></td>
                                </tr>
                            </tbody>
                        </table>
                        <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                            <div>
                                Showing 1 to 8 of 28 products
                            </div>
                            <div>
                                <button class="btn-primary">Previous</button>
                                <button class="btn-primary">Next</button>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory Charts -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Inventory Analytics</h2>
                            <select id="inventoryTimeRange" style="padding: 8px;">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Stock by Category</h3>
                                <canvas height="200" id="stockCategoryChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Inventory Turnover</h3>
                                <canvas height="200" id="inventoryTurnoverChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory Movements -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Recent Inventory Movements</h2>
                            <button class="btn-primary" id="exportMovementsBtn">
                                <i class="fas fa-download"></i> Export Data
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Product</th>
                                    <th>Type</th>
                                    <th>Quantity</th>
                                    <th>From</th>
                                    <th>To</th>
                                    <th>Reference</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2023-06-15</td>
                                    <td>Standard Milk (1L)</td>
                                    <td>Transfer</td>
                                    <td>1,200</td>
                                    <td>Ahmedabad Plant</td>
                                    <td>Ahmedabad Warehouse</td>
                                    <td>TR-10045</td>
                                </tr>
                                <tr>
                                    <td>2023-06-14</td>
                                    <td>Toned Milk (1L)</td>
                                    <td>Delivery</td>
                                    <td>950</td>
                                    <td>Gandhinagar Plant</td>
                                    <td>Retail Outlets</td>
                                    <td>DL-10044</td>
                                </tr>
                                <tr>
                                    <td>2023-06-14</td>
                                    <td>Pure Ghee (1kg)</td>
                                    <td>Production</td>
                                    <td>250</td>
                                    <td>Production Line</td>
                                    <td>Finished Goods</td>
                                    <td>PR-10043</td>
                                </tr>
                                <tr>
                                    <td>2023-06-13</td>
                                    <td>Fresh Paneer (1kg)</td>
                                    <td>Sale</td>
                                    <td>180</td>
                                    <td>Warehouse</td>
                                    <td>Customer</td>
                                    <td>SO-10042</td>
                                </tr>
                                <tr>
                                    <td>2023-06-12</td>
                                    <td>Flavored Milk (500ml)</td>
                                    <td>Transfer</td>
                                    <td>800</td>
                                    <td>Vadodara Plant</td>
                                    <td>Surat Warehouse</td>
                                    <td>TR-10041</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Expiry Tracking -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Expiry Tracking</h2>
                            <button class="btn-primary" id="viewAllExpiryBtn">
                                View All Expiring Soon
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Batch No.</th>
                                    <th>Current Stock</th>
                                    <th>Production Date</th>
                                    <th>Expiry Date</th>
                                    <th>Days Remaining</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Standard Milk (1L)</td>
                                    <td>B-230615</td>
                                    <td>2,500</td>
                                    <td>2023-06-15</td>
                                    <td>2023-06-22</td>
                                    <td>2</td>
                                    <td><button class="btn-primary">Prioritize</button></td>
                                </tr>
                                <tr>
                                    <td>Toned Milk (1L)</td>
                                    <td>B-230614</td>
                                    <td>1,800</td>
                                    <td>2023-06-14</td>
                                    <td>2023-06-21</td>
                                    <td>1</td>
                                    <td><button class="btn-primary">Prioritize</button></td>
                                </tr>
                                <tr>
                                    <td>Yogurt (500g)</td>
                                    <td>B-230610</td>
                                    <td>850</td>
                                    <td>2023-06-10</td>
                                    <td>2023-06-20</td>
                                    <td>0</td>
                                    <td><button class="btn-danger">Discard</button></td>
                                </tr>
                                <tr>
                                    <td>Fresh Paneer (1kg)</td>
                                    <td>B-230612</td>
                                    <td>320</td>
                                    <td>2023-06-12</td>
                                    <td>2023-06-19</td>
                                    <td>1</td>
                                    <td><button class="btn-primary">Prioritize</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Add Product Form (hidden by default) -->
                    <div class="content-section" id="addProductForm" style="display: none;">
                        <div class="section-header">
                            <h3 class="section-title">Add New Product</h3>
                            <button class="btn-primary" id="closeProductForm">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <form id="productForm">
                            <div class="profile-grid">
                                <label for="productName">Product Name</label>
                                <input id="productName" required type="text" />

                                <label for="productCategory">Category</label>
                                <select id="productCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="liquid">Liquid Milk</option>
                                    <option value="cheese">Cheese Products</option>
                                    <option value="dairy">Dairy Fat</option>
                                    <option value="fermented">Fermented Products</option>
                                    <option value="other">Other</option>
                                </select>

                                <label for="productCode">Product Code</label>
                                <input id="productCode" required type="text" />

                                <label for="productUnit">Unit of Measure</label>
                                <select id="productUnit" required>
                                    <option value="liter">Liter</option>
                                    <option value="kg">Kilogram</option>
                                    <option value="g">Gram</option>
                                    <option value="ml">Milliliter</option>
                                    <option value="pack">Pack</option>
                                </select>

                                <label for="productPrice">Unit Price (₹)</label>
                                <input id="productPrice" required type="number" step="0.01" />

                                <label for="productMinStock">Minimum Stock Level</label>
                                <input id="productMinStock" required type="number" />

                                <label for="productShelfLife">Shelf Life (Days)</label>
                                <input id="productShelfLife" required type="number" />

                                <label for="productDescription">Description</label>
                                <textarea id="productDescription" rows="3"></textarea>
                            </div>
                            <div style="margin-top: 20px;">
                                <button class="btn-success" type="submit">
                                    <i class="fas fa-save"></i> Save Product
                                </button>
                                <button class="btn-primary" id="cancelProductForm" style="margin-left: 10px;"
                                    type="button">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>


                <!-- Delivery Routes Section -->
                <div class="child-section" id="delivery-routes-section">
                    <button class="back-button" onclick="showSection('dashboard-section')">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Delivery Routes Management</h2>
                            <button class="btn-primary" id="addRouteBtn">
                                <i class="fas fa-plus"></i> Add New Route
                            </button>
                        </div>

                        <!-- Stats Cards -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Active Routes</div>
                                        <div class="stat-value">18</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            12.5%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="activeRoutesChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Avg. Delivery Time</div>
                                        <div class="stat-value">2.8h</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            0.3h
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="avgDeliveryTimeChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Completed Today</div>
                                        <div class="stat-value">45</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            8.3%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="completedTodayChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">On-Time Rate</div>
                                        <div class="stat-value">92%</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            1.5%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="onTimeRateChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Delivery Routes Map -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Delivery Routes Map</h2>
                            <div>
                                <select id="routeFilter" style="padding: 8px; margin-right: 10px;">
                                    <option value="all">All Routes</option>
                                    <option value="active">Active Only</option>
                                    <option value="completed">Completed Today</option>
                                    <option value="scheduled">Scheduled</option>
                                </select>
                                <button class="btn-primary" id="refreshMapBtn">
                                    <i class="fas fa-sync-alt"></i> Refresh Map
                                </button>
                            </div>
                        </div>
                        <div id="deliveryMap"
                            style="height: 500px; background-color: #f0f0f0; border-radius: 8px; position: relative;">
                            <div id="mapLoading"
                                style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                                <i class="fas fa-spinner fa-spin"></i> Loading map...
                            </div>
                        </div>
                        <div style="margin-top: 15px; display: flex; justify-content: space-between;">
                            <div>
                                <span class="dot" style="background-color: #4CAF50;"></span> Completed &nbsp;
                                <span class="dot" style="background-color: #2196F3;"></span> In Progress &nbsp;
                                <span class="dot" style="background-color: #FFC107;"></span> Scheduled &nbsp;
                                <span class="dot" style="background-color: #F44336;"></span> Delayed
                            </div>
                            <div>
                                <button class="btn-primary" id="printMapBtn">
                                    <i class="fas fa-print"></i> Print Map
                                </button>
                                <button class="btn-success" id="exportMapBtn" style="margin-left: 10px;">
                                    <i class="fas fa-download"></i> Export
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Delivery Routes Table -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Delivery Routes</h2>
                            <div>
                                <input id="routeSearch" placeholder="Search routes..." type="text" />
                                <button class="btn-primary" id="exportRoutesBtn" style="margin-left: 10px;">
                                    <i class="fas fa-download"></i> Export
                                </button>
                            </div>
                        </div>
                        <table class="recent-orders" id="routesTable">
                            <thead>
                                <tr>
                                    <th>Route ID</th>
                                    <th>Driver</th>
                                    <th>Vehicle</th>
                                    <th>Stops</th>
                                    <th>Distance</th>
                                    <th>Est. Time</th>
                                    <th>Start Time</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="routesTableBody">
                                <!-- Routes will be loaded here dynamically -->
                            </tbody>
                        </table>
                        <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                            <div>
                                Showing <span id="routesShowingFrom">1</span> to <span id="routesShowingTo">5</span> of
                                <span id="routesTotalCount">0</span> routes
                            </div>
                            <div>
                                <button class="btn-primary" id="routesPrevPage">Previous</button>
                                <button class="btn-primary" id="routesNextPage">Next</button>
                            </div>
                        </div>
                    </div>

                    <!-- Route Performance Analytics -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Route Performance Analytics</h2>
                            <select id="analyticsTimeRange" style="padding: 8px;">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Delivery Time Trends</h3>
                                <canvas height="200" id="deliveryTimeTrendChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>On-Time Performance</h3>
                                <canvas height="200" id="onTimePerformanceChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Route Efficiency</h3>
                                <canvas height="200" id="routeEfficiencyChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Driver Performance -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Driver Performance</h2>
                            <button class="btn-primary" id="exportDriverPerformanceBtn">
                                <i class="fas fa-download"></i> Export Report
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Driver</th>
                                    <th>Completed Routes</th>
                                    <th>Avg. Delivery Time</th>
                                    <th>On-Time %</th>
                                    <th>Mileage</th>
                                    <th>Fuel Efficiency</th>
                                    <th>Rating</th>
                                </tr>
                            </thead>
                            <tbody id="driverPerformanceBody">
                                <!-- Driver data will be loaded here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Add Route Form (hidden by default) -->
                    <div class="content-section" id="addRouteForm" style="display: none;">
                        <div class="section-header">
                            <h3 class="section-title">Add New Delivery Route</h3>
                            <button class="btn-primary" id="closeRouteForm">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <form id="routeForm">
                            <div class="profile-grid">
                                <label for="routeName">Route Name</label>
                                <input id="routeName" required type="text" />

                                <label for="routeDriver">Driver</label>
                                <select id="routeDriver" required>
                                    <option value="">Select Driver</option>
                                    <!-- Drivers will be loaded here -->
                                </select>

                                <label for="routeVehicle">Vehicle</label>
                                <select id="routeVehicle" required>
                                    <option value="">Select Vehicle</option>
                                    <!-- Vehicles will be loaded here -->
                                </select>

                                <label for="routeDate">Delivery Date</label>
                                <input id="routeDate" required type="date" />

                                <label for="routeStartTime">Start Time</label>
                                <input id="routeStartTime" required type="time" />

                                <label for="routeStops">Delivery Stops</label>
                                <div id="routeStopsContainer">
                                    <div class="stop-entry" style="display: flex; margin-bottom: 10px;">
                                        <input type="text" class="stop-address" placeholder="Address"
                                            style="flex: 3; margin-right: 10px;" />
                                        <input type="text" class="stop-customer" placeholder="Customer"
                                            style="flex: 2; margin-right: 10px;" />
                                        <input type="number" class="stop-orders" placeholder="Orders"
                                            style="flex: 1; margin-right: 10px;" />
                                        <button type="button" class="btn-danger remove-stop" style="padding: 8px;">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                                <div>
                                    <button type="button" class="btn-primary" id="addStopBtn" style="margin-top: 5px;">
                                        <i class="fas fa-plus"></i> Add Stop
                                    </button>
                                </div>

                                <label for="routeNotes">Notes</label>
                                <textarea id="routeNotes" rows="3"></textarea>

                                <label for="routeStatus">Status</label>
                                <select id="routeStatus" required>
                                    <option value="scheduled">Scheduled</option>
                                    <option value="in-progress">In Progress</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </div>
                            <div style="margin-top: 20px;">
                                <button class="btn-success" type="submit">
                                    <i class="fas fa-save"></i> Save Route
                                </button>
                                <button class="btn-primary" id="cancelRouteForm" style="margin-left: 10px;"
                                    type="button">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Fleet Management Section -->
                <div class="child-section" id="fleet-management-section">
                    <button class="back-button" onclick="showSection('dashboard-section')">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Fleet Management</h2>
                            <button class="btn-primary" id="addVehicleBtn">
                                <i class="fas fa-plus"></i> Add Vehicle
                            </button>
                        </div>

                        <!-- Stats Cards -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Total Vehicles</div>
                                        <div class="stat-value">42</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            8.3%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="totalVehiclesChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Active Vehicles</div>
                                        <div class="stat-value">36</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            5.7%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="activeVehiclesChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Avg. Fuel Efficiency</div>
                                        <div class="stat-value">8.5 km/L</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            0.2 km/L
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="fuelEfficiencyChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Maintenance Due</div>
                                        <div class="stat-value">6</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            1
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="maintenanceDueChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Vehicle List Table -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Vehicle Inventory</h2>
                            <div>
                                <input id="vehicleSearch" placeholder="Search vehicles..." type="text" />
                                <select id="vehicleFilter" style="margin-left: 10px;">
                                    <option value="all">All Vehicles</option>
                                    <option value="active">Active</option>
                                    <option value="maintenance">In Maintenance</option>
                                    <option value="truck">Trucks</option>
                                    <option value="van">Vans</option>
                                    <option value="refrigerated">Refrigerated</option>
                                </select>
                            </div>
                        </div>
                        <table class="recent-orders" id="vehiclesTable">
                            <thead>
                                <tr>
                                    <th>Vehicle ID</th>
                                    <th>Registration No.</th>
                                    <th>Type</th>
                                    <th>Model</th>
                                    <th>Capacity</th>
                                    <th>Current Driver</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>VH-1001</td>
                                    <td>GJ-01-AB-1234</td>
                                    <td>Refrigerated Truck</td>
                                    <td>Tata Ultra 1518</td>
                                    <td>8,000 kg</td>
                                    <td>Rajesh Patel</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>
                                        <button class="btn-primary" onclick="viewVehicleDetails('VH-1001')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn-success" onclick="editVehicle('VH-1001')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>VH-1002</td>
                                    <td>GJ-02-CD-5678</td>
                                    <td>Milk Van</td>
                                    <td>Mahindra Supro</td>
                                    <td>2,000 L</td>
                                    <td>Sunil Sharma</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>
                                        <button class="btn-primary" onclick="viewVehicleDetails('VH-1002')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn-success" onclick="editVehicle('VH-1002')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>VH-1003</td>
                                    <td>GJ-03-EF-9012</td>
                                    <td>Pickup Truck</td>
                                    <td>Tata Ace</td>
                                    <td>1,000 kg</td>
                                    <td>Vijay Singh</td>
                                    <td><span class="status pending">Maintenance</span></td>
                                    <td>
                                        <button class="btn-primary" onclick="viewVehicleDetails('VH-1003')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn-success" onclick="editVehicle('VH-1003')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>VH-1004</td>
                                    <td>GJ-04-GH-3456</td>
                                    <td>Refrigerated Truck</td>
                                    <td>Ashok Leyland 1920</td>
                                    <td>10,000 kg</td>
                                    <td>Anil Gupta</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>
                                        <button class="btn-primary" onclick="viewVehicleDetails('VH-1004')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn-success" onclick="editVehicle('VH-1004')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>VH-1005</td>
                                    <td>GJ-05-IJ-7890</td>
                                    <td>Milk Van</td>
                                    <td>Force Traveller</td>
                                    <td>1,500 L</td>
                                    <td>Mohan Kumar</td>
                                    <td><span class="status scheduled">Scheduled Service</span></td>
                                    <td>
                                        <button class="btn-primary" onclick="viewVehicleDetails('VH-1005')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn-success" onclick="editVehicle('VH-1005')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                            <div>
                                Showing 1 to 5 of 42 vehicles
                            </div>
                            <div>
                                <button class="btn-primary">Previous</button>
                                <button class="btn-primary">Next</button>
                            </div>
                        </div>
                    </div>

                    <!-- Vehicle Utilization Charts -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Vehicle Utilization</h2>
                            <select id="utilizationTimeRange" style="padding: 8px;">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Utilization Rate</h3>
                                <canvas height="200" id="utilizationRateChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Distance Covered</h3>
                                <canvas height="200" id="distanceCoveredChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Fuel Consumption</h3>
                                <canvas height="200" id="fuelConsumptionChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Maintenance Records -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Maintenance Records</h2>
                            <button class="btn-primary" id="addMaintenanceRecordBtn">
                                <i class="fas fa-plus"></i> Add Record
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Service ID</th>
                                    <th>Vehicle</th>
                                    <th>Service Type</th>
                                    <th>Date</th>
                                    <th>Odometer</th>
                                    <th>Cost</th>
                                    <th>Next Service</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>SV-10045</td>
                                    <td>VH-1003 (GJ-03-EF-9012)</td>
                                    <td>Engine Overhaul</td>
                                    <td>2023-06-15</td>
                                    <td>85,200 km</td>
                                    <td>₹25,000</td>
                                    <td>90,000 km</td>
                                    <td><span class="status completed">Completed</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>SV-10044</td>
                                    <td>VH-1005 (GJ-05-IJ-7890)</td>
                                    <td>Scheduled Service</td>
                                    <td>2023-06-14</td>
                                    <td>42,500 km</td>
                                    <td>₹8,500</td>
                                    <td>45,000 km</td>
                                    <td><span class="status completed">Completed</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>SV-10043</td>
                                    <td>VH-1001 (GJ-01-AB-1234)</td>
                                    <td>Brake Replacement</td>
                                    <td>2023-06-12</td>
                                    <td>62,300 km</td>
                                    <td>₹12,000</td>
                                    <td>65,000 km</td>
                                    <td><span class="status completed">Completed</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>SV-10042</td>
                                    <td>VH-1004 (GJ-04-GH-3456)</td>
                                    <td>Refrigeration Unit Service</td>
                                    <td>2023-06-10</td>
                                    <td>38,700 km</td>
                                    <td>₹15,000</td>
                                    <td>40,000 km</td>
                                    <td><span class="status completed">Completed</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>SV-10041</td>
                                    <td>VH-1002 (GJ-02-CD-5678)</td>
                                    <td>Tire Replacement</td>
                                    <td>2023-06-08</td>
                                    <td>57,800 km</td>
                                    <td>₹18,000</td>
                                    <td>60,000 km</td>
                                    <td><span class="status completed">Completed</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Driver Management -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Driver Management</h2>
                            <button class="btn-primary" id="addDriverBtn">
                                <i class="fas fa-plus"></i> Add Driver
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Driver ID</th>
                                    <th>Name</th>
                                    <th>License No.</th>
                                    <th>License Expiry</th>
                                    <th>Assigned Vehicle</th>
                                    <th>Contact</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>DR-1001</td>
                                    <td>Rajesh Patel</td>
                                    <td>GJ0120151234567</td>
                                    <td>2025-03-15</td>
                                    <td>VH-1001</td>
                                    <td>9876543210</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>DR-1002</td>
                                    <td>Sunil Sharma</td>
                                    <td>GJ0220162345678</td>
                                    <td>2024-11-20</td>
                                    <td>VH-1002</td>
                                    <td>8765432109</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>DR-1003</td>
                                    <td>Vijay Singh</td>
                                    <td>GJ0320173456789</td>
                                    <td>2023-12-05</td>
                                    <td>VH-1003</td>
                                    <td>7654321098</td>
                                    <td><span class="status pending">License Expiring</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>DR-1004</td>
                                    <td>Anil Gupta</td>
                                    <td>GJ0420184567890</td>
                                    <td>2026-05-30</td>
                                    <td>VH-1004</td>
                                    <td>6543210987</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>DR-1005</td>
                                    <td>Mohan Kumar</td>
                                    <td>GJ0520195678901</td>
                                    <td>2025-08-12</td>
                                    <td>VH-1005</td>
                                    <td>5432109876</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Add Vehicle Form (hidden by default) -->
                    <div class="content-section" id="addVehicleForm" style="display: none;">
                        <div class="section-header">
                            <h3 class="section-title">Add New Vehicle</h3>
                            <button class="btn-primary" id="closeVehicleForm">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <form id="vehicleForm" onsubmit="return validateVehicleForm()">
                            <div class="profile-grid">
                                <label for="vehicleType">Vehicle Type</label>
                                <select id="vehicleType" required>
                                    <option value="">Select Type</option>
                                    <option value="refrigerated_truck">Refrigerated Truck</option>
                                    <option value="milk_van">Milk Van</option>
                                    <option value="pickup_truck">Pickup Truck</option>
                                    <option value="tanker">Tanker</option>
                                    <option value="other">Other</option>
                                </select>

                                <label for="registrationNumber">Registration Number</label>
                                <input id="registrationNumber" required type="text"
                                    pattern="[A-Za-z]{2}-[0-9]{1,2}-[A-Za-z]{1,2}-[0-9]{4}"
                                    title="Format: XX-00-XX-0000" placeholder="GJ-01-AB-1234" />

                                <label for="make">Make</label>
                                <input id="make" required type="text" />

                                <label for="model">Model</label>
                                <input id="model" required type="text" />

                                <label for="year">Manufacturing Year</label>
                                <input id="year" required type="number" min="2000" max="2025" />

                                <label for="capacity">Capacity</label>
                                <div style="display: flex;">
                                    <input id="capacity" required type="number" step="0.01" min="0" style="flex: 1;" />
                                    <select id="capacityUnit" required style="margin-left: 10px; width: 100px;">
                                        <option value="kg">kg</option>
                                        <option value="liters">liters</option>
                                        <option value="tons">tons</option>
                                    </select>
                                </div>

                                <label for="chassisNumber">Chassis Number</label>
                                <input id="chassisNumber" required type="text" pattern="[A-Za-z0-9]{17}"
                                    title="17-character alphanumeric" />

                                <label for="engineNumber">Engine Number</label>
                                <input id="engineNumber" required type="text" />

                                <label for="fuelType">Fuel Type</label>
                                <select id="fuelType" required>
                                    <option value="diesel">Diesel</option>
                                    <option value="petrol">Petrol</option>
                                    <option value="cng">CNG</option>
                                    <option value="electric">Electric</option>
                                </select>

                                <label for="purchaseDate">Purchase Date</label>
                                <input id="purchaseDate" required type="date" />

                                <label for="purchaseCost">Purchase Cost (₹)</label>
                                <input id="purchaseCost" required type="number" step="0.01" min="0" />

                                <label for="currentValue">Current Value (₹)</label>
                                <input id="currentValue" required type="number" step="0.01" min="0" />

                                <label for="insuranceNumber">Insurance Policy No.</label>
                                <input id="insuranceNumber" required type="text" />

                                <label for="insuranceExpiry">Insurance Expiry</label>
                                <input id="insuranceExpiry" required type="date" />

                                <label for="fitnessExpiry">Fitness Certificate Expiry</label>
                                <input id="fitnessExpiry" required type="date" />

                                <label for="permitExpiry">Permit Expiry</label>
                                <input id="permitExpiry" required type="date" />

                                <label for="assignedDriver">Assigned Driver</label>
                                <select id="assignedDriver">
                                    <option value="">None</option>
                                    <option value="DR-1001">Rajesh Patel</option>
                                    <option value="DR-1002">Sunil Sharma</option>
                                    <option value="DR-1003">Vijay Singh</option>
                                    <option value="DR-1004">Anil Gupta</option>
                                    <option value="DR-1005">Mohan Kumar</option>
                                </select>

                                <label for="vehicleStatus">Status</label>
                                <select id="vehicleStatus" required>
                                    <option value="active">Active</option>
                                    <option value="maintenance">In Maintenance</option>
                                    <option value="inactive">Inactive</option>
                                </select>

                                <label for="vehicleNotes">Notes</label>
                                <textarea id="vehicleNotes" rows="3"></textarea>
                            </div>
                            <div style="margin-top: 20px;">
                                <button class="btn-success" type="submit">
                                    <i class="fas fa-save"></i> Save Vehicle
                                </button>
                                <button class="btn-primary" id="cancelVehicleForm" style="margin-left: 10px;"
                                    type="button">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Vehicle Details Modal (hidden by default) -->
                    <div id="vehicleDetailsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
        background-color: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
                        <div
                            style="background-color: white; padding: 20px; border-radius: 8px; max-width: 800px; max-height: 90vh; overflow-y: auto;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                                <h2 id="modalVehicleTitle">Vehicle Details</h2>
                                <button onclick="closeVehicleModal()"
                                    style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">&times;</button>
                            </div>
                            <div id="vehicleDetailsContent">
                                <!-- Vehicle details will be loaded here -->
                            </div>
                            <div style="margin-top: 20px; text-align: right;">
                                <button class="btn-primary" onclick="closeVehicleModal()">
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Add Driver Form (hidden by default) -->
                    <div class="content-section" id="addDriverForm" style="display: none;">
                        <div class="section-header">
                            <h3 class="section-title">Add New Driver</h3>
                            <button class="btn-primary" id="closeDriverForm">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <form id="driverForm" onsubmit="return validateDriverForm()">
                            <div class="profile-grid">
                                <label for="driverName">Full Name</label>
                                <input id="driverName" required type="text" />

                                <label for="driverLicense">License Number</label>
                                <input id="driverLicense" required type="text" pattern="[A-Za-z0-9]{15,20}"
                                    title="15-20 character alphanumeric" />

                                <label for="licenseType">License Type</label>
                                <select id="licenseType" required>
                                    <option value="LMV">LMV</option>
                                    <option value="HMV">HMV</option>
                                    <option value="HTV">HTV</option>
                                    <option value="international">International</option>
                                </select>

                                <label for="licenseExpiry">License Expiry</label>
                                <input id="licenseExpiry" required type="date" />

                                <label for="driverDob">Date of Birth</label>
                                <input id="driverDob" required type="date" />

                                <label for="driverContact">Contact Number</label>
                                <input id="driverContact" required type="tel" pattern="[0-9]{10}"
                                    title="10-digit phone number" />

                                <label for="driverEmail">Email</label>
                                <input id="driverEmail" type="email" />

                                <label for="driverAddress">Address</label>
                                <textarea id="driverAddress" required rows="3"></textarea>

                                <label for="driverJoiningDate">Joining Date</label>
                                <input id="driverJoiningDate" required type="date" />

                                <label for="driverSalary">Monthly Salary (₹)</label>
                                <input id="driverSalary" required type="number" step="0.01" min="0" />

                                <label for="driverStatus">Status</label>
                                <select id="driverStatus" required>
                                    <option value="active">Active</option>
                                    <option value="on_leave">On Leave</option>
                                    <option value="inactive">Inactive</option>
                                </select>

                                <label for="driverEmergencyContact">Emergency Contact</label>
                                <input id="driverEmergencyContact" required type="tel" pattern="[0-9]{10}"
                                    title="10-digit phone number" />

                                <label for="driverBloodGroup">Blood Group</label>
                                <input id="driverBloodGroup" type="text" />

                                <label for="driverExperience">Experience (Years)</label>
                                <input id="driverExperience" required type="number" min="0" max="50" />

                                <label for="driverNotes">Notes</label>
                                <textarea id="driverNotes" rows="3"></textarea>
                            </div>
                            <div style="margin-top: 20px;">
                                <button class="btn-success" type="submit">
                                    <i class="fas fa-save"></i> Save Driver
                                </button>
                                <button class="btn-primary" id="cancelDriverForm" style="margin-left: 10px;"
                                    type="button">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Retail Section -->
                <div class="child-section" id="retail-section">
                    <button class="back-button" onclick="showSection('dashboard-section')">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Retail Overview</h2>
                            <button class="btn-primary" id="addRetailOutletBtn">
                                <i class="fas fa-plus"></i> Add Outlet
                            </button>
                        </div>

                        <!-- Stats Cards -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Total Outlets</div>
                                        <div class="stat-value">1,248</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            8.3%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="totalOutletsChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Daily Sales</div>
                                        <div class="stat-value">₹5.2M</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            12.5%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="dailySalesChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Avg. Order Value</div>
                                        <div class="stat-value">₹450</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            2.3%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="avgOrderValueChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Customer Satisfaction</div>
                                        <div class="stat-value">92%</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            1.5%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="customerSatisfactionChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sales Performance by Region -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Sales Performance by Region</h2>
                            <select id="salesRegionTimeRange" style="padding: 8px;">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <canvas height="250" id="regionSalesChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <canvas height="250" id="regionGrowthChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Top Performing Outlets -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Top Performing Outlets</h2>
                            <a class="section-link" href="#">View All <i class="fas fa-chevron-right"></i></a>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Outlet ID</th>
                                    <th>Location</th>
                                    <th>Manager</th>
                                    <th>Daily Sales</th>
                                    <th>Monthly Growth</th>
                                    <th>Customer Rating</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>RT-1001</td>
                                    <td>Ahmedabad Main</td>
                                    <td>Rajesh Patel</td>
                                    <td>₹125,000</td>
                                    <td>15.2%</td>
                                    <td>4.8/5</td>
                                    <td><span class="status completed">Active</span></td>
                                </tr>
                                <tr>
                                    <td>RT-1002</td>
                                    <td>Gandhinagar Central</td>
                                    <td>Priya Sharma</td>
                                    <td>₹98,500</td>
                                    <td>12.7%</td>
                                    <td>4.7/5</td>
                                    <td><span class="status completed">Active</span></td>
                                </tr>
                                <tr>
                                    <td>RT-1003</td>
                                    <td>Vadodara West</td>
                                    <td>Vijay Singh</td>
                                    <td>₹87,200</td>
                                    <td>10.5%</td>
                                    <td>4.6/5</td>
                                    <td><span class="status completed">Active</span></td>
                                </tr>
                                <tr>
                                    <td>RT-1004</td>
                                    <td>Surat South</td>
                                    <td>Meena Desai</td>
                                    <td>₹76,800</td>
                                    <td>8.3%</td>
                                    <td>4.5/5</td>
                                    <td><span class="status completed">Active</span></td>
                                </tr>
                                <tr>
                                    <td>RT-1005</td>
                                    <td>Rajkot East</td>
                                    <td>Arun Gupta</td>
                                    <td>₹65,400</td>
                                    <td>7.1%</td>
                                    <td>4.4/5</td>
                                    <td><span class="status completed">Active</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Product Performance -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Product Performance</h2>
                            <select id="productPerformanceTimeRange" style="padding: 8px;">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Top Selling Products</h3>
                                <canvas height="200" id="topProductsChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Product Category Mix</h3>
                                <canvas height="200" id="productCategoryChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory Levels at Outlets -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Inventory Levels at Outlets</h2>
                            <button class="btn-primary" id="exportInventoryLevelsBtn">
                                <i class="fas fa-download"></i> Export Data
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Ahmedabad</th>
                                    <th>Gandhinagar</th>
                                    <th>Vadodara</th>
                                    <th>Surat</th>
                                    <th>Rajkot</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Standard Milk (1L)</td>
                                    <td>1,250</td>
                                    <td>980</td>
                                    <td>1,100</td>
                                    <td>850</td>
                                    <td>750</td>
                                    <td>4,930</td>
                                </tr>
                                <tr>
                                    <td>Toned Milk (1L)</td>
                                    <td>1,100</td>
                                    <td>850</td>
                                    <td>950</td>
                                    <td>780</td>
                                    <td>650</td>
                                    <td>4,330</td>
                                </tr>
                                <tr>
                                    <td>Pure Ghee (1kg)</td>
                                    <td>350</td>
                                    <td>280</td>
                                    <td>320</td>
                                    <td>250</td>
                                    <td>200</td>
                                    <td>1,400</td>
                                </tr>
                                <tr>
                                    <td>Fresh Paneer (1kg)</td>
                                    <td>420</td>
                                    <td>350</td>
                                    <td>380</td>
                                    <td>300</td>
                                    <td>250</td>
                                    <td>1,700</td>
                                </tr>
                                <tr>
                                    <td>Flavored Milk (500ml)</td>
                                    <td>680</td>
                                    <td>550</td>
                                    <td>600</td>
                                    <td>480</td>
                                    <td>400</td>
                                    <td>2,710</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Customer Demographics -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Customer Demographics</h2>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Age Distribution</h3>
                                <canvas height="200" id="ageDistributionChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Purchase Frequency</h3>
                                <canvas height="200" id="purchaseFrequencyChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Payment Methods</h3>
                                <canvas height="200" id="paymentMethodsChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Promotions and Discounts -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Active Promotions</h2>
                            <button class="btn-primary" id="addPromotionBtn">
                                <i class="fas fa-plus"></i> Add Promotion
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Promotion ID</th>
                                    <th>Name</th>
                                    <th>Discount</th>
                                    <th>Products</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                    <th>Redemptions</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>PR-1001</td>
                                    <td>Summer Milk Special</td>
                                    <td>10%</td>
                                    <td>All Milk Products</td>
                                    <td>2023-06-01</td>
                                    <td>2023-06-30</td>
                                    <td>1,245</td>
                                    <td><span class="status completed">Active</span></td>
                                </tr>
                                <tr>
                                    <td>PR-1002</td>
                                    <td>Ghee Combo Offer</td>
                                    <td>15%</td>
                                    <td>Pure Ghee 1kg</td>
                                    <td>2023-06-10</td>
                                    <td>2023-06-25</td>
                                    <td>856</td>
                                    <td><span class="status completed">Active</span></td>
                                </tr>
                                <tr>
                                    <td>PR-1003</td>
                                    <td>New Customer Discount</td>
                                    <td>20%</td>
                                    <td>First Purchase</td>
                                    <td>2023-05-15</td>
                                    <td>2023-07-15</td>
                                    <td>1,502</td>
                                    <td><span class="status completed">Active</span></td>
                                </tr>
                                <tr>
                                    <td>PR-1004</td>
                                    <td>Weekend Special</td>
                                    <td>Buy 1 Get 1</td>
                                    <td>Flavored Milk</td>
                                    <td>2023-06-03</td>
                                    <td>2023-06-18</td>
                                    <td>1,089</td>
                                    <td><span class="status pending">Ending Soon</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Add Outlet Form (hidden by default) -->
                    <div class="content-section" id="addOutletForm" style="display: none;">
                        <div class="section-header">
                            <h3 class="section-title">Add New Retail Outlet</h3>
                            <button class="btn-primary" id="closeOutletForm">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <form id="outletForm">
                            <div class="profile-grid">
                                <label for="outletName">Outlet Name</label>
                                <input id="outletName" required type="text" />

                                <label for="outletLocation">Location</label>
                                <input id="outletLocation" required type="text" />

                                <label for="outletAddress">Full Address</label>
                                <textarea id="outletAddress" required rows="3"></textarea>

                                <label for="outletManager">Manager</label>
                                <input id="outletManager" required type="text" />

                                <label for="outletContact">Contact Number</label>
                                <input id="outletContact" required type="tel" />

                                <label for="outletEmail">Email</label>
                                <input id="outletEmail" required type="email" />

                                <label for="outletCapacity">Daily Capacity (₹)</label>
                                <input id="outletCapacity" required type="number" />

                                <label for="outletStatus">Status</label>
                                <select id="outletStatus" required>
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                    <option value="construction">Under Construction</option>
                                </select>
                            </div>
                            <div style="margin-top: 20px;">
                                <button class="btn-success" type="submit">
                                    <i class="fas fa-save"></i> Save Outlet
                                </button>
                                <button class="btn-primary" id="cancelOutletForm" style="margin-left: 10px;"
                                    type="button">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="child-section" id="retail-outlets-section">
                    <button class="back-button" onclick="showSection('dashboard-section')">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Retail Outlets Management</h2>
                            <button class="btn-primary" id="addOutletBtn">
                                <i class="fas fa-plus"></i> Add New Outlet
                            </button>
                        </div>

                        <!-- Outlet Overview Table -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Outlet Overview</h3>
                                <div>
                                    <input id="outletSearch" placeholder="Search outlets..." type="text" />
                                    <select id="outletFilter" style="margin-left: 10px;">
                                        <option value="all">All Outlets</option>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="low-stock">Low Stock</option>
                                    </select>
                                </div>
                            </div>
                            <table class="recent-orders" id="outletsTable">
                                <thead>
                                    <tr>
                                        <th>Outlet ID</th>
                                        <th>Outlet Name</th>
                                        <th>Location</th>
                                        <th>Manager</th>
                                        <th>Contact</th>
                                        <th>Status</th>
                                        <th>Last Restock</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="outletsTableBody">
                                    <!-- Outlet data will be loaded here -->
                                </tbody>
                            </table>
                            <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                                <div>
                                    Showing <span id="outletShowingFrom">1</span> to <span id="outletShowingTo">5</span>
                                    of
                                    <span id="outletTotalCount">0</span> outlets
                                </div>
                                <div>
                                    <button class="btn-primary" id="outletPrevPage">Previous</button>
                                    <button class="btn-primary" id="outletNextPage">Next</button>
                                </div>
                            </div>
                        </div>

                        <!-- Map Integration -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Outlet Locations</h3>
                                <button class="btn-primary" id="refreshMapBtn">
                                    <i class="fas fa-sync-alt"></i> Refresh Map
                                </button>
                            </div>
                            <div id="outletMap"
                                style="height: 400px; background-color: #f0f0f0; border-radius: 8px; display: flex; justify-content: center; align-items: center;">
                                <p>Map integration would display here (Google Maps or Leaflet.js)</p>
                            </div>
                        </div>

                        <!-- Performance Metrics -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Performance Metrics</h3>
                                <select id="metricsTimeRange" style="padding: 8px;">
                                    <option value="7d">Last 7 Days</option>
                                    <option value="30d">Last 30 Days</option>
                                    <option value="90d">Last 90 Days</option>
                                </select>
                            </div>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <h3>Sales Performance</h3>
                                    <canvas height="200" id="salesPerformanceChart"></canvas>
                                </div>
                                <div class="stat-card">
                                    <h3>Stock Availability</h3>
                                    <canvas height="200" id="stockAvailabilityChart"></canvas>
                                </div>
                                <div class="stat-card">
                                    <h3>Customer Footfall</h3>
                                    <canvas height="200" id="footfallChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Outlet Inventory Snapshot -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Inventory Snapshot</h3>
                                <button class="btn-primary" id="exportInventorySnapshotBtn">
                                    <i class="fas fa-download"></i> Export Data
                                </button>
                            </div>
                            <table class="recent-orders">
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Ahmedabad</th>
                                        <th>Gandhinagar</th>
                                        <th>Vadodara</th>
                                        <th>Surat</th>
                                        <th>Rajkot</th>
                                        <th>Total</th>
                                    </tr>
                                </thead>
                                <tbody id="inventorySnapshotBody">
                                    <!-- Inventory data will be loaded here -->
                                </tbody>
                            </table>
                        </div>

                        <!-- Outlet Activity Timeline -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Recent Outlet Activities</h3>
                                <select id="activityTimeFilter" style="padding: 8px;">
                                    <option value="7d">Last 7 Days</option>
                                    <option value="30d">Last 30 Days</option>
                                    <option value="90d">Last 90 Days</option>
                                </select>
                            </div>
                            <div class="activity-timeline" id="outletActivityTimeline">
                                <!-- Activity items will be loaded here -->
                            </div>
                        </div>

                        <!-- Export/Print Options -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Export Options</h3>
                            </div>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <button class="btn-primary" id="exportOutletsPdfBtn">
                                    <i class="fas fa-file-pdf"></i> Export to PDF
                                </button>
                                <button class="btn-success" id="exportOutletsExcelBtn">
                                    <i class="fas fa-file-excel"></i> Export to Excel
                                </button>
                                <button class="btn-primary" id="printOutletsReportBtn">
                                    <i class="fas fa-print"></i> Print Report
                                </button>
                            </div>
                        </div>

                        <!-- Add Outlet Form (hidden by default) -->
                        <div class="content-section" id="addOutletForm" style="display: none;">
                            <div class="section-header">
                                <h3 class="section-title">Add New Retail Outlet</h3>
                                <button class="btn-primary" id="closeOutletForm">
                                    <i class="fas fa-times"></i> Close
                                </button>
                            </div>
                            <form id="outletForm">
                                <div class="profile-grid">
                                    <label for="outletName">Outlet Name</label>
                                    <input id="outletName" required type="text" />

                                    <label for="outletLocation">Location</label>
                                    <input id="outletLocation" required type="text" />

                                    <label for="outletAddress">Full Address</label>
                                    <textarea id="outletAddress" required rows="3"></textarea>

                                    <label for="outletManager">Manager</label>
                                    <select id="outletManager" required>
                                        <option value="">Select Manager</option>
                                        <!-- Managers will be loaded here -->
                                    </select>

                                    <label for="outletContact">Contact Number</label>
                                    <input id="outletContact" required type="tel" />

                                    <label for="outletEmail">Email</label>
                                    <input id="outletEmail" required type="email" />

                                    <label for="outletHours">Opening Hours</label>
                                    <input id="outletHours" required type="text"
                                        placeholder="e.g., 9:00 AM - 8:00 PM" />

                                    <label for="outletProducts">Products Handled</label>
                                    <select id="outletProducts" multiple style="height: auto;">
                                        <!-- Products will be loaded here -->
                                    </select>

                                    <label for="outletStatus">Status</label>
                                    <select id="outletStatus" required>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="construction">Under Construction</option>
                                    </select>
                                </div>
                                <div style="margin-top: 20px;">
                                    <button class="btn-success" type="submit">
                                        <i class="fas fa-save"></i> Save Outlet
                                    </button>
                                    <button class="btn-primary" id="cancelOutletForm" style="margin-left: 10px;"
                                        type="button">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="child-section" id="sales-data-section">
                    <button class="back-button" onclick="showSection('dashboard-section')">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Sales Data Analytics</h2>
                            <button class="btn-primary" id="addSalesRecordBtn">
                                <i class="fas fa-plus"></i> Add Sales Record
                            </button>
                        </div>

                        <!-- Stats Cards -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Today's Sales</div>
                                        <div class="stat-value">₹1,25,000</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            12.5%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="todaySalesChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Monthly Sales</div>
                                        <div class="stat-value">₹28,50,000</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            8.3%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="monthlySalesChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Avg. Order Value</div>
                                        <div class="stat-value">₹450</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            2.3%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="avgOrderValueChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Top Product</div>
                                        <div class="stat-value">Standard Milk</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            1,200 sales
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="topProductChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sales Data Filters -->
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Filter Sales Data</h3>
                        </div>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 20px;">
                            <div>
                                <label for="salesDateRange">Date Range</label>
                                <select id="salesDateRange" style="padding: 8px;">
                                    <option value="today">Today</option>
                                    <option value="yesterday">Yesterday</option>
                                    <option value="week">This Week</option>
                                    <option value="month" selected>This Month</option>
                                    <option value="quarter">This Quarter</option>
                                    <option value="year">This Year</option>
                                    <option value="custom">Custom Range</option>
                                </select>
                            </div>
                            <div id="customDateRange" style="display: none;">
                                <label for="startDate">From</label>
                                <input id="startDate" type="date" style="padding: 7px;">
                                <label for="endDate" style="margin-left: 10px;">To</label>
                                <input id="endDate" type="date" style="padding: 7px;">
                            </div>
                            <div>
                                <label for="salesProductFilter">Product</label>
                                <select id="salesProductFilter" style="padding: 8px;">
                                    <option value="all">All Products</option>
                                    <option value="standard_milk">Standard Milk</option>
                                    <option value="toned_milk">Toned Milk</option>
                                    <option value="flavored_milk">Flavored Milk</option>
                                    <option value="ghee">Ghee</option>
                                    <option value="paneer">Paneer</option>
                                    <option value="yogurt">Yogurt</option>
                                </select>
                            </div>
                            <div>
                                <label for="salesRegionFilter">Region</label>
                                <select id="salesRegionFilter" style="padding: 8px;">
                                    <option value="all">All Regions</option>
                                    <option value="north">North</option>
                                    <option value="south">South</option>
                                    <option value="east">East</option>
                                    <option value="west">West</option>
                                    <option value="central">Central</option>
                                </select>
                            </div>
                            <div>
                                <label for="salesChannelFilter">Channel</label>
                                <select id="salesChannelFilter" style="padding: 8px;">
                                    <option value="all">All Channels</option>
                                    <option value="retail">Retail</option>
                                    <option value="wholesale">Wholesale</option>
                                    <option value="online">Online</option>
                                    <option value="institutional">Institutional</option>
                                </select>
                            </div>
                            <div>
                                <button class="btn-primary" id="applySalesFilters">
                                    <i class="fas fa-filter"></i> Apply Filters
                                </button>
                                <button class="btn-primary" id="resetSalesFilters" style="margin-left: 10px;">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Sales Data Table -->
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Sales Records</h3>
                            <div>
                                <input id="salesSearch" placeholder="Search sales..." type="text" />
                                <button class="btn-primary" id="exportSalesDataBtn" style="margin-left: 10px;">
                                    <i class="fas fa-download"></i> Export
                                </button>
                            </div>
                        </div>
                        <table class="recent-orders" id="salesTable">
                            <thead>
                                <tr>
                                    <th>Invoice No.</th>
                                    <th>Date</th>
                                    <th>Customer</th>
                                    <th>Product</th>
                                    <th>Quantity</th>
                                    <th>Unit Price</th>
                                    <th>Total Amount</th>
                                    <th>Payment Method</th>
                                    <th>Region</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="salesTableBody">
                                <tr>
                                    <td>INV-10045</td>
                                    <td>2023-06-15</td>
                                    <td>Rajesh Stores</td>
                                    <td>Standard Milk (1L)</td>
                                    <td>50</td>
                                    <td>₹45</td>
                                    <td>₹2,250</td>
                                    <td>Bank Transfer</td>
                                    <td>North</td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>INV-10044</td>
                                    <td>2023-06-15</td>
                                    <td>Priya Dairy</td>
                                    <td>Toned Milk (1L)</td>
                                    <td>30</td>
                                    <td>₹40</td>
                                    <td>₹1,200</td>
                                    <td>Cash</td>
                                    <td>South</td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>INV-10043</td>
                                    <td>2023-06-14</td>
                                    <td>Vikram Supermarket</td>
                                    <td>Ghee (1kg)</td>
                                    <td>10</td>
                                    <td>₹500</td>
                                    <td>₹5,000</td>
                                    <td>Credit Card</td>
                                    <td>East</td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>INV-10042</td>
                                    <td>2023-06-14</td>
                                    <td>Anjali Restaurant</td>
                                    <td>Paneer (1kg)</td>
                                    <td>15</td>
                                    <td>₹200</td>
                                    <td>₹3,000</td>
                                    <td>UPI</td>
                                    <td>West</td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>INV-10041</td>
                                    <td>2023-06-13</td>
                                    <td>Harish Sweets</td>
                                    <td>Flavored Milk (500ml)</td>
                                    <td>40</td>
                                    <td>₹30</td>
                                    <td>₹1,200</td>
                                    <td>Bank Transfer</td>
                                    <td>Central</td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-eye"></i></button>
                                        <button class="btn-success"><i class="fas fa-edit"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                            <div>
                                Showing <span id="salesShowingFrom">1</span> to <span id="salesShowingTo">5</span> of
                                <span id="salesTotalCount">124</span> records
                            </div>
                            <div>
                                <button class="btn-primary" id="salesPrevPage">Previous</button>
                                <button class="btn-primary" id="salesNextPage">Next</button>
                            </div>
                        </div>
                    </div>

                    <!-- Sales Analytics Charts -->
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Sales Analytics</h3>
                            <select id="salesChartType" style="padding: 8px;">
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly" selected>Monthly</option>
                                <option value="quarterly">Quarterly</option>
                                <option value="yearly">Yearly</option>
                            </select>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Sales Trend</h3>
                                <canvas height="250" id="salesTrendChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Product Performance</h3>
                                <canvas height="250" id="productPerformanceChart"></canvas>
                            </div>
                        </div>
                        <div class="stats-grid" style="margin-top: 20px;">
                            <div class="stat-card">
                                <h3>Regional Sales</h3>
                                <canvas height="250" id="regionalSalesChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Channel Distribution</h3>
                                <canvas height="250" id="channelDistributionChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Insights -->
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Customer Insights</h3>
                            <button class="btn-primary" id="refreshCustomerInsights">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Customer Segmentation</h3>
                                <canvas height="250" id="customerSegmentationChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Purchase Frequency</h3>
                                <canvas height="250" id="purchaseFrequencyChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Customer Retention</h3>
                                <canvas height="250" id="customerRetentionChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Add Sales Record Form (hidden by default) -->
                    <div class="content-section" id="addSalesForm" style="display: none;">
                        <div class="section-header">
                            <h3 class="section-title">Add New Sales Record</h3>
                            <button class="btn-primary" id="closeSalesForm">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <form id="salesForm">
                            <div class="profile-grid">
                                <label for="salesDate">Date</label>
                                <input id="salesDate" required type="date" />

                                <label for="salesCustomer">Customer</label>
                                <select id="salesCustomer" required>
                                    <option value="">Select Customer</option>
                                    <option value="1">Rajesh Stores</option>
                                    <option value="2">Priya Dairy</option>
                                    <option value="3">Vikram Supermarket</option>
                                    <option value="4">Anjali Restaurant</option>
                                    <option value="5">Harish Sweets</option>
                                </select>

                                <label for="salesProduct">Product</label>
                                <select id="salesProduct" required>
                                    <option value="">Select Product</option>
                                    <option value="standard_milk">Standard Milk (1L)</option>
                                    <option value="toned_milk">Toned Milk (1L)</option>
                                    <option value="flavored_milk">Flavored Milk (500ml)</option>
                                    <option value="ghee">Ghee (1kg)</option>
                                    <option value="paneer">Paneer (1kg)</option>
                                    <option value="yogurt">Yogurt (500g)</option>
                                </select>

                                <label for="salesQuantity">Quantity</label>
                                <input id="salesQuantity" required type="number" min="1" />

                                <label for="salesUnitPrice">Unit Price (₹)</label>
                                <input id="salesUnitPrice" required type="number" step="0.01" min="0" />

                                <label for="salesTotal">Total Amount (₹)</label>
                                <input id="salesTotal" readonly type="number" step="0.01" />

                                <label for="salesPaymentMethod">Payment Method</label>
                                <select id="salesPaymentMethod" required>
                                    <option value="cash">Cash</option>
                                    <option value="credit_card">Credit Card</option>
                                    <option value="bank_transfer">Bank Transfer</option>
                                    <option value="upi">UPI</option>
                                    <option value="cheque">Cheque</option>
                                </select>

                                <label for="salesRegion">Region</label>
                                <select id="salesRegion" required>
                                    <option value="north">North</option>
                                    <option value="south">South</option>
                                    <option value="east">East</option>
                                    <option value="west">West</option>
                                    <option value="central">Central</option>
                                </select>

                                <label for="salesChannel">Channel</label>
                                <select id="salesChannel" required>
                                    <option value="retail">Retail</option>
                                    <option value="wholesale">Wholesale</option>
                                    <option value="online">Online</option>
                                    <option value="institutional">Institutional</option>
                                </select>

                                <label for="salesNotes">Notes</label>
                                <textarea id="salesNotes" rows="3"></textarea>
                            </div>
                            <div style="margin-top: 20px;">
                                <button class="btn-success" type="submit">
                                    <i class="fas fa-save"></i> Save Record
                                </button>
                                <button class="btn-primary" id="cancelSalesForm" style="margin-left: 10px;"
                                    type="button">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="child-section" id="production-reports-section">
                    <button class="back-button" onclick="showSection('dashboard-section')">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Production Reports</h2>
                            <button class="btn-primary" id="addProductionReportBtn">
                                <i class="fas fa-plus"></i> Add Report
                            </button>
                        </div>

                        <!-- Stats Cards -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Daily Production</div>
                                        <div class="stat-value">125,000 L</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            8.5%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="dailyProductionChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Monthly Production</div>
                                        <div class="stat-value">3.2M L</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            12.3%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="monthlyProductionChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Avg. Efficiency</div>
                                        <div class="stat-value">85%</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            2.1%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="efficiencyChart"></canvas>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Waste Percentage</div>
                                        <div class="stat-value">3.2%</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            0.5%
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="wastePercentageChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Production Reports Table -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Recent Production Reports</h2>
                            <div>
                                <input id="productionSearch" placeholder="Search reports..." type="text" />
                                <select id="productionFilter" style="margin-left: 10px;">
                                    <option value="all">All Reports</option>
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Report ID</th>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Product</th>
                                    <th>Quantity</th>
                                    <th>Efficiency</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="productionReportsTableBody">
                                <!-- Reports will be loaded here -->
                            </tbody>
                        </table>
                        <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                            <div>
                                Showing <span id="productionShowingFrom">1</span> to <span
                                    id="productionShowingTo">5</span> of
                                <span id="productionTotalReports">0</span> reports
                            </div>
                            <div>
                                <button class="btn-primary" id="productionPrevPage">Previous</button>
                                <button class="btn-primary" id="productionNextPage">Next</button>
                            </div>
                        </div>
                    </div>

                    <!-- Production Trends Section -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Production Trends</h2>
                            <select id="productionTrendTimeRange" style="padding: 8px;">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h3>Production Volume</h3>
                                <canvas height="200" id="productionVolumeChart"></canvas>
                            </div>
                            <div class="stat-card">
                                <h3>Product Mix</h3>
                                <canvas height="200" id="productMixChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Plant Performance Comparison -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Plant Performance Comparison</h2>
                            <button class="btn-primary" id="exportPlantPerformanceBtn">
                                <i class="fas fa-download"></i> Export Data
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Plant</th>
                                    <th>Daily Avg.</th>
                                    <th>Weekly Avg.</th>
                                    <th>Monthly Avg.</th>
                                    <th>Efficiency</th>
                                    <th>Waste %</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Ahmedabad</td>
                                    <td>52,000 L</td>
                                    <td>364,000 L</td>
                                    <td>1,560,000 L</td>
                                    <td>88%</td>
                                    <td>2.8%</td>
                                    <td><span class="status completed">Optimal</span></td>
                                </tr>
                                <tr>
                                    <td>Gandhinagar</td>
                                    <td>48,500 L</td>
                                    <td>339,500 L</td>
                                    <td>1,455,000 L</td>
                                    <td>85%</td>
                                    <td>3.1%</td>
                                    <td><span class="status completed">Optimal</span></td>
                                </tr>
                                <tr>
                                    <td>Vadodara</td>
                                    <td>45,200 L</td>
                                    <td>316,400 L</td>
                                    <td>1,356,000 L</td>
                                    <td>82%</td>
                                    <td>3.5%</td>
                                    <td><span class="status pending">Needs Attention</span></td>
                                </tr>
                                <tr>
                                    <td>Surat</td>
                                    <td>42,800 L</td>
                                    <td>299,600 L</td>
                                    <td>1,284,000 L</td>
                                    <td>80%</td>
                                    <td>4.2%</td>
                                    <td><span class="status pending">Needs Attention</span></td>
                                </tr>
                                <tr>
                                    <td>Rajkot</td>
                                    <td>38,500 L</td>
                                    <td>269,500 L</td>
                                    <td>1,155,000 L</td>
                                    <td>78%</td>
                                    <td>4.5%</td>
                                    <td><span class="status pending">Needs Improvement</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Add Report Form (hidden by default) -->
                    <div class="content-section" id="addReportForm" style="display: none;">
                        <div class="section-header">
                            <h3 class="section-title">Add New Production Report</h3>
                            <button class="btn-primary" id="closeReportForm">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <form id="reportForm">
                            <div class="profile-grid">
                                <label for="reportDate">Date</label>
                                <input id="reportDate" required type="date" />

                                <label for="reportType">Report Type</label>
                                <select id="reportType" required>
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>

                                <label for="reportPlant">Plant</label>
                                <select id="reportPlant" required>
                                    <option value="ahmedabad">Ahmedabad</option>
                                    <option value="gandhinagar">Gandhinagar</option>
                                    <option value="vadodara">Vadodara</option>
                                    <option value="surat">Surat</option>
                                    <option value="rajkot">Rajkot</option>
                                </select>

                                <label for="reportProduct">Product</label>
                                <select id="reportProduct" required>
                                    <option value="standard_milk">Standard Milk</option>
                                    <option value="toned_milk">Toned Milk</option>
                                    <option value="flavored_milk">Flavored Milk</option>
                                    <option value="yogurt">Yogurt</option>
                                    <option value="paneer">Paneer</option>
                                    <option value="ghee">Ghee</option>
                                </select>

                                <label for="reportQuantity">Quantity (Liters)</label>
                                <input id="reportQuantity" required type="number" step="0.1" />

                                <label for="reportEfficiency">Efficiency (%)</label>
                                <input id="reportEfficiency" required type="number" min="0" max="100" step="0.1" />

                                <label for="reportWaste">Waste Percentage (%)</label>
                                <input id="reportWaste" required type="number" min="0" max="100" step="0.1" />

                                <label for="reportNotes">Notes</label>
                                <textarea id="reportNotes" rows="3"></textarea>
                            </div>
                            <div style="margin-top: 20px;">
                                <button class="btn-success" type="submit">
                                    <i class="fas fa-save"></i> Save Report
                                </button>
                                <button class="btn-primary" id="cancelReportForm" style="margin-left: 10px;"
                                    type="button">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Add sections for other menu items as needed -->
                <div class="child-section" id="financial-reports-section">
                    <h2 class="section-title">Financial Reports</h2>
                    <br />
                    <!-- Stat Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-title">Cows</div>
                            <div class="stat-value">110</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Customers</div>
                            <div class="stat-value">2,834</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Daily Revenue</div>
                            <div class="stat-value">$2,543</div>
                        </div>
                    </div>
                    <!-- Charts Row -->
                    <div class="stats-grid">
                        <div class="content-section">
                            <h3>Revenue by Product</h3>
                            <canvas id="revenueByProductChart" style="width:300px; height:150px;"></canvas>
                        </div>
                        <div class="content-section">
                            <h3>Sales Growth</h3>
                            <canvas id="salesGrowthChart" style="width:300px; height:150px;"></canvas>
                        </div>
                    </div>
                    <!-- Revenue Table -->
                    <div class="content-section">
                        <h3 class="section-title">Revenue of Dairy Farm</h3>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Product</th>
                                    <th>Amount Earned</th>
                                    <th>Units Sold</th>
                                    <th>Revenue Source</th>
                                    <th>Sales Region</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Sample Rows -->
                                <tr>
                                    <td>March 1, 2025</td>
                                    <td>Milk</td>
                                    <td>$500</td>
                                    <td>1000 liters</td>
                                    <td>Retail</td>
                                    <td>North Region</td>
                                </tr>
                                <tr>
                                    <td>March 2, 2025</td>
                                    <td>Cheese</td>
                                    <td>$300</td>
                                    <td>150 kg</td>
                                    <td>Wholesale</td>
                                    <td>East Region</td>
                                </tr>
                                <tr>
                                    <td>March 3, 2025</td>
                                    <td>Milk</td>
                                    <td>$450</td>
                                    <td>900 liters</td>
                                    <td>Retail</td>
                                    <td>West Region</td>
                                </tr>
                                <tr>
                                    <td>March 4, 2025</td>
                                    <td>Butter</td>
                                    <td>$200</td>
                                    <td>50 kg</td>
                                    <td>Wholesale</td>
                                    <td>South Region</td>
                                </tr>
                                <tr>
                                    <td>March 5, 2025</td>
                                    <td>Milk</td>
                                    <td>$600</td>
                                    <td>1200 liters</td>
                                    <td>Retail</td>
                                    <td>Central Region</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- Add Revenue Form -->
                    <div class="content-section">
                        <h3 class="section-title">Add New Revenue Entry</h3>
                        <form id="addRevenueForm">
                            <input id="revenueDate" required="" type="date" /><br /><br />
                            <input id="revenueProduct" placeholder="Product" required="" type="text" /><br /><br />
                            <input id="revenueAmount" placeholder="Amount Earned" required="" type="text" /><br /><br />
                            <input id="unitsSold" placeholder="Units Sold" required="" type="text" /><br /><br />
                            <input id="revenueSource" placeholder="Revenue Source" required=""
                                type="text" /><br /><br />
                            <input id="salesRegion" placeholder="Sales Region" required="" type="text" /><br /><br />
                            <button class="btn-success" type="submit">Add Revenue</button>
                        </form>
                    </div>
                </div>


                <div class="child-section" id="system-settings-section">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">System Settings</h2>
                        </div>
                        <form id="systemSettingsForm">
                            <div style="margin-bottom: 20px;">
                                <label for="timezone" style="font-weight: bold;">Timezone</label>
                                <select class="input-field" id="timezone">
                                    <option value="UTC-5">(UTC-05:00) Eastern Time</option>
                                    <option value="UTC-6">(UTC-06:00) Central Time</option>
                                    <option value="UTC-7">(UTC-07:00) Mountain Time</option>
                                    <option value="UTC-8">(UTC-08:00) Pacific Time</option>
                                </select>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <label for="dateFormat" style="font-weight: bold;">Date Format</label>
                                <select class="input-field" id="dateFormat">
                                    <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                    <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                    <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                </select>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <label style="font-weight: bold;">Dark Mode</label><br />
                                <label class="switch">
                                    <input id="darkModeToggle" type="checkbox" />
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <!-- New Settings Start -->
                            <!-- System Maintenance Mode -->
                            <div style="margin-bottom: 20px;">
                                <label for="maintenanceModeToggle" style="font-weight: bold;">System Maintenance
                                    Mode</label><br />
                                <label class="switch">
                                    <input id="maintenanceModeToggle" type="checkbox" />
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <!-- Notification Settings -->
                            <div style="margin-bottom: 20px;">
                                <label style="font-weight: bold;">Notification Settings</label>
                                <div class="checkbox-group">
                                    <label><input id="emailNotifications" type="checkbox" /> Email
                                        Notifications</label><br />
                                    <label><input id="smsNotifications" type="checkbox" /> SMS Alerts</label><br />
                                    <label><input id="pushNotifications" type="checkbox" /> Push Notifications</label>
                                </div>
                            </div>
                            <!-- Backup Settings -->
                            <div style="margin-bottom: 20px;">
                                <label for="autoBackupToggle" style="font-weight: bold;">Automatic Backups</label><br />
                                <label class="switch">
                                    <input id="autoBackupToggle" type="checkbox" />
                                    <span class="slider round"></span>
                                </label>
                                <div id="backupTimeContainer" style="margin-top: 10px; display: none;">
                                    <label for="backupTime" style="font-weight: bold;">Backup Time</label><br />
                                    <input class="input-field" id="backupTime" type="time" />
                                </div>
                            </div>
                            <!-- New Settings End -->
                            <div style="margin-top: 30px;">
                                <button class="btn-success" onclick="saveSystemSettings()" type="button">Save
                                    Settings</button>
                                <button class="btn-primary" onclick="resetSystemSettings()"
                                    type="button">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="child-section" id="access-control-section">
                    <button class="back-button" onclick="showSection('dashboard-section')">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    <div class="content-section">
                        <h2 class="section-title">Access Control System</h2>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Total Users</div>
                                        <div class="stat-value">124</div>
                                        <div class="stat-change">
                                            <span>Active: 118</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="totalUsersChart"></canvas>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Security Events</div>
                                        <div class="stat-value">14</div>
                                        <div class="stat-change down">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                            23% (7d)
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="securityEventsChart"></canvas>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Failed Logins</div>
                                        <div class="stat-value">8</div>
                                        <div class="stat-change">
                                            <svg fill="none" height="12" stroke="currentColor" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="12">
                                                <polyline points="18 15 12 9 6 15"></polyline>
                                            </svg>
                                            12% (7d)
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="failedLoginsChart"></canvas>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Last Audit</div>
                                        <div class="stat-value">2d ago</div>
                                        <div class="stat-change">
                                            <span>Issues: 3</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="stat-chart">
                                    <canvas class="mini-chart" id="auditStatusChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <!-- Role Distribution Chart -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Role Distribution</h3>
                                <a class="section-link" href="#">View Details <i class="fas fa-chevron-right"></i></a>
                            </div>
                            <div style="height: 300px;">
                                <canvas id="roleDistributionChart"></canvas>
                            </div>
                        </div>
                        <!-- User Activity Timeline -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Recent User Activity</h3>
                                <div>
                                    <select id="activityFilter" style="padding: 8px; margin-right: 10px;">
                                        <option value="all">All Activities</option>
                                        <option value="login">Logins</option>
                                        <option value="permission">Permission Changes</option>
                                        <option value="security">Security Events</option>
                                    </select>
                                    <button class="btn-primary" id="exportActivityBtn">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                </div>
                            </div>
                            <div style="max-height: 400px; overflow-y: auto;">
                                <div class="activity-timeline">
                                    <div class="timeline-item">
                                        <div class="timeline-marker success"></div>
                                        <div class="timeline-content">
                                            <div class="timeline-header">
                                                <span class="timeline-title">User login</span>
                                                <span class="timeline-time">Today, 10:45 AM</span>
                                            </div>
                                            <div class="timeline-details">
                                                <span>John Smith logged in from 192.168.1.45 (Chrome, Windows)</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-marker warning"></div>
                                        <div class="timeline-content">
                                            <div class="timeline-header">
                                                <span class="timeline-title">Permission change</span>
                                                <span class="timeline-time">Today, 09:30 AM</span>
                                            </div>
                                            <div class="timeline-details">
                                                <span>Admin updated permissions for Sales Team role</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-marker danger"></div>
                                        <div class="timeline-content">
                                            <div class="timeline-header">
                                                <span class="timeline-title">Failed login</span>
                                                <span class="timeline-time">Today, 08:15 AM</span>
                                            </div>
                                            <div class="timeline-details">
                                                <span>3 failed login attempts for mike@example.com from
                                                    45.23.67.189</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-marker info"></div>
                                        <div class="timeline-content">
                                            <div class="timeline-header">
                                                <span class="timeline-title">User created</span>
                                                <span class="timeline-time">Yesterday, 5:30 PM</span>
                                            </div>
                                            <div class="timeline-details">
                                                <span>New user created: Mike Brown (Delivery role)</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-marker success"></div>
                                        <div class="timeline-content">
                                            <div class="timeline-header">
                                                <span class="timeline-title">Password changed</span>
                                                <span class="timeline-time">Yesterday, 4:20 PM</span>
                                            </div>
                                            <div class="timeline-details">
                                                <span>Sarah Johnson updated her password</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Permission Matrix -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Permission Matrix</h3>
                                <button class="btn-primary" id="editPermissionsBtn">
                                    <i class="fas fa-edit"></i> Edit Matrix
                                </button>
                            </div>
                            <div style="overflow-x: auto;">
                                <table class="permission-matrix">
                                    <thead>
                                        <tr>
                                            <th>Module</th>
                                            <th>Admin</th>
                                            <th>Manager</th>
                                            <th>Sales</th>
                                            <th>Support</th>
                                            <th>Delivery</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Dashboard</td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                        </tr>
                                        <tr>
                                            <td>Farmer Management</td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                        </tr>
                                        <tr>
                                            <td>Milk Collection</td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                        </tr>
                                        <tr>
                                            <td>Quality Control</td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                        </tr>
                                        <tr>
                                            <td>Financial Reports</td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                        </tr>
                                        <tr>
                                            <td>Access Control</td>
                                            <td><i class="fas fa-check success"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                            <td><i class="fas fa-times danger"></i></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Quick Links -->
                        <div class="content-section">
                            <div class="section-header">
                                <h3 class="section-title">Quick Actions</h3>
                            </div>
                            <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                                <button class="btn-primary" onclick="showSection('user-management-section')">
                                    <i class="fas fa-user-plus"></i> Add New User
                                </button>
                                <button class="btn-primary">
                                    <i class="fas fa-shield-alt"></i> Run Security Audit
                                </button>
                                <button class="btn-primary">
                                    <i class="fas fa-key"></i> Password Policy
                                </button>
                                <button class="btn-primary">
                                    <i class="fas fa-history"></i> View Audit Logs
                                </button>
                                <button class="btn-primary">
                                    <i class="fas fa-lock"></i> Two-Factor Settings
                                </button>
                                <button class="btn-primary">
                                    <i class="fas fa-download"></i> Export User List
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- User Management Section -->
                <div class="child-section" id="user-management-section">
                    <!-- Existing user management content remains the same -->
                    <button class="back-button" onclick="showSection('access-control-section')">
                        <i class="fas fa-arrow-left"></i> Back to Access Control
                    </button>
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">User Management</h2>
                            <button class="btn-success" id="addUserBtn">
                                <i class="fas fa-plus"></i> Add User
                            </button>
                        </div>
                        <table class="recent-orders">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                    <th>Last Active</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>John Smith</td>
                                    <td>john@example.com</td>
                                    <td>Admin</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>Today, 10:45 AM</td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-edit"></i></button>
                                        <button class="btn-success"><i class="fas fa-key"></i></button>
                                        <button class="btn-danger"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Sarah Johnson</td>
                                    <td>sarah@example.com</td>
                                    <td>Sales</td>
                                    <td><span class="status completed">Active</span></td>
                                    <td>Today, 09:30 AM</td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-edit"></i></button>
                                        <button class="btn-success"><i class="fas fa-key"></i></button>
                                        <button class="btn-danger"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Mike Brown</td>
                                    <td>mike@example.com</td>
                                    <td>Delivery</td>
                                    <td><span class="status pending">Pending</span></td>
                                    <td>Yesterday, 5:30 PM</td>
                                    <td>
                                        <button class="btn-primary"><i class="fas fa-edit"></i></button>
                                        <button class="btn-success"><i class="fas fa-key"></i></button>
                                        <button class="btn-danger"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- Add User Form (hidden by default) -->
                        <div class="content-section" id="addUserForm" style="display: none; margin-top: 20px;">
                            <div class="section-header">
                                <h3 class="section-title">Add New User</h3>
                                <button class="btn-primary" id="closeUserForm">
                                    <i class="fas fa-times"></i> Close
                                </button>
                            </div>
                            <form id="userForm">
                                <div class="profile-grid">
                                    <label for="userName">Full Name</label>
                                    <input id="userName" required="" type="text" />
                                    <label for="userEmail">Email</label>
                                    <input id="userEmail" required="" type="email" />
                                    <label for="userRole">Role</label>
                                    <select id="userRole" required="">
                                        <option value="">Select Role</option>
                                        <option value="admin">Admin</option>
                                        <option value="sales">Sales</option>
                                        <option value="support">Support</option>
                                        <option value="delivery">Delivery</option>
                                    </select>
                                    <label for="userStatus">Status</label>
                                    <select id="userStatus" required="">
                                        <option value="active">Active</option>
                                        <option value="pending">Pending</option>
                                        <option value="disabled">Disabled</option>
                                    </select>
                                </div>
                                <div style="margin-top: 20px;">
                                    <button class="btn-success" type="submit">
                                        <i class="fas fa-save"></i> Save User
                                    </button>
                                    <button class="btn-primary" id="cancelUserForm" style="margin-left: 10px;"
                                        type="button">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- Role Permissions Section -->
                <div class="child-section" id="role-permissions-section">
                    <!-- Existing role permissions content remains the same -->
                    <button class="back-button" onclick="showSection('access-control-section')">
                        <i class="fas fa-arrow-left"></i> Back to Access Control
                    </button>
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Role Permissions</h2>
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Role-Based Permissions</label>
                            <select class="input-field" id="roleSelect" style="width: 200px; margin-bottom: 15px;">
                                <option value="admin">Admin</option>
                                <option value="sales">Sales</option>
                                <option value="support">Support</option>
                                <option value="delivery">Delivery</option>
                            </select>
                            <div class="checkbox-group">
                                <label><input checked="" type="checkbox" /> Full system access</label>
                                <label><input checked="" type="checkbox" /> View customer data</label>
                                <label><input checked="" type="checkbox" /> View delivery routes</label>
                                <label><input checked="" type="checkbox" /> Update delivery status</label>
                                <label><input type="checkbox" /> Manage users</label>
                                <label><input type="checkbox" /> Edit permissions</label>
                                <label><input type="checkbox" /> View financial reports</label>
                                <label><input type="checkbox" /> Edit financial data</label>
                            </div>
                            <button class="btn-success" style="margin-top: 15px;">
                                <i class="fas fa-save"></i> Save Permissions
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Activity Logs Section -->
                <div class="child-section" id="activity-logs-section">
                    <!-- Existing activity logs content remains the same -->
                    <button class="back-button" onclick="showSection('access-control-section')">
                        <i class="fas fa-arrow-left"></i> Back to Access Control
                    </button>
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">Activity Logs</h2>
                            <input placeholder="Search logs..." style="padding: 8px;" type="text" />
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div
                                style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin-bottom: 10px;">
                                <strong>User created John Doe with Sales role</strong><br />
                                <span style="color: #6c757d;">Admin User - Today, 10:45 AM</span><br />
                                <span style="color: #6c757d; font-size: 0.8rem;">IP: 192.168.1.45</span>
                            </div>
                            <div
                                style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin-bottom: 10px;">
                                <strong>Permission updated for Sales Team</strong><br />
                                <span style="color: #6c757d;">Admin User - Today, 09:30 AM</span><br />
                                <span style="color: #6c757d; font-size: 0.8rem;">IP: 192.168.1.45</span>
                            </div>
                            <div
                                style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin-bottom: 10px;">
                                <strong>Failed login attempt for mike@example.com</strong><br />
                                <span style="color: #6c757d;">System - Today, 08:15 AM</span><br />
                                <span style="color: #6c757d; font-size: 0.8rem;">IP: 45.23.67.189 (Blocked after 3
                                    attempts)</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>Showing 1 to 3 of 3 entries</div>
                            <div>
                                <button class="btn-primary" disabled="">Previous</button>
                                <button class="btn-primary" disabled="">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
                <script>




                    // Quality Control Section JavaScript
                    document.addEventListener('DOMContentLoaded', function () {
                        // Initialize quality control section if it exists
                        if (document.getElementById('quality-control-section')) {
                            initializeQualityControl();
                        }
                    });

                    function initializeQualityControl() {
                        // Load initial data
                        loadQualityTests();
                        loadQualityStandards();

                        // Set up event listeners
                        document.getElementById('addQualityTestBtn').addEventListener('click', showAddTestForm);
                        document.getElementById('closeTestForm').addEventListener('click', hideAddTestForm);
                        document.getElementById('cancelTestForm').addEventListener('click', hideAddTestForm);
                        document.getElementById('testForm').addEventListener('submit', saveQualityTest);

                        document.getElementById('editStandardsBtn').addEventListener('click', showEditStandardsForm);
                        document.getElementById('closeStandardsForm').addEventListener('click', hideEditStandardsForm);
                        document.getElementById('cancelStandardsForm').addEventListener('click', hideEditStandardsForm);
                        document.getElementById('standardsForm').addEventListener('submit', saveQualityStandards);

                        document.getElementById('qualitySearch').addEventListener('input', filterQualityTests);
                        document.getElementById('qualityFilter').addEventListener('change', filterQualityTests);
                        document.getElementById('qualityPrevPage').addEventListener('click', goToPrevPage);
                        document.getElementById('qualityNextPage').addEventListener('click', goToNextPage);

                        document.getElementById('qualityTimeRange').addEventListener('change', updateQualityTrends);

                        // Initialize charts
                        initializeQualityCharts();
                    }

                    // Quality Test Data Management
                    function loadQualityTests() {
                        let tests = JSON.parse(localStorage.getItem('qualityTests')) || [];

                        // If no tests exist, create some sample data
                        if (tests.length === 0) {
                            tests = [
                                {
                                    id: 'QT-1001',
                                    batchNo: 'B-230615',
                                    product: 'standard_milk',
                                    testType: 'routine',
                                    fatContent: 4.2,
                                    snfContent: 8.5,
                                    bacteriaCount: 50000,
                                    temperature: 4.1,
                                    status: 'passed',
                                    notes: 'Within all standard limits',
                                    date: '2023-06-15T10:30:00'
                                },
                                {
                                    id: 'QT-1002',
                                    batchNo: 'B-230614',
                                    product: 'toned_milk',
                                    testType: 'routine',
                                    fatContent: 3.8,
                                    snfContent: 8.3,
                                    bacteriaCount: 75000,
                                    temperature: 4.3,
                                    status: 'passed',
                                    notes: 'Slightly high bacteria count but within limit',
                                    date: '2023-06-14T09:15:00'
                                },
                                {
                                    id: 'QT-1003',
                                    batchNo: 'B-230613',
                                    product: 'flavored_milk',
                                    testType: 'random',
                                    fatContent: 2.5,
                                    snfContent: 7.8,
                                    bacteriaCount: 120000,
                                    temperature: 5.2,
                                    status: 'failed',
                                    notes: 'High temperature and bacteria count',
                                    date: '2023-06-13T14:20:00'
                                },
                                {
                                    id: 'QT-1004',
                                    batchNo: 'B-230612',
                                    product: 'yogurt',
                                    testType: 'batch',
                                    fatContent: 3.5,
                                    snfContent: 8.2,
                                    bacteriaCount: 100000,
                                    temperature: 4.0,
                                    status: 'passed',
                                    notes: 'Good quality batch',
                                    date: '2023-06-12T11:45:00'
                                },
                                {
                                    id: 'QT-1005',
                                    batchNo: 'B-230611',
                                    product: 'paneer',
                                    testType: 'complaint',
                                    fatContent: 22.5,
                                    snfContent: 8.8,
                                    bacteriaCount: 150000,
                                    temperature: 6.1,
                                    status: 'failed',
                                    notes: 'Customer complaint verified - high bacteria count',
                                    date: '2023-06-11T16:30:00'
                                }
                            ];
                            localStorage.setItem('qualityTests', JSON.stringify(tests));
                        }

                        // Sort by date (newest first)
                        tests.sort((a, b) => new Date(b.date) - new Date(a.date));

                        // Store in memory for filtering/pagination
                        window.currentQualityTests = tests;
                        window.filteredQualityTests = [...tests];
                        window.currentQualityPage = 1;
                        window.qualityTestsPerPage = 5;

                        renderQualityTests();
                        updateQualityPagination();
                    }

                    function renderQualityTests() {
                        const tableBody = document.getElementById('qualityTestsTableBody');
                        tableBody.innerHTML = '';

                        const startIndex = (window.currentQualityPage - 1) * window.qualityTestsPerPage;
                        const endIndex = Math.min(startIndex + window.qualityTestsPerPage, window.filteredQualityTests.length);

                        const productNames = {
                            'standard_milk': 'Standard Milk',
                            'toned_milk': 'Toned Milk',
                            'flavored_milk': 'Flavored Milk',
                            'yogurt': 'Yogurt',
                            'paneer': 'Paneer',
                            'ghee': 'Ghee'
                        };

                        const testTypes = {
                            'routine': 'Routine',
                            'random': 'Random',
                            'complaint': 'Complaint',
                            'batch': 'Batch'
                        };

                        for (let i = startIndex; i < endIndex; i++) {
                            const test = window.filteredQualityTests[i];
                            const row = document.createElement('tr');

                            const testDate = new Date(test.date);
                            const formattedDate = testDate.toLocaleDateString() + ' ' + testDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                            row.innerHTML = `
            <td>${test.id}</td>
            <td>${test.batchNo}</td>
            <td>${productNames[test.product] || test.product}</td>
            <td>${testTypes[test.testType] || test.testType}</td>
            <td>${test.fatContent}%</td>
            <td>${test.snfContent}%</td>
            <td>${formattedDate}</td>
            <td><span class="status ${test.status === 'passed' ? 'completed' : test.status === 'failed' ? 'pending' : 'scheduled'}">
                ${test.status.charAt(0).toUpperCase() + test.status.slice(1)}
            </span></td>
            <td>
                <button class="btn-primary" onclick="viewQualityTest('${test.id}')"><i class="fas fa-eye"></i></button>
                <button class="btn-success" onclick="editQualityTest('${test.id}')"><i class="fas fa-edit"></i></button>
                <button class="btn-danger" onclick="deleteQualityTest('${test.id}')"><i class="fas fa-trash"></i></button>
            </td>
        `;

                            tableBody.appendChild(row);
                        }
                    }

                    function viewQualityTest(testId) {
                        const test = window.currentQualityTests.find(t => t.id === testId);
                        if (!test) return;

                        const productNames = {
                            'standard_milk': 'Standard Milk',
                            'toned_milk': 'Toned Milk',
                            'flavored_milk': 'Flavored Milk',
                            'yogurt': 'Yogurt',
                            'paneer': 'Paneer',
                            'ghee': 'Ghee'
                        };

                        const testTypes = {
                            'routine': 'Routine',
                            'random': 'Random',
                            'complaint': 'Complaint Investigation',
                            'batch': 'Batch Release'
                        };

                        const testDate = new Date(test.date);
                        const formattedDate = testDate.toLocaleDateString() + ' ' + testDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                        // Create a modal or use a notification to display the details
                        alert(`
        Quality Test Details\n
        ID: ${test.id}\n
        Batch: ${test.batchNo}\n
        Product: ${productNames[test.product] || test.product}\n
        Test Type: ${testTypes[test.testType] || test.testType}\n
        Fat Content: ${test.fatContent}%\n
        SNF Content: ${test.snfContent}%\n
        Bacteria Count: ${test.bacteriaCount} CFU/ml\n
        Temperature: ${test.temperature}°C\n
        Status: ${test.status.charAt(0).toUpperCase() + test.status.slice(1)}\n
        Date: ${formattedDate}\n
        Notes: ${test.notes}
    `);
                    }

                    function editQualityTest(testId) {
                        const test = window.currentQualityTests.find(t => t.id === testId);
                        if (!test) return;

                        document.getElementById('testBatchNo').value = test.batchNo;
                        document.getElementById('testProduct').value = test.product;
                        document.getElementById('testType').value = test.testType;
                        document.getElementById('testFat').value = test.fatContent;
                        document.getElementById('testSnf').value = test.snfContent;
                        document.getElementById('testBacteria').value = test.bacteriaCount;
                        document.getElementById('testTemp').value = test.temperature;
                        document.getElementById('testStatus').value = test.status;
                        document.getElementById('testNotes').value = test.notes;

                        // Store the test ID for updating
                        document.getElementById('testForm').dataset.editingId = testId;

                        showAddTestForm();
                    }

                    function deleteQualityTest(testId) {
                        if (confirm('Are you sure you want to delete this quality test?')) {
                            const tests = JSON.parse(localStorage.getItem('qualityTests')) || [];
                            const updatedTests = tests.filter(test => test.id !== testId);

                            localStorage.setItem('qualityTests', JSON.stringify(updatedTests));
                            loadQualityTests(); // Refresh the table
                        }
                    }

                    function showAddTestForm() {
                        document.getElementById('addTestForm').style.display = 'block';
                        window.scrollTo(0, document.getElementById('addTestForm').offsetTop);
                    }

                    function hideAddTestForm() {
                        document.getElementById('addTestForm').style.display = 'none';
                        document.getElementById('testForm').reset();
                        delete document.getElementById('testForm').dataset.editingId;
                    }

                    function saveQualityTest(e) {
                        e.preventDefault();

                        const testId = document.getElementById('testForm').dataset.editingId || 'QT-' + Date.now().toString().slice(-4);
                        const isEditing = !!document.getElementById('testForm').dataset.editingId;

                        const test = {
                            id: testId,
                            batchNo: document.getElementById('testBatchNo').value,
                            product: document.getElementById('testProduct').value,
                            testType: document.getElementById('testType').value,
                            fatContent: parseFloat(document.getElementById('testFat').value),
                            snfContent: parseFloat(document.getElementById('testSnf').value),
                            bacteriaCount: parseInt(document.getElementById('testBacteria').value),
                            temperature: parseFloat(document.getElementById('testTemp').value),
                            status: document.getElementById('testStatus').value,
                            notes: document.getElementById('testNotes').value,
                            date: new Date().toISOString()
                        };

                        let tests = JSON.parse(localStorage.getItem('qualityTests')) || [];

                        if (isEditing) {
                            // Update existing test
                            tests = tests.map(t => t.id === testId ? test : t);
                        } else {
                            // Add new test
                            tests.unshift(test);
                        }

                        localStorage.setItem('qualityTests', JSON.stringify(tests));
                        loadQualityTests(); // Refresh the table
                        hideAddTestForm();
                        updateQualityCharts();
                    }

                    function filterQualityTests() {
                        const searchTerm = document.getElementById('qualitySearch').value.toLowerCase();
                        const filterValue = document.getElementById('qualityFilter').value;

                        window.filteredQualityTests = window.currentQualityTests.filter(test => {
                            const matchesSearch =
                                test.id.toLowerCase().includes(searchTerm) ||
                                test.batchNo.toLowerCase().includes(searchTerm) ||
                                test.product.toLowerCase().includes(searchTerm);

                            const matchesFilter =
                                filterValue === 'all' ||
                                (filterValue === 'passed' && test.status === 'passed') ||
                                (filterValue === 'failed' && test.status === 'failed') ||
                                (filterValue === 'pending' && test.status === 'pending');

                            return matchesSearch && matchesFilter;
                        });

                        window.currentQualityPage = 1;
                        renderQualityTests();
                        updateQualityPagination();
                    }

                    function updateQualityPagination() {
                        const totalTests = window.filteredQualityTests.length;
                        const totalPages = Math.ceil(totalTests / window.qualityTestsPerPage);

                        const startIndex = (window.currentQualityPage - 1) * window.qualityTestsPerPage + 1;
                        const endIndex = Math.min(startIndex + window.qualityTestsPerPage - 1, totalTests);

                        document.getElementById('qualityShowingFrom').textContent = startIndex;
                        document.getElementById('qualityShowingTo').textContent = endIndex;
                        document.getElementById('qualityTotalTests').textContent = totalTests;

                        document.getElementById('qualityPrevPage').disabled = window.currentQualityPage <= 1;
                        document.getElementById('qualityNextPage').disabled = window.currentQualityPage >= totalPages;
                    }

                    function goToPrevPage() {
                        if (window.currentQualityPage > 1) {
                            window.currentQualityPage--;
                            renderQualityTests();
                            updateQualityPagination();
                        }
                    }

                    function goToNextPage() {
                        const totalPages = Math.ceil(window.filteredQualityTests.length / window.qualityTestsPerPage);
                        if (window.currentQualityPage < totalPages) {
                            window.currentQualityPage++;
                            renderQualityTests();
                            updateQualityPagination();
                        }
                    }

                    // Quality Standards Management
                    function loadQualityStandards() {
                        let standards = JSON.parse(localStorage.getItem('qualityStandards')) || [];

                        // If no standards exist, create some sample data
                        if (standards.length === 0) {
                            standards = [
                                {
                                    product: 'standard_milk',
                                    minFat: 3.8,
                                    maxFat: 4.5,
                                    minSnf: 8.3,
                                    maxSnf: 8.7,
                                    maxBacteria: 100000,
                                    maxTemp: 4.5
                                },
                                {
                                    product: 'toned_milk',
                                    minFat: 3.5,
                                    maxFat: 4.0,
                                    minSnf: 8.1,
                                    maxSnf: 8.5,
                                    maxBacteria: 100000,
                                    maxTemp: 4.5
                                },
                                {
                                    product: 'flavored_milk',
                                    minFat: 2.0,
                                    maxFat: 3.0,
                                    minSnf: 7.5,
                                    maxSnf: 8.0,
                                    maxBacteria: 150000,
                                    maxTemp: 5.0
                                },
                                {
                                    product: 'yogurt',
                                    minFat: 3.0,
                                    maxFat: 3.8,
                                    minSnf: 8.0,
                                    maxSnf: 8.4,
                                    maxBacteria: 100000,
                                    maxTemp: 4.0
                                },
                                {
                                    product: 'paneer',
                                    minFat: 20.0,
                                    maxFat: 25.0,
                                    minSnf: 8.5,
                                    maxSnf: 9.0,
                                    maxBacteria: 200000,
                                    maxTemp: 6.0
                                },
                                {
                                    product: 'ghee',
                                    minFat: 99.5,
                                    maxFat: 99.9,
                                    minSnf: 0.1,
                                    maxSnf: 0.5,
                                    maxBacteria: 50000,
                                    maxTemp: 25.0
                                }
                            ];
                            localStorage.setItem('qualityStandards', JSON.stringify(standards));
                        }

                        renderQualityStandards(standards);
                        window.currentQualityStandards = standards;
                    }

                    function renderQualityStandards(standards) {
                        const tableBody = document.getElementById('qualityStandardsBody');
                        tableBody.innerHTML = '';

                        const productNames = {
                            'standard_milk': 'Standard Milk',
                            'toned_milk': 'Toned Milk',
                            'flavored_milk': 'Flavored Milk',
                            'yogurt': 'Yogurt',
                            'paneer': 'Paneer',
                            'ghee': 'Ghee'
                        };

                        standards.forEach(standard => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
            <td>${productNames[standard.product] || standard.product}</td>
            <td>${standard.minFat}</td>
            <td>${standard.maxFat}</td>
            <td>${standard.minSnf}</td>
            <td>${standard.maxSnf}</td>
            <td>${standard.maxBacteria.toLocaleString()}</td>
            <td>${standard.maxTemp}</td>
        `;
                            tableBody.appendChild(row);
                        });
                    }

                    function showEditStandardsForm() {
                        const editTableBody = document.getElementById('editStandardsBody');
                        editTableBody.innerHTML = '';

                        const productNames = {
                            'standard_milk': 'Standard Milk',
                            'toned_milk': 'Toned Milk',
                            'flavored_milk': 'Flavored Milk',
                            'yogurt': 'Yogurt',
                            'paneer': 'Paneer',
                            'ghee': 'Ghee'
                        };

                        window.currentQualityStandards.forEach(standard => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
            <td>${productNames[standard.product] || standard.product}</td>
            <td><input type="number" step="0.1" value="${standard.minFat}" data-field="minFat" data-product="${standard.product}" style="width: 60px;"></td>
            <td><input type="number" step="0.1" value="${standard.maxFat}" data-field="maxFat" data-product="${standard.product}" style="width: 60px;"></td>
            <td><input type="number" step="0.1" value="${standard.minSnf}" data-field="minSnf" data-product="${standard.product}" style="width: 60px;"></td>
            <td><input type="number" step="0.1" value="${standard.maxSnf}" data-field="maxSnf" data-product="${standard.product}" style="width: 60px;"></td>
            <td><input type="number" value="${standard.maxBacteria}" data-field="maxBacteria" data-product="${standard.product}" style="width: 80px;"></td>
            <td><input type="number" step="0.1" value="${standard.maxTemp}" data-field="maxTemp" data-product="${standard.product}" style="width: 60px;"></td>
        `;
                            editTableBody.appendChild(row);
                        });

                        document.getElementById('editStandardsForm').style.display = 'block';
                        window.scrollTo(0, document.getElementById('editStandardsForm').offsetTop);
                    }

                    function hideEditStandardsForm() {
                        document.getElementById('editStandardsForm').style.display = 'none';
                    }

                    function saveQualityStandards(e) {
                        e.preventDefault();

                        const updatedStandards = [...window.currentQualityStandards];
                        const inputs = document.querySelectorAll('#editStandardsBody input');

                        inputs.forEach(input => {
                            const product = input.dataset.product;
                            const field = input.dataset.field;
                            const value = parseFloat(input.value);

                            const standard = updatedStandards.find(s => s.product === product);
                            if (standard) {
                                standard[field] = value;
                            }
                        });

                        localStorage.setItem('qualityStandards', JSON.stringify(updatedStandards));
                        loadQualityStandards();
                        hideEditStandardsForm();
                    }

                    // Charts and Visualization
                    function initializeQualityCharts() {
                        // Mini charts
                        initializeMiniCharts();

                        // Trend charts
                        initializeTrendCharts();

                        // Update charts when data changes
                        updateQualityCharts();
                    }

                    function initializeMiniCharts() {
                        // Pass Rate Chart
                        new Chart(document.getElementById('passRateChart').getContext('2d'), {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [92, 93, 93.5, 94, 94.2, 94.5],
                                    borderColor: '#2a9d8f',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: { y: { display: false }, x: { display: false } }
                            }
                        });

                        // Fat Content Chart
                        new Chart(document.getElementById('fatContentChart').getContext('2d'), {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [4.3, 4.25, 4.2, 4.22, 4.21, 4.2],
                                    borderColor: '#0077b6',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: { y: { display: false }, x: { display: false } }
                            }
                        });

                        // SNF Content Chart
                        new Chart(document.getElementById('snfContentChart').getContext('2d'), {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [8.4, 8.45, 8.5, 8.52, 8.55, 8.6],
                                    borderColor: '#00b4d8',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: { y: { display: false }, x: { display: false } }
                            }
                        });

                        // Failed Tests Chart
                        new Chart(document.getElementById('failedTestsChart').getContext('2d'), {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [18, 16, 15, 14, 13, 12],
                                    borderColor: '#e76f51',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: { y: { display: false }, x: { display: false } }
                            }
                        });
                    }

                    function initializeTrendCharts() {
                        // Fat Trend Chart
                        window.fatTrendChart = new Chart(document.getElementById('fatTrendChart').getContext('2d'), {
                            type: 'line',
                            data: { labels: [], datasets: [] },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: { display: true, text: 'Fat Content Trend' }
                                }
                            }
                        });

                        // SNF Trend Chart
                        window.snfTrendChart = new Chart(document.getElementById('snfTrendChart').getContext('2d'), {
                            type: 'line',
                            data: { labels: [], datasets: [] },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: { display: true, text: 'SNF Content Trend' }
                                }
                            }
                        });

                        updateQualityTrends();
                    }

                    function updateQualityTrends() {
                        const timeRange = document.getElementById('qualityTimeRange').value;
                        let daysBack;

                        switch (timeRange) {
                            case '7d': daysBack = 7; break;
                            case '30d': daysBack = 15; break;
                            case '30d': daysBack = 30; break;
                            case '90d': daysBack = 90; break;
                            default: daysBack = 7;
                        }

                        const endDate = new Date();
                        const startDate = new Date();
                        startDate.setDate(endDate.getDate() - daysBack);

                        // Filter tests within the date range
                        const tests = JSON.parse(localStorage.getItem('qualityTests')) || [];
                        const filteredTests = tests.filter(test => {
                            const testDate = new Date(test.date);
                            return testDate >= startDate && testDate <= endDate;
                        });

                        // Group by date and calculate averages
                        const dateMap = {};
                        filteredTests.forEach(test => {
                            const testDate = new Date(test.date).toLocaleDateString();
                            if (!dateMap[testDate]) {
                                dateMap[testDate] = {
                                    fatSum: 0,
                                    snfSum: 0,
                                    count: 0
                                };
                            }
                            dateMap[testDate].fatSum += test.fatContent;
                            dateMap[testDate].snfSum += test.snfContent;
                            dateMap[testDate].count++;
                        });

                        // Prepare data for charts
                        const dates = Object.keys(dateMap).sort();
                        const fatAverages = dates.map(date => (dateMap[date].fatSum / dateMap[date].count).toFixed(2));
                        const snfAverages = dates.map(date => (dateMap[date].snfSum / dateMap[date].count).toFixed(2));

                        // Update Fat Trend Chart
                        window.fatTrendChart.data.labels = dates;
                        window.fatTrendChart.data.datasets = [{
                            label: 'Average Fat Content (%)',
                            data: fatAverages,
                            borderColor: '#0077b6',
                            backgroundColor: 'rgba(0, 119, 182, 0.1)',
                            fill: true,
                            tension: 0.3
                        }];
                        window.fatTrendChart.update();

                        // Update SNF Trend Chart
                        window.snfTrendChart.data.labels = dates;
                        window.snfTrendChart.data.datasets = [{
                            label: 'Average SNF Content (%)',
                            data: snfAverages,
                            borderColor: '#00b4d8',
                            backgroundColor: 'rgba(0, 180, 216, 0.1)',
                            fill: true,
                            tension: 0.3
                        }];
                        window.snfTrendChart.update();
                    }

                    function updateQualityCharts() {
                        // Update mini charts with latest data
                        const tests = JSON.parse(localStorage.getItem('qualityTests')) || [];

                        // Calculate pass rate
                        const passedTests = tests.filter(test => test.status === 'passed').length;
                        const passRate = tests.length > 0 ? (passedTests / tests.length * 100).toFixed(1) : 0;

                        // Calculate average fat and SNF
                        const totalFat = tests.reduce((sum, test) => sum + test.fatContent, 0);
                        const totalSnf = tests.reduce((sum, test) => sum + test.snfContent, 0);
                        const avgFat = tests.length > 0 ? (totalFat / tests.length).toFixed(1) : 0;
                        const avgSnf = tests.length > 0 ? (totalSnf / tests.length).toFixed(1) : 0;

                        // Calculate failed tests in last 30 days
                        const thirtyDaysAgo = new Date();
                        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                        const recentFailedTests = tests.filter(test =>
                            test.status === 'failed' && new Date(test.date) >= thirtyDaysAgo
                        ).length;

                        // Update the displayed values
                        document.querySelector('.stat-card:nth-child(1) .stat-value').textContent = `${passRate}%`;
                        document.querySelector('.stat-card:nth-child(2) .stat-value').textContent = `${avgFat}%`;
                        document.querySelector('.stat-card:nth-child(3) .stat-value').textContent = `${avgSnf}%`;
                        document.querySelector('.stat-card:nth-child(4) .stat-value').textContent = recentFailedTests;

                        // Update trend charts
                        updateQualityTrends();
                    }

                    // Toggle sidebar on mobile
                    document.getElementById('menuToggle').addEventListener('click', function () {
                        document.getElementById('sidebar').classList.toggle('show');
                    });

                    // Toggle status dropdown
                    document.getElementById('userProfile').addEventListener('click', function (e) {
                        e.stopPropagation();
                        document.getElementById('statusDropdown').classList.toggle('show');
                    });

                    // Toggle language dropdown
                    document.getElementById('languageButton').addEventListener('click', function (e) {
                        e.stopPropagation();
                        document.getElementById('languageDropdown').classList.toggle('show');
                    });

                    // Close dropdowns when clicking outside
                    document.addEventListener('click', function () {
                        document.getElementById('statusDropdown').classList.remove('show');
                        document.getElementById('languageDropdown').classList.remove('show');
                    });

                    // Status selection
                    document.querySelectorAll('.status-option').forEach(option => {
                        option.addEventListener('click', function () {
                            const status = this.getAttribute('data-status');
                            const indicator = document.querySelector('.user-profile .status-indicator');

                            // Remove all status classes
                            indicator.classList.remove('status-active', 'status-away', 'status-busy', 'status-offline');

                            // Add selected status class
                            indicator.classList.add(`status-${status}`);
                        });
                    });

                    // Language selection
                    document.querySelectorAll('.language-option').forEach(option => {
                        option.addEventListener('click', function () {
                            const lang = this.getAttribute('data-lang');
                            const flag = this.querySelector('img').src;
                            const text = this.querySelector('span').textContent;

                            // Update language button
                            const button = document.getElementById('languageButton');
                            button.querySelector('img').src = flag;
                            button.querySelector('span').textContent = lang.toUpperCase();

                            // Close dropdown
                            document.getElementById('languageDropdown').classList.remove('show');

                            // Here you would typically reload content in the selected language
                            console.log(`Language changed to ${text}`);
                        });
                    });

                    // Submenu toggle functionality
                    document.querySelectorAll('.has-submenu > a').forEach(link => {
                        link.addEventListener('click', function (e) {
                            if (window.innerWidth > 768) {
                                e.preventDefault();
                                const submenu = this.nextElementSibling;
                                this.classList.toggle('expanded');
                                submenu.classList.toggle('show');
                            }
                        });
                    });

                    // Function to show specific sections
                    function showSection(sectionId) {
                        // Hide all child sections
                        document.querySelectorAll('.child-section').forEach(section => {
                            section.classList.remove('active');
                        });

                        // Show the requested section
                        document.getElementById(sectionId).classList.add('active');

                        // Update active state in sidebar
                        document.querySelectorAll('.sidebar-menu a').forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('data-section') === sectionId) {
                                link.classList.add('active');
                            }
                        });

                        // Close mobile sidebar if open
                        if (window.innerWidth <= 992) {
                            document.getElementById('sidebar').classList.remove('show');
                        }
                    }

                    // Set up click handlers for all sidebar links
                    document.querySelectorAll('.sidebar-menu a').forEach(link => {
                        if (link.getAttribute('data-section')) {
                            link.addEventListener('click', function (e) {
                                e.preventDefault();
                                showSection(this.getAttribute('data-section'));
                            });
                        }
                    });

                    // Highlight current page in sidebar
                    document.addEventListener('DOMContentLoaded', function () {
                        // Initialize charts
                        initializeCharts();

                        // Set dashboard as default active section
                        showSection('dashboard-section');
                    });

                    // Initialize dashboard charts
                    function initializeCharts() {
                        // Milk Production Chart
                        const milkCtx = document.getElementById('milkChart').getContext('2d');
                        new Chart(milkCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [200, 210, 220, 230, 240, 250],
                                    borderColor: '#0077b6',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Sales Revenue Chart
                        const revenueCtx = document.getElementById('revenueChart').getContext('2d');
                        new Chart(revenueCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [900, 950, 1000, 1050, 1100, 1200],
                                    backgroundColor: '#00b4d8',
                                    borderWidth: 0
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Active Farmers Chart
                        const farmersCtx = document.getElementById('farmersChart').getContext('2d');
                        new Chart(farmersCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [4500, 4600, 4700, 4800, 4900, 5000],
                                    borderColor: '#2a9d8f',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Retail Network Chart
                        const retailCtx = document.getElementById('retailChart').getContext('2d');
                        new Chart(retailCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [1000, 1020, 1040, 1060, 1080, 1200],
                                    backgroundColor: '#e9c46a',
                                    borderWidth: 0
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Quality Metrics Chart
                        const qualityCtx = document.getElementById('qualityChart').getContext('2d');
                        new Chart(qualityCtx, {
                            type: 'doughnut',
                            data: {
                                labels: ['Passed', 'Failed'],
                                datasets: [{
                                    data: [85, 15],
                                    backgroundColor: ['#2a9d8f', '#e76f51'],
                                    borderWidth: 0
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                cutout: '70%',
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Sustainability Chart
                        const sustainabilityCtx = document.getElementById('sustainabilityChart').getContext('2d');
                        new Chart(sustainabilityCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [80, 79, 78, 77, 78, 78],
                                    borderColor: '#e76f51',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Farmer Management Charts
                        const totalFarmersCtx = document.getElementById('totalFarmersChart').getContext('2d');
                        new Chart(totalFarmersCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [4800, 4900, 5000, 5100, 5200, 5247],
                                    borderColor: '#0077b6',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Add similar chart initializations for other sections as needed



                        // Profile Section JavaScript
                        document.addEventListener('DOMContentLoaded', function () {
                            // Only initialize if profile section exists
                            if (document.getElementById('profile-section')) {
                                loadProfileData();

                                // Set up event listeners
                                document.getElementById('editProfileBtn').addEventListener('click', enableEditing);
                                document.getElementById('saveProfileBtn').addEventListener('click', saveProfile);
                                document.getElementById('cancelEditBtn').addEventListener('click', cancelEditing);
                                document.getElementById('changeAvatarBtn').addEventListener('click', function (e) {
                                    e.preventDefault();
                                    document.getElementById('avatarInput').click();
                                });
                                document.getElementById('avatarInput').addEventListener('change', handleAvatarUpload);
                            }
                        });

                        function loadProfileData() {
                            const profileData = JSON.parse(localStorage.getItem('userProfile')) || {};

                            if (profileData.fullName) {
                                document.getElementById('fullName').value = profileData.fullName;
                                document.getElementById('phone').value = profileData.phone;
                                document.getElementById('email').value = profileData.email;
                                document.getElementById('address').value = profileData.address;

                                // Update avatar initials
                                const names = profileData.fullName.split(' ');
                                const initials = names[0].charAt(0) + (names.length > 1 ? names[names.length - 1].charAt(0) : '');
                                document.getElementById('avatarDisplay').textContent = initials;

                                // Update avatar image if exists
                                if (profileData.avatar) {
                                    document.getElementById('avatarDisplay').style.backgroundImage = `url(${profileData.avatar})`;
                                    document.getElementById('avatarDisplay').style.backgroundSize = 'cover';
                                    document.getElementById('avatarDisplay').textContent = '';
                                }
                            }
                        }

                        function enableEditing() {
                            const inputs = document.querySelectorAll('#profileForm input, #profileForm textarea');
                            inputs.forEach(input => {
                                input.readOnly = false;
                                input.style.backgroundColor = 'white';
                                input.style.border = '1px solid var(--primary)';
                            });

                            document.getElementById('formActions').style.display = 'block';
                            document.getElementById('editProfileBtn').style.display = 'none';
                        }

                        function cancelEditing() {
                            const inputs = document.querySelectorAll('#profileForm input, #profileForm textarea');
                            inputs.forEach(input => {
                                input.readOnly = true;
                                input.style.backgroundColor = '';
                                input.style.border = '1px solid var(--dark)';
                            });

                            document.getElementById('formActions').style.display = 'none';
                            document.getElementById('editProfileBtn').style.display = 'block';

                            // Reload original data
                            loadProfileData();
                        }

                        function saveProfile() {
                            const profileData = {
                                fullName: document.getElementById('fullName').value,
                                phone: document.getElementById('phone').value,
                                email: document.getElementById('email').value,
                                address: document.getElementById('address').value,
                                avatar: localStorage.getItem('userAvatar') || ''
                            };

                            localStorage.setItem('userProfile', JSON.stringify(profileData));

                            // Update avatar initials
                            const names = profileData.fullName.split(' ');
                            const initials = names[0].charAt(0) + (names.length > 1 ? names[names.length - 1].charAt(0) : '');
                            document.getElementById('avatarDisplay').textContent = initials;

                            // Disable editing
                            cancelEditing();

                            alert('Profile saved successfully!');
                        }

                        function handleAvatarUpload(event) {
                            const file = event.target.files[0];
                            if (file) {
                                const reader = new FileReader();
                                reader.onload = function (e) {
                                    const avatarDisplay = document.getElementById('avatarDisplay');
                                    avatarDisplay.style.backgroundImage = `url(${e.target.result})`;
                                    avatarDisplay.style.backgroundSize = 'cover';
                                    avatarDisplay.textContent = '';

                                    // Save to localStorage
                                    localStorage.setItem('userAvatar', e.target.result);

                                    // Update profile data
                                    const profileData = JSON.parse(localStorage.getItem('userProfile')) || {};
                                    profileData.avatar = e.target.result;
                                    localStorage.setItem('userProfile', JSON.stringify(profileData));
                                };
                                reader.readAsDataURL(file);
                            }
                        }
                    }
                    document.getElementById('editProfileBtn').addEventListener('click', function () {
                        const inputs = document.querySelectorAll('#profileForm input, #profileForm textarea');
                        inputs.forEach(input => input.removeAttribute('readonly'));

                        document.getElementById('formActions').style.display = 'flex';
                    });

                    document.getElementById('cancelEditBtn').addEventListener('click', function () {
                        const inputs = document.querySelectorAll('#profileForm input, #profileForm textarea');
                        inputs.forEach(input => input.setAttribute('readonly', true));

                        document.getElementById('formActions').style.display = 'none';
                    });
                    document.getElementById('saveProfileBtn').addEventListener('click', function () {
                        alert('Profile saved!');
                        const inputs = document.querySelectorAll('#profileForm input, #profileForm textarea');
                        inputs.forEach(input => input.setAttribute('readonly', true));

                        document.getElementById('formActions').style.display = 'none';
                    });
                    document.getElementById('changeAvatarBtn').addEventListener('click', function () {
                        document.getElementById('avatarInput').click();
                    });

                    document.getElementById('avatarInput').addEventListener('change', function () {
                        const file = this.files[0];
                        if (file && file.type.startsWith('image/')) {
                            const reader = new FileReader();
                            reader.onload = function (e) {
                                const avatarDisplay = document.getElementById('avatarDisplay');
                                avatarDisplay.style.backgroundImage = `url('${e.target.result}')`;
                                avatarDisplay.textContent = ''; // Remove initials when image is added
                                avatarDisplay.style.backgroundSize = 'cover';
                                avatarDisplay.style.backgroundPosition = 'center';
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    document.getElementById('exportPdfBtn').addEventListener('click', function () {
                        // Select only the Delivery Schedule table
                        const deliveryTable = document.querySelector('#profile-section .content-section table');

                        html2canvas(deliveryTable).then(canvas => {
                            const imgData = canvas.toDataURL('image/png');
                            const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
                            const pageWidth = pdf.internal.pageSize.getWidth();
                            const imgProps = pdf.getImageProperties(imgData);
                            const pdfWidth = pageWidth;
                            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

                            pdf.addImage(imgData, 'PNG', 0, 10, pdfWidth, pdfHeight);
                            pdf.save('delivery-schedule.pdf');
                        });
                    });

                    document.getElementById('addDeliveryBtn').addEventListener('click', function () {
                        document.getElementById('addDeliveryForm').style.display = 'block';
                    });

                    document.getElementById('saveDeliveryBtn').addEventListener('click', function () {
                        const delivery = {
                            id: document.getElementById('deliveryID').value,
                            date: document.getElementById('deliveryDate').value,
                            customer: document.getElementById('customer').value,
                            products: document.getElementById('products').value,
                            quantity: document.getElementById('quantity').value,
                            status: document.getElementById('status').value
                        };

                        // Get current deliveries from local storage
                        const deliveries = JSON.parse(localStorage.getItem('deliveries') || '[]');
                        deliveries.push(delivery);
                        localStorage.setItem('deliveries', JSON.stringify(deliveries));

                        insertDeliveryRow(delivery); // Adds row to table
                        document.getElementById('addDeliveryForm').reset();
                        document.getElementById('addDeliveryForm').style.display = 'none';
                    });
                    function insertDeliveryRow(delivery) {
                        const table = document.querySelector('#profile-section table tbody');
                        const row = document.createElement('tr');

                        row.innerHTML = `
                <td>${delivery.id}</td>
                <td>${new Date(delivery.date).toLocaleDateString()}<br>${new Date(delivery.date).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</td>
                <td>${delivery.customer.replace('\n', '<br>')}</td>
                <td>${delivery.products}</td>
                <td>${delivery.quantity}</td>
                <td><span class="status ${delivery.status}">${delivery.status.charAt(0).toUpperCase() + delivery.status.slice(1)}</span></td>
                <td><button>View Details</button></td>
            `;

                        table.appendChild(row);
                    }

                    document.addEventListener('DOMContentLoaded', function () {
                        const savedDeliveries = JSON.parse(localStorage.getItem('deliveries') || '[]');
                        savedDeliveries.forEach(delivery => insertDeliveryRow(delivery));
                    });

                    document.getElementById('exportPaymentPdfBtn').addEventListener('click', function () {
                        const paymentTable = document.querySelector('#profile-section .content-section:nth-of-type(3) table'); // Adjust if needed

                        html2canvas(paymentTable).then(canvas => {
                            const imgData = canvas.toDataURL('image/png');
                            const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
                            const pageWidth = pdf.internal.pageSize.getWidth();
                            const imgProps = pdf.getImageProperties(imgData);
                            const pdfWidth = pageWidth;
                            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

                            pdf.setFontSize(14);
                            pdf.text("Payment Methods", 10, 10);
                            pdf.addImage(imgData, 'PNG', 0, 20, pdfWidth, pdfHeight);
                            pdf.save('payment-methods.pdf');
                        });
                    });

                    function saveSystemSettings() {
                        const timezone = document.getElementById('timezone').value;
                        const dateFormat = document.getElementById('dateFormat').value;
                        const darkModeEnabled = document.getElementById('darkModeToggle').checked;

                        // New fields
                        const maintenanceModeEnabled = document.getElementById('maintenanceModeToggle').checked;
                        const emailNotifications = document.getElementById('emailNotifications').checked;
                        const smsNotifications = document.getElementById('smsNotifications').checked;
                        const pushNotifications = document.getElementById('pushNotifications').checked;
                        const autoBackupEnabled = document.getElementById('autoBackupToggle').checked;
                        const backupTime = document.getElementById('backupTime').value;

                        // Print collected values (for now)
                        console.log({
                            timezone,
                            dateFormat,
                            darkModeEnabled,
                            maintenanceModeEnabled,
                            emailNotifications,
                            smsNotifications,
                            pushNotifications,
                            autoBackupEnabled,
                            backupTime
                        });
                    }

                    document.getElementById('autoBackupToggle').addEventListener('change', function () {
                        document.getElementById('backupTimeContainer').style.display = this.checked ? 'block' : 'none';
                    });


                    // Toggle sidebar on mobile
                    document.getElementById('menuToggle').addEventListener('click', function () {
                        document.getElementById('sidebar').classList.toggle('show');
                    });

                    // Toggle status dropdown (optional, if this was in your script)
                    const userProfile = document.getElementById("userProfile");
                    const statusDropdown = document.getElementById("statusDropdown");
                    if (userProfile) {
                        userProfile.addEventListener("click", () => {
                            statusDropdown.classList.toggle("show");
                        });
                    }

                    // Show child sections
                    function showSection(sectionId) {
                        const sections = document.querySelectorAll('.child-section');
                        sections.forEach(section => section.classList.remove('active'));
                        const target = document.getElementById(sectionId);
                        if (target) target.classList.add('active');
                    }

                    // -------------------------------
                    // 🔹 Chart: Revenue by Product
                    // -------------------------------
                    const revenueByProductCtx = document.getElementById('revenueByProductChart').getContext('2d');
                    const revenueByProductChart = new Chart(revenueByProductCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Milk', 'Cheese', 'Butter', 'Paneer', 'Ghee'],
                            datasets: [{
                                label: 'Revenue ($)',
                                data: [500, 300, 200, 400, 350],
                                backgroundColor: ['#0077b6', '#00b4d8', '#90e0ef', '#48cae4', '#023e8a']
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: { display: false },
                                title: { display: true, text: 'Revenue by Product' }
                            }
                        }
                    });

                    // -------------------------------
                    // 🔹 Chart: Sales Growth
                    // -------------------------------
                    const salesGrowthCtx = document.getElementById('salesGrowthChart').getContext('2d');
                    const salesGrowthChart = new Chart(salesGrowthCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May'],
                            datasets: [{
                                label: 'Monthly Revenue ($)',
                                data: [1800, 2100, 2500, 2700, 3000],
                                borderColor: '#2a9d8f',
                                backgroundColor: 'rgba(42, 157, 143, 0.2)',
                                tension: 0.3,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                title: { display: true, text: 'Sales Growth Over Time' }
                            }
                        }
                    });

                    // -----------------------------------------------
                    // 🧾 Handle "Add New Revenue" form submission
                    // -----------------------------------------------
                    document.getElementById('addRevenueForm').addEventListener('submit', function (e) {
                        e.preventDefault(); // prevent reload

                        const date = document.getElementById('revenueDate').value;
                        const product = document.getElementById('revenueProduct').value;
                        const amount = document.getElementById('revenueAmount').value;
                        const units = document.getElementById('unitsSold').value;
                        const source = document.getElementById('revenueSource').value;
                        const region = document.getElementById('salesRegion').value;

                        const newRow = `
                    <tr>
                        <td>${date}</td>
                        <td>${product}</td>
                        <td>${amount}</td>
                        <td>${units}</td>
                        <td>${source}</td>
                        <td>${region}</td>
                    </tr>
                `;

                        const tableBody = document.querySelector('#financial-reports-section .recent-orders tbody');
                        tableBody.insertAdjacentHTML('beforeend', newRow);

                        this.reset(); // optional: clear form
                    });
                    const menuToggle = document.getElementById('menuToggle');
                    const sidebar = document.getElementById('sidebar');
                    const contentArea = document.querySelector('.content-area');

                    menuToggle.addEventListener('click', function () {
                        sidebar.classList.toggle('hide');
                        contentArea.classList.toggle('full-width');
                    });


                    // Feedback & Complaint Management functionality
                    document.addEventListener('DOMContentLoaded', function () {
                        // Only initialize if section exists
                        if (document.getElementById('feedback-complaints-section')) {
                            // Toggle feedback form
                            document.getElementById('addFeedbackBtn').addEventListener('click', function () {
                                document.getElementById('addFeedbackForm').style.display = 'block';
                            });

                            document.getElementById('closeFeedbackForm').addEventListener('click', function () {
                                document.getElementById('addFeedbackForm').style.display = 'none';
                            });

                            document.getElementById('cancelFeedbackForm').addEventListener('click', function () {
                                document.getElementById('addFeedbackForm').style.display = 'none';
                            });

                            // Form submission
                            document.getElementById('feedbackForm').addEventListener('submit', function (e) {
                                e.preventDefault();
                                // Here you would typically save the feedback to your database
                                alert('Feedback saved successfully!');
                                document.getElementById('feedbackForm').reset();
                                document.getElementById('addFeedbackForm').style.display = 'none';
                                // Refresh the feedback table
                            });

                            // Initialize charts
                            initializeFeedbackCharts();
                        }
                    });

                    function initializeFeedbackCharts() {
                        // CSAT Chart
                        const csatCtx = document.getElementById('csatChart').getContext('2d');
                        new Chart(csatCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [80, 82, 81, 83, 82, 84],
                                    borderColor: '#2a9d8f',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // NPS Chart
                        const npsCtx = document.getElementById('npsChart').getContext('2d');
                        new Chart(npsCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [55, 57, 56, 58, 60, 62],
                                    backgroundColor: '#0077b6',
                                    borderWidth: 0
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Complaints Chart
                        const complaintsCtx = document.getElementById('complaintsChart').getContext('2d');
                        new Chart(complaintsCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [18, 17, 16, 15, 14, 14],
                                    borderColor: '#e76f51',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Resolution Chart
                        const resolutionCtx = document.getElementById('resolutionChart').getContext('2d');
                        new Chart(resolutionCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [2.8, 2.6, 2.5, 2.3, 2.2, 2.1],
                                    borderColor: '#e9c46a',
                                    borderWidth: 2,
                                    fill: false,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        display: false
                                    },
                                    x: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Sentiment Chart
                        const sentimentCtx = document.getElementById('sentimentChart').getContext('2d');
                        new Chart(sentimentCtx, {
                            type: 'doughnut',
                            data: {
                                labels: ['Positive', 'Neutral', 'Negative'],
                                datasets: [{
                                    data: [65, 20, 15],
                                    backgroundColor: ['#2a9d8f', '#e9c46a', '#e76f51'],
                                    borderWidth: 0
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Feedback Sentiment',
                                        position: 'bottom'
                                    }
                                }
                            }
                        });

                        // Category Chart
                        const categoryCtx = document.getElementById('categoryChart').getContext('2d');
                        new Chart(categoryCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Product', 'Service', 'Delivery', 'Packaging', 'Other'],
                                datasets: [{
                                    data: [45, 30, 15, 5, 5],
                                    backgroundColor: ['#0077b6', '#00b4d8', '#90e0ef', '#48cae4', '#023e8a']
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Feedback by Category',
                                        position: 'bottom'
                                    },
                                    legend: {
                                        display: false
                                    }
                                }
                            }
                        });
                    }







                </script>
                <script>
                    function toggleSidebar() {
                        const sidebar = document.getElementById("sidebar");
                        sidebar.classList.toggle("show");
                    }

                    document.getElementById("menuToggle").addEventListener("click", toggleSidebar);
                </script>
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        // Sentiment Donut Chart
                        new Chart(document.getElementById("sentimentPieChart"), {
                            type: 'doughnut',
                            data: {
                                labels: ["Positive", "Negative", "Neutral"],
                                datasets: [{
                                    label: "Sentiment Distribution",
                                    data: [45, 30, 25],
                                    backgroundColor: ["#00bbf9", "#f71735", "#ff9f1c"]
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        position: 'bottom'
                                    },
                                    title: {
                                        display: true,
                                        text: 'Sentiment Distribution'
                                    }
                                },
                                cutout: '50%'
                            }
                        });

                        // Sentiment Line Chart
                        new Chart(document.getElementById("sentimentLineChart"), {
                            type: 'line',
                            data: {
                                labels: ["Week 1", "Week 2", "Week 3", "Week 4"],
                                datasets: [{
                                    label: "Positive",
                                    data: [10, 12, 14, 13],
                                    borderColor: "#00bbf9",
                                    fill: false
                                }, {
                                    label: "Negative",
                                    data: [4, 5, 6, 7],
                                    borderColor: "#f71735",
                                    fill: false
                                }, {
                                    label: "Neutral",
                                    data: [6, 7, 5, 4],
                                    borderColor: "#ff9f1c",
                                    fill: false
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        position: 'bottom'
                                    },
                                    title: {
                                        display: true,
                                        text: 'Sentiment Trends Over Time'
                                    }
                                }
                            }
                        });

                        // Sentiment Radar Chart
                        new Chart(document.getElementById("sentimentRadarChart"), {
                            type: 'radar',
                            data: {
                                labels: ["Service", "Product", "Delivery", "Support"],
                                datasets: [{
                                    label: "Positive Feedback",
                                    data: [20, 15, 10, 12],
                                    backgroundColor: "rgba(0, 187, 249, 0.2)",
                                    borderColor: "#00bbf9",
                                    pointBackgroundColor: "#00bbf9"
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        position: 'bottom'
                                    },
                                    title: {
                                        display: true,
                                        text: 'Feedback by Category'
                                    }
                                }
                            }
                        });
                    });


                    document.addEventListener('DOMContentLoaded', function () {
                        // User Management functionality
                        document.getElementById('addUserBtn').addEventListener('click', function () {
                            document.getElementById('addUserForm').style.display = 'block';
                        });

                        document.getElementById('closeUserForm').addEventListener('click', function () {
                            document.getElementById('addUserForm').style.display = 'none';
                        });

                        document.getElementById('cancelUserForm').addEventListener('click', function () {
                            document.getElementById('addUserForm').style.display = 'none';
                        });

                        document.getElementById('userForm').addEventListener('submit', function (e) {
                            e.preventDefault();
                            alert('User added successfully!');
                            document.getElementById('userForm').reset();
                            document.getElementById('addUserForm').style.display = 'none';
                        });

                        // Role permissions change
                        document.getElementById('roleSelect').addEventListener('change', function () {
                            // Here you would typically load permissions for the selected role
                            console.log('Loading permissions for role: ' + this.value);
                        });
                    });


                    // Add this to your existing JavaScript
                    document.addEventListener('DOMContentLoaded', function () {
                        // Initialize charts for Access Control section
                        if (document.getElementById('access-control-section')) {
                            // Total Users Chart
                            new Chart(document.getElementById('totalUsersChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [100, 105, 110, 115, 120, 124],
                                        borderColor: '#0077b6',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Security Events Chart
                            new Chart(document.getElementById('securityEventsChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [20, 18, 16, 15, 16, 14],
                                        borderColor: '#e76f51',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Failed Logins Chart
                            new Chart(document.getElementById('failedLoginsChart').getContext('2d'), {
                                type: 'bar',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [12, 10, 9, 8, 9, 8],
                                        backgroundColor: '#e9c46a'
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Audit Status Chart
                            new Chart(document.getElementById('auditStatusChart').getContext('2d'), {
                                type: 'doughnut',
                                data: {
                                    labels: ['Passed', 'Failed', 'Warning'],
                                    datasets: [{
                                        data: [85, 10, 5],
                                        backgroundColor: ['#2a9d8f', '#e76f51', '#e9c46a']
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    cutout: '70%'
                                }
                            });

                            // Role Distribution Chart
                            new Chart(document.getElementById('roleDistributionChart').getContext('2d'), {
                                type: 'pie',
                                data: {
                                    labels: ['Admin', 'Manager', 'Sales', 'Support', 'Delivery'],
                                    datasets: [{
                                        data: [8, 12, 45, 22, 37],
                                        backgroundColor: [
                                            '#0077b6',
                                            '#00b4d8',
                                            '#2a9d8f',
                                            '#e9c46a',
                                            '#e76f51'
                                        ]
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        legend: {
                                            position: 'right'
                                        },
                                        title: {
                                            display: true,
                                            text: 'User Role Distribution',
                                            font: { size: 16 }
                                        }
                                    }
                                }
                            });

                            // Export Activity button
                            document.getElementById('exportActivityBtn').addEventListener('click', function () {
                                // In a real app, this would generate a CSV or PDF
                                alert('Exporting activity data...');
                            });

                            // Edit Permissions button
                            document.getElementById('editPermissionsBtn').addEventListener('click', function () {
                                showSection('role-permissions-section');
                            });

                            // Activity filter
                            document.getElementById('activityFilter').addEventListener('change', function () {
                                // In a real app, this would filter the timeline
                                console.log('Filtering by:', this.value);
                            });
                        }
                    });

                </script>
                <script>
                    document.querySelectorAll('.sidebar .nav-link').forEach(link => {
                        link.addEventListener('click', function (e) {
                            e.preventDefault(); // prevent page jump

                            // Remove 'active' from all links
                            document.querySelectorAll('.sidebar .nav-link').forEach(l => l.classList.remove('active'));

                            // Add 'active' to the clicked one
                            this.classList.add('active');

                            // Show the corresponding section
                            const sectionId = this.getAttribute('data-section');
                            if (sectionId) {
                                document.querySelectorAll('.child-section').forEach(sec => sec.classList.remove('active'));
                                const target = document.getElementById(sectionId);
                                if (target) target.classList.add('active');
                            }
                        });
                    });
                </script>
                <script>
                    document.getElementById("fullName").addEventListener("input", function (e) {
                        this.value = this.value.replace(/[^A-Za-z. ]/g, '');
                    });

                    document.getElementById("phone").addEventListener("input", function (e) {
                        let cleaned = this.value.replace(/[^0-9]/g, '');
                        this.value = '+91' + cleaned.slice(0, 10);
                    });

                    document.getElementById("email").addEventListener("input", function (e) {
                        let base = this.value.split('@')[0].replace(/[^a-zA-Z0-9+]/g, '');
                        this.value = base + "@gmail.com";
                    });
                </script>
                <script>
                    const activeFarmersCtx = document.getElementById('activeFarmersChart').getContext('2d');
                    new Chart(activeFarmersCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            datasets: [{
                                label: 'Active Farmers',
                                data: [4100, 4300, 4500, 4700, 4892, 4920],
                                borderColor: '#0077b6',
                                backgroundColor: 'rgba(0, 119, 182, 0.2)',
                                fill: true,
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Monthly Active Farmers'
                                }
                            }
                        }
                    });
                </script>
                <script>
                    const avgMilkCtx = document.getElementById('avgMilkChart').getContext('2d');
                    new Chart(avgMilkCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            datasets: [{
                                label: 'Avg. Milk Production (L)',
                                data: [38.2, 39.8, 40.5, 41.7, 42.0, 42.5],
                                borderColor: '#00b4d8',
                                backgroundColor: 'rgba(0, 180, 216, 0.2)',
                                fill: true,
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Avg. Milk Production Trend'
                                }
                            }
                        }
                    });



                </script>

                <script>
                    // Chart for Today's Collection
                    new Chart(document.getElementById('todayCollectionChart').getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                            datasets: [{
                                label: 'Collection (L)',
                                data: [11400, 11900, 12200, 12450, 12300, 12600],
                                borderColor: 'rgba(75, 192, 192, 1)',
                                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                fill: true,
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: { legend: { display: false } },
                            scales: { y: { beginAtZero: true } }
                        }
                    });

                    // Chart for Avg. Fat %
                    new Chart(document.getElementById('fatContentChart').getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                            datasets: [{
                                label: 'Avg. Fat %',
                                data: [4.0, 4.2, 4.3, 4.1, 4.0, 4.1],
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                fill: true,
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: { legend: { display: false } },
                            scales: { y: { beginAtZero: true } }
                        }
                    });

                    // Chart for Avg. SNF %
                    new Chart(document.getElementById('snfContentChart').getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                            datasets: [{
                                label: 'Avg. SNF %',
                                data: [8.3, 8.4, 8.5, 8.5, 8.6, 8.5],
                                borderColor: 'rgba(153, 102, 255, 1)',
                                backgroundColor: 'rgba(153, 102, 255, 0.2)',
                                fill: true,
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: { legend: { display: false } },
                            scales: { y: { beginAtZero: true } }
                        }
                    });
                </script>
                <script>
                    // Production Reports Section JavaScript
                    document.addEventListener('DOMContentLoaded', function () {
                        // Initialize production reports section if it exists
                        if (document.getElementById('production-reports-section')) {
                            initializeProductionReports();
                        }
                    });

                    function initializeProductionReports() {
                        // Load initial data
                        loadProductionReports();

                        // Set up event listeners
                        document.getElementById('addProductionReportBtn').addEventListener('click', showAddReportForm);
                        document.getElementById('closeReportForm').addEventListener('click', hideAddReportForm);
                        document.getElementById('cancelReportForm').addEventListener('click', hideAddReportForm);
                        document.getElementById('reportForm').addEventListener('submit', saveProductionReport);

                        document.getElementById('productionSearch').addEventListener('input', filterProductionReports);
                        document.getElementById('productionFilter').addEventListener('change', filterProductionReports);
                        document.getElementById('productionPrevPage').addEventListener('click', goToPrevProductionPage);
                        document.getElementById('productionNextPage').addEventListener('click', goToNextProductionPage);

                        document.getElementById('productionTrendTimeRange').addEventListener('change', updateProductionTrends);

                        // Initialize charts
                        initializeProductionCharts();
                    }

                    // Production Report Data Management
                    function loadProductionReports() {
                        let reports = JSON.parse(localStorage.getItem('productionReports')) || [];

                        // If no reports exist, create some sample data
                        if (reports.length === 0) {
                            const today = new Date();
                            const lastWeek = new Date(today);
                            lastWeek.setDate(today.getDate() - 7);

                            reports = [
                                {
                                    id: 'PR-' + today.getTime().toString().slice(-6),
                                    date: today.toISOString(),
                                    type: 'daily',
                                    plant: 'ahmedabad',
                                    product: 'standard_milk',
                                    quantity: 52000,
                                    efficiency: 88,
                                    waste: 2.8,
                                    notes: 'Normal production day, all systems optimal',
                                    status: 'completed'
                                },
                                {
                                    id: 'PR-' + (today.getTime() - 86400000).toString().slice(-6),
                                    date: new Date(today.getTime() - 86400000).toISOString(),
                                    type: 'daily',
                                    plant: 'gandhinagar',
                                    product: 'toned_milk',
                                    quantity: 48500,
                                    efficiency: 85,
                                    waste: 3.1,
                                    notes: 'Minor maintenance required on line 2',
                                    status: 'completed'
                                },
                                {
                                    id: 'PR-' + (today.getTime() - 172800000).toString().slice(-6),
                                    date: new Date(today.getTime() - 172800000).toISOString(),
                                    type: 'daily',
                                    plant: 'vadodara',
                                    product: 'flavored_milk',
                                    quantity: 45200,
                                    efficiency: 82,
                                    waste: 3.5,
                                    notes: 'Equipment issue reduced output by 8%',
                                    status: 'pending'
                                },
                                {
                                    id: 'PR-' + (today.getTime() - 259200000).toString().slice(-6),
                                    date: new Date(today.getTime() - 259200000).toISOString(),
                                    type: 'weekly',
                                    plant: 'surat',
                                    product: 'yogurt',
                                    quantity: 299600,
                                    efficiency: 80,
                                    waste: 4.2,
                                    notes: 'Weekly summary - needs process improvement',
                                    status: 'pending'
                                },
                                {
                                    id: 'PR-' + (today.getTime() - 345600000).toString().slice(-6),
                                    date: new Date(today.getTime() - 345600000).toString(),
                                    type: 'monthly',
                                    plant: 'rajkot',
                                    product: 'paneer',
                                    quantity: 1155000,
                                    efficiency: 78,
                                    waste: 4.5,
                                    notes: 'Monthly report - significant waste reduction needed',
                                    status: 'pending'
                                }
                            ];
                            localStorage.setItem('productionReports', JSON.stringify(reports));
                        }

                        // Sort by date (newest first)
                        reports.sort((a, b) => new Date(b.date) - new Date(a.date));

                        // Store in memory for filtering/pagination
                        window.currentProductionReports = reports;
                        window.filteredProductionReports = [...reports];
                        window.currentProductionPage = 1;
                        window.productionReportsPerPage = 5;

                        renderProductionReports();
                        updateProductionPagination();
                    }

                    function renderProductionReports() {
                        const tableBody = document.getElementById('productionReportsTableBody');
                        tableBody.innerHTML = '';

                        const startIndex = (window.currentProductionPage - 1) * window.productionReportsPerPage;
                        const endIndex = Math.min(startIndex + window.productionReportsPerPage, window.filteredProductionReports.length);

                        const productNames = {
                            'standard_milk': 'Standard Milk',
                            'toned_milk': 'Toned Milk',
                            'flavored_milk': 'Flavored Milk',
                            'yogurt': 'Yogurt',
                            'paneer': 'Paneer',
                            'ghee': 'Ghee'
                        };

                        const plantNames = {
                            'ahmedabad': 'Ahmedabad',
                            'gandhinagar': 'Gandhinagar',
                            'vadodara': 'Vadodara',
                            'surat': 'Surat',
                            'rajkot': 'Rajkot'
                        };

                        for (let i = startIndex; i < endIndex; i++) {
                            const report = window.filteredProductionReports[i];
                            const row = document.createElement('tr');

                            const reportDate = new Date(report.date);
                            const formattedDate = reportDate.toLocaleDateString();

                            row.innerHTML = `
                <td>${report.id}</td>
                <td>${formattedDate}</td>
                <td>${report.type.charAt(0).toUpperCase() + report.type.slice(1)}</td>
                <td>${productNames[report.product] || report.product}</td>
                <td>${report.quantity.toLocaleString()} L</td>
                <td>${report.efficiency}%</td>
                <td><span class="status ${report.status === 'completed' ? 'completed' : 'pending'}">
                    ${report.status.charAt(0).toUpperCase() + report.status.slice(1)}
                </span></td>
                <td>
                    <button class="btn-primary" onclick="viewProductionReport('${report.id}')">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn-success" onclick="editProductionReport('${report.id}')">
                        <i class="fas fa-edit"></i>
                    </button>
                </td>
            `;
                            tableBody.appendChild(row);
                        }

                        // Update pagination info
                        document.getElementById('productionShowingFrom').textContent = startIndex + 1;
                        document.getElementById('productionShowingTo').textContent = endIndex;
                        document.getElementById('productionTotalReports').textContent = window.filteredProductionReports.length;

                        // Disable/enable pagination buttons
                        document.getElementById('productionPrevPage').disabled = window.currentProductionPage === 1;
                        document.getElementById('productionNextPage').disabled =
                            endIndex >= window.filteredProductionReports.length;
                    }

                    function filterProductionReports() {
                        const searchTerm = document.getElementById('productionSearch').value.toLowerCase();
                        const filterType = document.getElementById('productionFilter').value;

                        window.filteredProductionReports = window.currentProductionReports.filter(report => {
                            const matchesSearch = report.id.toLowerCase().includes(searchTerm) ||
                                report.notes.toLowerCase().includes(searchTerm);

                            const matchesFilter = filterType === 'all' || report.type === filterType;

                            return matchesSearch && matchesFilter;
                        });

                        window.currentProductionPage = 1;
                        renderProductionReports();
                        updateProductionPagination();
                    }

                    function updateProductionPagination() {
                        // This is handled in renderProductionReports
                    }

                    function goToPrevProductionPage() {
                        if (window.currentProductionPage > 1) {
                            window.currentProductionPage--;
                            renderProductionReports();
                        }
                    }

                    function goToNextProductionPage() {
                        const totalPages = Math.ceil(window.filteredProductionReports.length / window.productionReportsPerPage);
                        if (window.currentProductionPage < totalPages) {
                            window.currentProductionPage++;
                            renderProductionReports();
                        }
                    }

                    function showAddReportForm() {
                        document.getElementById('addReportForm').style.display = 'block';
                        document.getElementById('reportDate').valueAsDate = new Date();
                    }

                    function hideAddReportForm() {
                        document.getElementById('addReportForm').style.display = 'none';
                        document.getElementById('reportForm').reset();
                    }

                    function saveProductionReport(e) {
                        e.preventDefault();

                        const newReport = {
                            id: 'PR-' + Date.now().toString().slice(-6),
                            date: document.getElementById('reportDate').value,
                            type: document.getElementById('reportType').value,
                            plant: document.getElementById('reportPlant').value,
                            product: document.getElementById('reportProduct').value,
                            quantity: parseFloat(document.getElementById('reportQuantity').value),
                            efficiency: parseFloat(document.getElementById('reportEfficiency').value),
                            waste: parseFloat(document.getElementById('reportWaste').value),
                            notes: document.getElementById('reportNotes').value,
                            status: 'completed'
                        };

                        // Add to local storage
                        const reports = JSON.parse(localStorage.getItem('productionReports')) || [];
                        reports.unshift(newReport);
                        localStorage.setItem('productionReports', JSON.stringify(reports));

                        // Update UI
                        window.currentProductionReports = reports;
                        window.filteredProductionReports = [...reports];
                        window.currentProductionPage = 1;

                        renderProductionReports();
                        hideAddReportForm();
                        initializeProductionCharts(); // Refresh charts with new data

                        alert('Production report saved successfully!');
                    }

                    function viewProductionReport(reportId) {
                        const report = window.currentProductionReports.find(r => r.id === reportId);
                        if (report) {
                            alert(`Viewing Report ${reportId}\n\n` +
                                `Date: ${new Date(report.date).toLocaleDateString()}\n` +
                                `Type: ${report.type.charAt(0).toUpperCase() + report.type.slice(1)}\n` +
                                `Plant: ${report.plant.charAt(0).toUpperCase() + report.plant.slice(1)}\n` +
                                `Product: ${report.product.replace('_', ' ').split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')}\n` +
                                `Quantity: ${report.quantity.toLocaleString()} L\n` +
                                `Efficiency: ${report.efficiency}%\n` +
                                `Waste: ${report.waste}%\n\n` +
                                `Notes: ${report.notes}`);
                        }
                    }

                    function editProductionReport(reportId) {
                        const report = window.currentProductionReports.find(r => r.id === reportId);
                        if (report) {
                            // For simplicity, we'll just populate the form and change the save behavior
                            document.getElementById('reportDate').value = report.date.split('T')[0];
                            document.getElementById('reportType').value = report.type;
                            document.getElementById('reportPlant').value = report.plant;
                            document.getElementById('reportProduct').value = report.product;
                            document.getElementById('reportQuantity').value = report.quantity;
                            document.getElementById('reportEfficiency').value = report.efficiency;
                            document.getElementById('reportWaste').value = report.waste;
                            document.getElementById('reportNotes').value = report.notes;

                            // Change the form submit to handle update instead of create
                            const form = document.getElementById('reportForm');
                            form.onsubmit = function (e) {
                                e.preventDefault();

                                // Update the report
                                report.date = document.getElementById('reportDate').value;
                                report.type = document.getElementById('reportType').value;
                                report.plant = document.getElementById('reportPlant').value;
                                report.product = document.getElementById('reportProduct').value;
                                report.quantity = parseFloat(document.getElementById('reportQuantity').value);
                                report.efficiency = parseFloat(document.getElementById('reportEfficiency').value);
                                report.waste = parseFloat(document.getElementById('reportWaste').value);
                                report.notes = document.getElementById('reportNotes').value;

                                // Save to local storage
                                localStorage.setItem('productionReports', JSON.stringify(window.currentProductionReports));

                                // Update UI
                                renderProductionReports();
                                hideAddReportForm();
                                initializeProductionCharts(); // Refresh charts with updated data

                                alert('Production report updated successfully!');

                                // Reset form handler to create new reports
                                form.onsubmit = saveProductionReport;
                            };

                            showAddReportForm();
                        }
                    }

                    function updateProductionTrends() {
                        const timeRange = document.getElementById('productionTrendTimeRange').value;
                        initializeProductionCharts(timeRange);
                    }

                    function initializeProductionCharts(timeRange = '7d') {
                        // Get data based on time range
                        const reports = JSON.parse(localStorage.getItem('productionReports')) || [];

                        // Filter reports based on time range
                        const now = new Date();
                        let cutoffDate;

                        switch (timeRange) {
                            case '7d':
                                cutoffDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                                break;
                            case '30d':
                                cutoffDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                                break;
                            case '90d':
                                cutoffDate = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);
                                break;
                            default:
                                cutoffDate = new Date(0); // All time
                        }

                        const filteredReports = reports.filter(r => new Date(r.date) >= cutoffDate);

                        // Group by date for line chart
                        const dailyData = {};
                        filteredReports.forEach(report => {
                            if (report.type === 'daily') {
                                const date = new Date(report.date).toLocaleDateString();
                                if (!dailyData[date]) {
                                    dailyData[date] = {
                                        quantity: 0,
                                        count: 0
                                    };
                                }
                                dailyData[date].quantity += report.quantity;
                                dailyData[date].count++;
                            }
                        });

                        const dates = Object.keys(dailyData).sort();
                        const quantities = dates.map(date => dailyData[date].quantity / dailyData[date].count);

                        // Create production volume chart
                        const volumeCtx = document.getElementById('productionVolumeChart').getContext('2d');
                        if (window.productionVolumeChart) {
                            window.productionVolumeChart.destroy();
                        }

                        window.productionVolumeChart = new Chart(volumeCtx, {
                            type: 'line',
                            data: {
                                labels: dates,
                                datasets: [{
                                    label: 'Daily Production (Liters)',
                                    data: quantities,
                                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                    borderColor: 'rgba(54, 162, 235, 1)',
                                    borderWidth: 2,
                                    tension: 0.1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Daily Production Volume'
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: false
                                    }
                                }
                            }
                        });

                        // Group by product for pie chart
                        const productData = {};
                        filteredReports.forEach(report => {
                            if (!productData[report.product]) {
                                productData[report.product] = 0;
                            }
                            productData[report.product] += report.quantity;
                        });

                        const productNames = {
                            'standard_milk': 'Standard Milk',
                            'toned_milk': 'Toned Milk',
                            'flavored_milk': 'Flavored Milk',
                            'yogurt': 'Yogurt',
                            'paneer': 'Paneer',
                            'ghee': 'Ghee'
                        };

                        const productLabels = Object.keys(productData).map(key => productNames[key] || key);
                        const productQuantities = Object.values(productData);

                        // Create product mix chart
                        const mixCtx = document.getElementById('productMixChart').getContext('2d');
                        if (window.productMixChart) {
                            window.productMixChart.destroy();
                        }

                        window.productMixChart = new Chart(mixCtx, {
                            type: 'doughnut',
                            data: {
                                labels: productLabels,
                                datasets: [{
                                    data: productQuantities,
                                    backgroundColor: [
                                        'rgba(255, 99, 132, 0.7)',
                                        'rgba(54, 162, 235, 0.7)',
                                        'rgba(255, 206, 86, 0.7)',
                                        'rgba(75, 192, 192, 0.7)',
                                        'rgba(153, 102, 255, 0.7)',
                                        'rgba(255, 159, 64, 0.7)'
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Product Mix Distribution'
                                    },
                                    legend: {
                                        position: 'right'
                                    }
                                }
                            }
                        });

                        // Mini charts for stats cards
                        initializeMiniCharts();
                    }

                    function initializeMiniCharts() {
                        // Daily Production Chart
                        const dailyCtx = document.getElementById('dailyProductionChart').getContext('2d');
                        new Chart(dailyCtx, {
                            type: 'line',
                            data: {
                                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                                datasets: [{
                                    data: [120000, 125000, 123000, 127000, 130000, 115000, 110000],
                                    borderColor: 'rgba(75, 192, 192, 1)',
                                    borderWidth: 2,
                                    tension: 0.1,
                                    fill: false
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    x: {
                                        display: false
                                    },
                                    y: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Monthly Production Chart
                        const monthlyCtx = document.getElementById('monthlyProductionChart').getContext('2d');
                        new Chart(monthlyCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    data: [2800000, 2900000, 3100000, 3000000, 3200000, 3150000],
                                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                                    borderColor: 'rgba(54, 162, 235, 1)',
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    x: {
                                        display: false
                                    },
                                    y: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Efficiency Chart
                        const efficiencyCtx = document.getElementById('efficiencyChart').getContext('2d');
                        new Chart(efficiencyCtx, {
                            type: 'line',
                            data: {
                                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                                datasets: [{
                                    data: [84, 85, 86, 85, 87, 83, 82],
                                    borderColor: 'rgba(255, 159, 64, 1)',
                                    borderWidth: 2,
                                    tension: 0.1,
                                    fill: false
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    x: {
                                        display: false
                                    },
                                    y: {
                                        display: false
                                    }
                                }
                            }
                        });

                        // Waste Percentage Chart
                        const wasteCtx = document.getElementById('wastePercentageChart').getContext('2d');
                        new Chart(wasteCtx, {
                            type: 'line',
                            data: {
                                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                                datasets: [{
                                    data: [3.5, 3.2, 3.0, 3.1, 2.9, 3.4, 3.6],
                                    borderColor: 'rgba(255, 99, 132, 1)',
                                    borderWidth: 2,
                                    tension: 0.1,
                                    fill: false
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    x: {
                                        display: false
                                    },
                                    y: {
                                        display: false
                                    }
                                }
                            }
                        });
                    }
                </script>
                <script>
                    // Initialize charts for Chilling Centers section
                    document.addEventListener('DOMContentLoaded', function () {
                        if (document.getElementById('chilling-centers-section')) {
                            // Total Centers Chart
                            new Chart(document.getElementById('totalCentersChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [8, 9, 10, 11, 11, 12],
                                        borderColor: '#0077b6',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Total Capacity Chart
                            new Chart(document.getElementById('totalCapacityChart').getContext('2d'), {
                                type: 'bar',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [100000, 110000, 120000, 130000, 140000, 150000],
                                        backgroundColor: '#00b4d8',
                                        borderWidth: 0
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Current Storage Chart
                            new Chart(document.getElementById('currentStorageChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [75000, 80000, 85000, 90000, 100000, 112500],
                                        borderColor: '#2a9d8f',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Avg Temp Chart
                            new Chart(document.getElementById('avgTempChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [4.5, 4.4, 4.3, 4.3, 4.2, 4.2],
                                        borderColor: '#e76f51',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Temperature Monitoring Chart
                            new Chart(document.getElementById('tempMonitoringChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'],
                                    datasets: [{
                                        label: 'Temperature (°C)',
                                        data: [4.2, 4.1, 4.3, 4.5, 4.4, 4.2, 4.1],
                                        borderColor: '#0077b6',
                                        backgroundColor: 'rgba(0, 119, 182, 0.1)',
                                        fill: true,
                                        tension: 0.3
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Temperature Trend (Last 24 Hours)'
                                        },
                                        tooltip: {
                                            callbacks: {
                                                label: function (context) {
                                                    return context.dataset.label + ': ' + context.parsed.y + '°C';
                                                }
                                            }
                                        }
                                    },
                                    scales: {
                                        y: {
                                            min: 3,
                                            max: 5,
                                            title: {
                                                display: true,
                                                text: 'Temperature (°C)'
                                            }
                                        }
                                    }
                                }
                            });

                            // Inventory Movement Chart
                            new Chart(document.getElementById('inventoryMovementChart').getContext('2d'), {
                                type: 'bar',
                                data: {
                                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                                    datasets: [
                                        {
                                            label: 'Milk In (L)',
                                            data: [12000, 11500, 12500, 13000, 11800, 11000],
                                            backgroundColor: '#2a9d8f'
                                        },
                                        {
                                            label: 'Milk Out (L)',
                                            data: [10000, 9500, 10500, 11000, 9800, 9000],
                                            backgroundColor: '#e76f51'
                                        }
                                    ]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Weekly Inventory Movement'
                                        },
                                        tooltip: {
                                            callbacks: {
                                                label: function (context) {
                                                    return context.dataset.label + ': ' + context.parsed.y + 'L';
                                                }
                                            }
                                        }
                                    },
                                    scales: {
                                        y: {
                                            beginAtZero: true,
                                            title: {
                                                display: true,
                                                text: 'Liters'
                                            }
                                        }
                                    }
                                }
                            });

                            // Add Center button functionality
                            document.getElementById('addCenterBtn').addEventListener('click', function () {
                                document.getElementById('addCenterForm').style.display = 'block';
                            });

                            document.getElementById('closeCenterForm').addEventListener('click', function () {
                                document.getElementById('addCenterForm').style.display = 'none';
                            });

                            document.getElementById('cancelCenterForm').addEventListener('click', function () {
                                document.getElementById('addCenterForm').style.display = 'none';
                            });

                            document.getElementById('centerForm').addEventListener('submit', function (e) {
                                e.preventDefault();
                                alert('Chilling center added successfully!');
                                document.getElementById('centerForm').reset();
                                document.getElementById('addCenterForm').style.display = 'none';
                            });

                            // Time range selector for temperature chart
                            document.getElementById('tempTimeRange').addEventListener('change', function () {
                                // In a real app, this would reload the chart data
                                console.log('Loading temperature data for: ' + this.value);
                            });

                            // Export inventory data
                            document.getElementById('exportInventoryBtn').addEventListener('click', function () {
                                alert('Exporting inventory data...');
                            });

                            // Add maintenance log
                            document.getElementById('addMaintenanceBtn').addEventListener('click', function () {
                                // In a real app, this would open a form
                                alert('Add maintenance log form would open here');
                            });
                        }
                    });

                    // Initialize Processing Plants Charts
                    document.addEventListener('DOMContentLoaded', function () {
                        if (document.getElementById('processing-plants-section')) {
                            // Total Plants Chart
                            new Chart(document.getElementById('totalPlantsChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [6, 6, 7, 7, 7, 8],
                                        borderColor: '#0077b6',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Daily Capacity Chart
                            new Chart(document.getElementById('dailyCapacityChart').getContext('2d'), {
                                type: 'bar',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [200000, 210000, 220000, 230000, 240000, 250000],
                                        backgroundColor: '#00b4d8'
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Utilization Chart
                            new Chart(document.getElementById('utilizationChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [83, 82, 80, 79, 78, 78],
                                        borderColor: '#e76f51',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Efficiency Chart
                            new Chart(document.getElementById('efficiencyChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [80, 80, 81, 81, 82, 82],
                                        borderColor: '#2a9d8f',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Production Trend Chart
                            new Chart(document.getElementById('productionTrendChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                                    datasets: [{
                                        label: 'Milk Production (L)',
                                        data: [180000, 185000, 190000, 195000],
                                        borderColor: '#0077b6',
                                        backgroundColor: 'rgba(0, 119, 182, 0.1)',
                                        fill: true,
                                        tension: 0.3
                                    }, {
                                        label: 'Cheese Production (kg)',
                                        data: [12000, 12500, 13000, 13500],
                                        borderColor: '#2a9d8f',
                                        backgroundColor: 'rgba(42, 157, 143, 0.1)',
                                        fill: true,
                                        tension: 0.3
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Weekly Production Trends'
                                        }
                                    }
                                }
                            });

                            // Critical Alerts Chart
                            new Chart(document.getElementById('criticalAlertsChart').getContext('2d'), {
                                type: 'bar',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [5, 4, 4, 3, 3, 3],
                                        backgroundColor: '#e76f51'
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Preventive Maintenance Chart
                            new Chart(document.getElementById('preventiveMaintenanceChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [10, 11, 11, 12, 12, 12],
                                        borderColor: '#e9c46a',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Energy Usage Chart
                            new Chart(document.getElementById('energyUsageChart').getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        data: [1200, 1210, 1220, 1230, 1240, 1250],
                                        borderColor: '#00b4d8',
                                        borderWidth: 2,
                                        fill: false,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: { y: { display: false }, x: { display: false } }
                                }
                            });

                            // Add Plant Form Toggle
                            document.getElementById('addPlantBtn').addEventListener('click', function () {
                                document.getElementById('addPlantForm').style.display = 'block';
                            });

                            document.getElementById('closePlantForm').addEventListener('click', function () {
                                document.getElementById('addPlantForm').style.display = 'none';
                            });

                            document.getElementById('cancelPlantForm').addEventListener('click', function () {
                                document.getElementById('addPlantForm').style.display = 'none';
                            });

                            // Form submission
                            document.getElementById('plantForm').addEventListener('submit', function (e) {
                                e.preventDefault();
                                alert('Plant added successfully!');
                                document.getElementById('plantForm').reset();
                                document.getElementById('addPlantForm').style.display = 'none';
                            });

                            // Add Production Line Button
                            document.getElementById('addProductionLineBtn').addEventListener('click', function () {
                                alert('Add production line functionality would go here');
                            });

                            // Add Maintenance Log Button
                            document.getElementById('addMaintenanceLogBtn').addEventListener('click', function () {
                                alert('Add maintenance log functionality would go here');
                            });

                            // Export Equipment Data Button
                            document.getElementById('exportEquipmentDataBtn').addEventListener('click', function () {
                                alert('Exporting equipment data...');
                            });
                        }
                    });
                </script>

                <script>
                    // Delivery Routes Data Management
                    document.addEventListener('DOMContentLoaded', function () {
                        // Initialize delivery routes if not exists in localStorage
                        if (!localStorage.getItem('deliveryRoutes')) {
                            const sampleRoutes = [
                                {
                                    id: 'RT-1001',
                                    name: 'Ahmedabad Central',
                                    driver: 'Rajesh Patel',
                                    driverId: 'DR-1001',
                                    vehicle: 'Truck AH-01-AB-1234',
                                    vehicleId: 'VH-1001',
                                    date: '2023-06-15',
                                    startTime: '08:00',
                                    stops: [
                                        { address: '123 Market St, Ahmedabad', customer: 'Rajesh Stores', orders: 15 },
                                        { address: '456 Dairy Lane, Ahmedabad', customer: 'Milk Corner', orders: 8 },
                                        { address: '789 Farm Rd, Ahmedabad', customer: 'Fresh Dairy', orders: 12 }
                                    ],
                                    distance: '45 km',
                                    estimatedTime: '3.5 hours',
                                    status: 'completed',
                                    notes: 'Completed all deliveries on time'
                                },
                                {
                                    id: 'RT-1002',
                                    name: 'Gandhinagar North',
                                    driver: 'Priya Sharma',
                                    driverId: 'DR-1002',
                                    vehicle: 'Van GJ-01-CD-5678',
                                    vehicleId: 'VH-1002',
                                    date: '2023-06-15',
                                    startTime: '08:30',
                                    stops: [
                                        { address: '101 Retail Park, Gandhinagar', customer: 'Super Mart', orders: 20 },
                                        { address: '202 Grocery St, Gandhinagar', customer: 'Daily Needs', orders: 10 }
                                    ],
                                    distance: '32 km',
                                    estimatedTime: '2.5 hours',
                                    status: 'in-progress',
                                    notes: 'Currently on the second stop'
                                },
                                {
                                    id: 'RT-1003',
                                    name: 'Vadodara West',
                                    driver: 'Vijay Singh',
                                    driverId: 'DR-1003',
                                    vehicle: 'Truck GJ-06-EF-9012',
                                    vehicleId: 'VH-1003',
                                    date: '2023-06-16',
                                    startTime: '09:00',
                                    stops: [
                                        { address: '303 Commercial St, Vadodara', customer: 'City Dairy', orders: 18 },
                                        { address: '404 Business Rd, Vadodara', customer: 'Urban Mart', orders: 12 },
                                        { address: '505 Trade Center, Vadodara', customer: 'Quick Stop', orders: 7 }
                                    ],
                                    distance: '60 km',
                                    estimatedTime: '4.2 hours',
                                    status: 'scheduled',
                                    notes: 'Prepared for tomorrow'
                                }
                            ];
                            localStorage.setItem('deliveryRoutes', JSON.stringify(sampleRoutes));
                        }

                        // Initialize drivers if not exists in localStorage
                        if (!localStorage.getItem('deliveryDrivers')) {
                            const sampleDrivers = [
                                { id: 'DR-1001', name: 'Rajesh Patel', license: 'GJ1234567890', contact: '+919876543210', rating: 4.8 },
                                { id: 'DR-1002', name: 'Priya Sharma', license: 'GJ0987654321', contact: '+919876543211', rating: 4.5 },
                                { id: 'DR-1003', name: 'Vijay Singh', license: 'GJ1122334455', contact: '+919876543212', rating: 4.7 },
                                { id: 'DR-1004', name: 'Meena Desai', license: 'GJ5566778899', contact: '+919876543213', rating: 4.3 },
                                { id: 'DR-1005', name: 'Arun Gupta', license: 'GJ6677889900', contact: '+919876543214', rating: 4.6 }
                            ];
                            localStorage.setItem('deliveryDrivers', JSON.stringify(sampleDrivers));
                        }

                        // Initialize vehicles if not exists in localStorage
                        if (!localStorage.getItem('deliveryVehicles')) {
                            const sampleVehicles = [
                                { id: 'VH-1001', type: 'Truck', regNumber: 'AH-01-AB-1234', capacity: '5000L', status: 'active' },
                                { id: 'VH-1002', type: 'Van', regNumber: 'GJ-01-CD-5678', capacity: '2000L', status: 'active' },
                                { id: 'VH-1003', type: 'Truck', regNumber: 'GJ-06-EF-9012', capacity: '5000L', status: 'active' },
                                { id: 'VH-1004', type: 'Van', regNumber: 'GJ-05-GH-3456', capacity: '2000L', status: 'maintenance' },
                                { id: 'VH-1005', type: 'Truck', regNumber: 'GJ-01-IJ-7890', capacity: '5000L', status: 'active' }
                            ];
                            localStorage.setItem('deliveryVehicles', JSON.stringify(sampleVehicles));
                        }

                        // Load data when section is shown
                        document.addEventListener('sectionShown', function (e) {
                            if (e.detail.sectionId === 'delivery-routes-section') {
                                loadDeliveryRoutes();
                                loadDrivers();
                                loadVehicles();
                                initCharts();
                                initMap();
                            }
                        });

                        // Event listeners for buttons
                        document.getElementById('addRouteBtn').addEventListener('click', showAddRouteForm);
                        document.getElementById('closeRouteForm').addEventListener('click', hideAddRouteForm);
                        document.getElementById('cancelRouteForm').addEventListener('click', hideAddRouteForm);
                        document.getElementById('addStopBtn').addEventListener('click', addStopField);
                        document.getElementById('routeForm').addEventListener('submit', saveRoute);
                        document.getElementById('refreshMapBtn').addEventListener('click', refreshMap);
                        document.getElementById('printMapBtn').addEventListener('click', printMap);
                        document.getElementById('exportMapBtn').addEventListener('click', exportMap);
                        document.getElementById('exportRoutesBtn').addEventListener('click', exportRoutes);
                        document.getElementById('exportDriverPerformanceBtn').addEventListener('click', exportDriverPerformance);
                        document.getElementById('routesPrevPage').addEventListener('click', prevPage);
                        document.getElementById('routesNextPage').addEventListener('click', nextPage);
                        document.getElementById('routeFilter').addEventListener('change', filterRoutes);
                        document.getElementById('routeSearch').addEventListener('input', searchRoutes);
                        document.getElementById('analyticsTimeRange').addEventListener('change', updateAnalytics);

                        // Current page for pagination
                        let currentPage = 1;
                        const routesPerPage = 5;
                    });

                    // Load delivery routes into the table
                    function loadDeliveryRoutes() {
                        const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];
                        const tableBody = document.getElementById('routesTableBody');
                        tableBody.innerHTML = '';

                        // Apply filtering if any
                        const filterValue = document.getElementById('routeFilter').value;
                        const searchValue = document.getElementById('routeSearch').value.toLowerCase();

                        let filteredRoutes = routes.filter(route => {
                            const matchesFilter = filterValue === 'all' ||
                                (filterValue === 'active' && route.status === 'in-progress') ||
                                (filterValue === 'completed' && route.status === 'completed') ||
                                (filterValue === 'scheduled' && route.status === 'scheduled');

                            const matchesSearch = searchValue === '' ||
                                route.name.toLowerCase().includes(searchValue) ||
                                route.driver.toLowerCase().includes(searchValue) ||
                                route.vehicle.toLowerCase().includes(searchValue) ||
                                route.id.toLowerCase().includes(searchValue);

                            return matchesFilter && matchesSearch;
                        });

                        // Update pagination info
                        const totalRoutes = filteredRoutes.length;
                        document.getElementById('routesTotalCount').textContent = totalRoutes;

                        const totalPages = Math.ceil(totalRoutes / routesPerPage);
                        if (currentPage > totalPages && totalPages > 0) {
                            currentPage = totalPages;
                        }

                        const startIndex = (currentPage - 1) * routesPerPage;
                        const endIndex = Math.min(startIndex + routesPerPage, totalRoutes);
                        document.getElementById('routesShowingFrom').textContent = startIndex + 1;
                        document.getElementById('routesShowingTo').textContent = endIndex;

                        // Display the current page of routes
                        const paginatedRoutes = filteredRoutes.slice(startIndex, endIndex);

                        paginatedRoutes.forEach(route => {
                            const row = document.createElement('tr');

                            // Determine status color and text
                            let statusClass, statusText;
                            switch (route.status) {
                                case 'completed':
                                    statusClass = 'completed';
                                    statusText = 'Completed';
                                    break;
                                case 'in-progress':
                                    statusClass = 'processing';
                                    statusText = 'In Progress';
                                    break;
                                case 'scheduled':
                                    statusClass = 'scheduled';
                                    statusText = 'Scheduled';
                                    break;
                                default:
                                    statusClass = 'pending';
                                    statusText = 'Pending';
                            }

                            row.innerHTML = `
            <td>${route.id}</td>
            <td>${route.driver}</td>
            <td>${route.vehicle}</td>
            <td>${route.stops.length}</td>
            <td>${route.distance}</td>
            <td>${route.estimatedTime}</td>
            <td>${route.date} ${route.startTime}</td>
            <td><span class="status ${statusClass}">${statusText}</span></td>
            <td>
                <button class="btn-primary view-route" data-id="${route.id}"><i class="fas fa-eye"></i></button>
                <button class="btn-success edit-route" data-id="${route.id}"><i class="fas fa-edit"></i></button>
                <button class="btn-danger delete-route" data-id="${route.id}"><i class="fas fa-trash"></i></button>
            </td>
        `;

                            tableBody.appendChild(row);
                        });

                        // Add event listeners to the action buttons
                        document.querySelectorAll('.view-route').forEach(btn => {
                            btn.addEventListener('click', function () {
                                viewRoute(this.getAttribute('data-id'));
                            });
                        });

                        document.querySelectorAll('.edit-route').forEach(btn => {
                            btn.addEventListener('click', function () {
                                editRoute(this.getAttribute('data-id'));
                            });
                        });

                        document.querySelectorAll('.delete-route').forEach(btn => {
                            btn.addEventListener('click', function () {
                                deleteRoute(this.getAttribute('data-id'));
                            });
                        });
                    }

                    // Load drivers into the dropdown
                    function loadDrivers() {
                        const drivers = JSON.parse(localStorage.getItem('deliveryDrivers')) || [];
                        const driverSelect = document.getElementById('routeDriver');

                        // Clear existing options except the first one
                        while (driverSelect.options.length > 1) {
                            driverSelect.remove(1);
                        }

                        drivers.forEach(driver => {
                            const option = document.createElement('option');
                            option.value = driver.id;
                            option.textContent = `${driver.name} (${driver.license})`;
                            driverSelect.appendChild(option);
                        });
                    }

                    // Load vehicles into the dropdown
                    function loadVehicles() {
                        const vehicles = JSON.parse(localStorage.getItem('deliveryVehicles')) || [];
                        const vehicleSelect = document.getElementById('routeVehicle');

                        // Clear existing options except the first one
                        while (vehicleSelect.options.length > 1) {
                            vehicleSelect.remove(1);
                        }

                        vehicles.forEach(vehicle => {
                            if (vehicle.status === 'active') {
                                const option = document.createElement('option');
                                option.value = vehicle.id;
                                option.textContent = `${vehicle.type} - ${vehicle.regNumber} (${vehicle.capacity})`;
                                vehicleSelect.appendChild(option);
                            }
                        });
                    }

                    // Show the add route form
                    function showAddRouteForm() {
                        document.getElementById('addRouteForm').style.display = 'block';
                        document.getElementById('routeForm').reset();
                        document.getElementById('routeStopsContainer').innerHTML = '';
                        addStopField(); // Add one empty stop by default
                    }

                    // Hide the add route form
                    function hideAddRouteForm() {
                        document.getElementById('addRouteForm').style.display = 'none';
                    }

                    // Add a new stop field to the form
                    function addStopField() {
                        const container = document.getElementById('routeStopsContainer');
                        const stopDiv = document.createElement('div');
                        stopDiv.className = 'stop-entry';
                        stopDiv.style.display = 'flex';
                        stopDiv.style.marginBottom = '10px';

                        stopDiv.innerHTML = `
        <input type="text" class="stop-address" placeholder="Address" style="flex: 3; margin-right: 10px;" required />
        <input type="text" class="stop-customer" placeholder="Customer" style="flex: 2; margin-right: 10px;" required />
        <input type="number" class="stop-orders" placeholder="Orders" style="flex: 1; margin-right: 10px;" required min="1" />
        <button type="button" class="btn-danger remove-stop" style="padding: 8px;">
            <i class="fas fa-times"></i>
        </button>
    `;

                        container.appendChild(stopDiv);

                        // Add event listener to the remove button
                        stopDiv.querySelector('.remove-stop').addEventListener('click', function () {
                            if (document.querySelectorAll('.stop-entry').length > 1) {
                                container.removeChild(stopDiv);
                            } else {
                                alert('A route must have at least one stop.');
                            }
                        });
                    }

                    // Save a new or edited route
                    function saveRoute(e) {
                        e.preventDefault();

                        const form = document.getElementById('routeForm');
                        const routeId = form.getAttribute('data-edit-id') || `RT-${Math.floor(1000 + Math.random() * 9000)}`;

                        // Get all stops
                        const stops = [];
                        document.querySelectorAll('.stop-entry').forEach(stopDiv => {
                            stops.push({
                                address: stopDiv.querySelector('.stop-address').value,
                                customer: stopDiv.querySelector('.stop-customer').value,
                                orders: parseInt(stopDiv.querySelector('.stop-orders').value)
                            });
                        });

                        // Calculate distance and estimated time (simplified for demo)
                        const distance = `${Math.floor(5 + Math.random() * 60)} km`;
                        const estimatedTime = `${(1 + Math.random() * 4).toFixed(1)} hours`;

                        // Get selected driver and vehicle details
                        const driverId = document.getElementById('routeDriver').value;
                        const vehicleId = document.getElementById('routeVehicle').value;

                        const drivers = JSON.parse(localStorage.getItem('deliveryDrivers')) || [];
                        const vehicles = JSON.parse(localStorage.getItem('deliveryVehicles')) || [];

                        const driver = drivers.find(d => d.id === driverId);
                        const vehicle = vehicles.find(v => v.id === vehicleId);

                        const newRoute = {
                            id: routeId,
                            name: document.getElementById('routeName').value,
                            driver: driver ? driver.name : '',
                            driverId: driverId,
                            vehicle: vehicle ? `${vehicle.type} ${vehicle.regNumber}` : '',
                            vehicleId: vehicleId,
                            date: document.getElementById('routeDate').value,
                            startTime: document.getElementById('routeStartTime').value,
                            stops: stops,
                            distance: distance,
                            estimatedTime: estimatedTime,
                            status: document.getElementById('routeStatus').value,
                            notes: document.getElementById('routeNotes').value
                        };

                        // Save to localStorage
                        const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];

                        if (form.getAttribute('data-edit-id')) {
                            // Update existing route
                            const index = routes.findIndex(r => r.id === routeId);
                            if (index !== -1) {
                                routes[index] = newRoute;
                            }
                        } else {
                            // Add new route
                            routes.push(newRoute);
                        }

                        localStorage.setItem('deliveryRoutes', JSON.stringify(routes));

                        // Refresh the UI
                        hideAddRouteForm();
                        loadDeliveryRoutes();
                        initMap();
                        initCharts();
                    }

                    // View route details
                    function viewRoute(routeId) {
                        const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];
                        const route = routes.find(r => r.id === routeId);

                        if (route) {
                            alert(`Route Details:\n\nID: ${route.id}\nName: ${route.name}\nDriver: ${route.driver}\nVehicle: ${route.vehicle}\nDate: ${route.date}\nStart Time: ${route.startTime}\nStops: ${route.stops.length}\nDistance: ${route.distance}\nEstimated Time: ${route.estimatedTime}\nStatus: ${route.status}\nNotes: ${route.notes}`);
                        }
                    }

                    // Edit route
                    function editRoute(routeId) {
                        const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];
                        const route = routes.find(r => r.id === routeId);

                        if (route) {
                            document.getElementById('addRouteForm').style.display = 'block';
                            document.getElementById('routeForm').reset();
                            document.getElementById('routeForm').setAttribute('data-edit-id', route.id);

                            // Fill form with route data
                            document.getElementById('routeName').value = route.name;
                            document.getElementById('routeDriver').value = route.driverId;
                            document.getElementById('routeVehicle').value = route.vehicleId;
                            document.getElementById('routeDate').value = route.date;
                            document.getElementById('routeStartTime').value = route.startTime;
                            document.getElementById('routeStatus').value = route.status;
                            document.getElementById('routeNotes').value = route.notes || '';

                            // Add stops
                            const stopsContainer = document.getElementById('routeStopsContainer');
                            stopsContainer.innerHTML = '';

                            route.stops.forEach(stop => {
                                const stopDiv = document.createElement('div');
                                stopDiv.className = 'stop-entry';
                                stopDiv.style.display = 'flex';
                                stopDiv.style.marginBottom = '10px';

                                stopDiv.innerHTML = `
                <input type="text" class="stop-address" placeholder="Address" style="flex: 3; margin-right: 10px;" value="${stop.address}" required />
                <input type="text" class="stop-customer" placeholder="Customer" style="flex: 2; margin-right: 10px;" value="${stop.customer}" required />
                <input type="number" class="stop-orders" placeholder="Orders" style="flex: 1; margin-right: 10px;" value="${stop.orders}" required min="1" />
                <button type="button" class="btn-danger remove-stop" style="padding: 8px;">
                    <i class="fas fa-times"></i>
                </button>
            `;

                                stopsContainer.appendChild(stopDiv);

                                // Add event listener to the remove button
                                stopDiv.querySelector('.remove-stop').addEventListener('click', function () {
                                    if (document.querySelectorAll('.stop-entry').length > 1) {
                                        stopsContainer.removeChild(stopDiv);
                                    } else {
                                        alert('A route must have at least one stop.');
                                    }
                                });
                            });
                        }
                    }

                    // Delete route
                    function deleteRoute(routeId) {
                        if (confirm('Are you sure you want to delete this route?')) {
                            const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];
                            const updatedRoutes = routes.filter(r => r.id !== routeId);

                            localStorage.setItem('deliveryRoutes', JSON.stringify(updatedRoutes));

                            // Refresh the UI
                            loadDeliveryRoutes();
                            initMap();
                            initCharts();
                        }
                    }

                    // Initialize charts
                    function initCharts() {
                        const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];

                        // Active Routes Chart
                        const activeRoutesCtx = document.getElementById('activeRoutesChart').getContext('2d');
                        new Chart(activeRoutesCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    label: 'Active Routes',
                                    data: [12, 15, 13, 17, 16, 18],
                                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                    borderColor: 'rgba(54, 162, 235, 1)',
                                    borderWidth: 2,
                                    tension: 0.3
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        });

                        // Avg Delivery Time Chart
                        const avgDeliveryTimeCtx = document.getElementById('avgDeliveryTimeChart').getContext('2d');
                        new Chart(avgDeliveryTimeCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    label: 'Avg Delivery Time (hours)',
                                    data: [3.2, 3.0, 2.9, 2.8, 2.9, 2.8],
                                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                    borderColor: 'rgba(75, 192, 192, 1)',
                                    borderWidth: 2
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        });

                        // Completed Today Chart
                        const completedTodayCtx = document.getElementById('completedTodayChart').getContext('2d');
                        new Chart(completedTodayCtx, {
                            type: 'doughnut',
                            data: {
                                labels: ['Completed', 'In Progress', 'Scheduled'],
                                datasets: [{
                                    data: [45, 12, 23],
                                    backgroundColor: [
                                        'rgba(75, 192, 192, 0.7)',
                                        'rgba(54, 162, 235, 0.7)',
                                        'rgba(255, 206, 86, 0.7)'
                                    ],
                                    borderColor: [
                                        'rgba(75, 192, 192, 1)',
                                        'rgba(54, 162, 235, 1)',
                                        'rgba(255, 206, 86, 1)'
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        position: 'bottom'
                                    }
                                }
                            }
                        });

                        // On-Time Rate Chart
                        const onTimeRateCtx = document.getElementById('onTimeRateChart').getContext('2d');
                        new Chart(onTimeRateCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    label: 'On-Time Rate %',
                                    data: [89, 90, 91, 92, 91, 92],
                                    backgroundColor: 'rgba(153, 102, 255, 0.2)',
                                    borderColor: 'rgba(153, 102, 255, 1)',
                                    borderWidth: 2,
                                    tension: 0.3
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: false,
                                        min: 85,
                                        max: 100
                                    }
                                }
                            }
                        });

                        // Delivery Time Trends Chart
                        const deliveryTimeTrendCtx = document.getElementById('deliveryTimeTrendChart').getContext('2d');
                        new Chart(deliveryTimeTrendCtx, {
                            type: 'line',
                            data: {
                                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                                datasets: [
                                    {
                                        label: 'This Week',
                                        data: [2.9, 3.1, 2.8, 2.7, 2.9, 3.2, 3.0],
                                        borderColor: 'rgba(54, 162, 235, 1)',
                                        backgroundColor: 'rgba(54, 162, 235, 0.1)',
                                        borderWidth: 2,
                                        tension: 0.3
                                    },
                                    {
                                        label: 'Last Week',
                                        data: [3.1, 3.2, 3.0, 2.9, 3.1, 3.3, 3.1],
                                        borderColor: 'rgba(201, 203, 207, 1)',
                                        backgroundColor: 'rgba(201, 203, 207, 0.1)',
                                        borderWidth: 2,
                                        tension: 0.3,
                                        borderDash: [5, 5]
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    title: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: false,
                                        min: 2.5,
                                        title: {
                                            display: true,
                                            text: 'Hours'
                                        }
                                    }
                                }
                            }
                        });

                        // On-Time Performance Chart
                        const onTimePerformanceCtx = document.getElementById('onTimePerformanceChart').getContext('2d');
                        new Chart(onTimePerformanceCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Route 1', 'Route 2', 'Route 3', 'Route 4', 'Route 5'],
                                datasets: [
                                    {
                                        label: 'On-Time %',
                                        data: [95, 89, 92, 94, 91],
                                        backgroundColor: 'rgba(75, 192, 192, 0.7)',
                                        borderColor: 'rgba(75, 192, 192, 1)',
                                        borderWidth: 1
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: false,
                                        min: 85,
                                        max: 100,
                                        title: {
                                            display: true,
                                            text: 'Percentage'
                                        }
                                    }
                                }
                            }
                        });

                        // Route Efficiency Chart
                        const routeEfficiencyCtx = document.getElementById('routeEfficiencyChart').getContext('2d');
                        new Chart(routeEfficiencyCtx, {
                            type: 'radar',
                            data: {
                                labels: ['Distance', 'Time', 'Fuel', 'Stops', 'Load', 'On-Time'],
                                datasets: [
                                    {
                                        label: 'Efficiency Score',
                                        data: [85, 78, 92, 88, 80, 90],
                                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                        borderColor: 'rgba(255, 99, 132, 1)',
                                        pointBackgroundColor: 'rgba(255, 99, 132, 1)',
                                        pointBorderColor: '#fff',
                                        pointHoverBackgroundColor: '#fff',
                                        pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                scales: {
                                    r: {
                                        angleLines: {
                                            display: true
                                        },
                                        suggestedMin: 50,
                                        suggestedMax: 100
                                    }
                                }
                            }
                        });

                        // Load driver performance data
                        loadDriverPerformance();
                    }

                    // Initialize map (simulated for demo)
                    function initMap() {
                        const mapElement = document.getElementById('deliveryMap');
                        const loadingElement = document.getElementById('mapLoading');

                        // Simulate map loading
                        setTimeout(() => {
                            loadingElement.style.display = 'none';

                            // Create a simulated map (in a real app, this would be a proper map library)
                            mapElement.innerHTML = '<div style="padding: 20px; text-align: center;">Map visualization would appear here with routes marked</div>';

                            // Add some simulated route markers
                            const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];
                            routes.forEach(route => {
                                const marker = document.createElement('div');
                                marker.style.position = 'absolute';
                                marker.style.width = '15px';
                                marker.style.height = '15px';
                                marker.style.borderRadius = '50%';
                                marker.style.transform = 'translate(-50%, -50%)';

                                // Position randomly for demo
                                marker.style.left = `${10 + Math.random() * 80}%`;
                                marker.style.top = `${10 + Math.random() * 80}%`;

                                // Set color based on status
                                switch (route.status) {
                                    case 'completed':
                                        marker.style.backgroundColor = '#4CAF50';
                                        break;
                                    case 'in-progress':
                                        marker.style.backgroundColor = '#2196F3';
                                        break;
                                    case 'scheduled':
                                        marker.style.backgroundColor = '#FFC107';
                                        break;
                                    default:
                                        marker.style.backgroundColor = '#F44336';
                                }

                                mapElement.appendChild(marker);
                            });
                        }, 1000);
                    }

                    // Refresh map
                    function refreshMap() {
                        const mapElement = document.getElementById('deliveryMap');
                        const loadingElement = document.getElementById('mapLoading');

                        loadingElement.style.display = 'block';
                        mapElement.innerHTML = '';

                        // Reinitialize the map
                        initMap();
                    }

                    // Print map
                    function printMap() {
                        alert('In a real application, this would open a print dialog for the map visualization.');
                    }

                    // Export map
                    function exportMap() {
                        alert('In a real application, this would export the map as an image or PDF.');
                    }

                    // Export routes data
                    function exportRoutes() {
                        alert('In a real application, this would export the routes data as CSV or Excel.');
                    }

                    // Export driver performance
                    function exportDriverPerformance() {
                        alert('In a real application, this would export the driver performance report.');
                    }

                    // Load driver performance data
                    function loadDriverPerformance() {
                        const drivers = JSON.parse(localStorage.getItem('deliveryDrivers')) || [];
                        const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];
                        const tableBody = document.getElementById('driverPerformanceBody');
                        tableBody.innerHTML = '';

                        drivers.forEach(driver => {
                            const driverRoutes = routes.filter(route => route.driverId === driver.id);
                            const completedRoutes = driverRoutes.filter(route => route.status === 'completed').length;

                            // Calculate average delivery time (simplified for demo)
                            let totalTime = 0;
                            driverRoutes.forEach(route => {
                                if (route.status === 'completed') {
                                    const hours = parseFloat(route.estimatedTime.split(' ')[0]);
                                    totalTime += hours;
                                }
                            });
                            const avgDeliveryTime = completedRoutes > 0 ? (totalTime / completedRoutes).toFixed(1) : 0;

                            // Calculate on-time percentage (simplified for demo)
                            const onTimePercentage = completedRoutes > 0 ? Math.floor(85 + Math.random() * 15) : 0;

                            // Calculate mileage (simplified for demo)
                            const mileage = completedRoutes * (50 + Math.random() * 100);

                            // Create table row
                            const row = document.createElement('tr');
                            row.innerHTML = `
            <td>${driver.name}</td>
            <td>${completedRoutes}</td>
            <td>${avgDeliveryTime}h</td>
            <td>${onTimePercentage}%</td>
            <td>${mileage.toFixed(0)} km</td>
            <td>${(10 + Math.random() * 5).toFixed(1)} km/L</td>
            <td>
                <div class="rating-stars">
                    ${renderStars(driver.rating)}
                    <span class="rating-value">${driver.rating.toFixed(1)}</span>
                </div>
            </td>
        `;
                            tableBody.appendChild(row);
                        });
                    }

                    // Render star rating
                    function renderStars(rating) {
                        let stars = '';
                        const fullStars = Math.floor(rating);
                        const hasHalfStar = rating % 1 >= 0.5;

                        for (let i = 0; i < fullStars; i++) {
                            stars += '<i class="fas fa-star"></i>';
                        }

                        if (hasHalfStar) {
                            stars += '<i class="fas fa-star-half-alt"></i>';
                        }

                        const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
                        for (let i = 0; i < emptyStars; i++) {
                            stars += '<i class="far fa-star"></i>';
                        }

                        return stars;
                    }

                    // Pagination functions
                    function prevPage() {
                        if (currentPage > 1) {
                            currentPage--;
                            loadDeliveryRoutes();
                        }
                    }

                    function nextPage() {
                        const routes = JSON.parse(localStorage.getItem('deliveryRoutes')) || [];
                        const totalPages = Math.ceil(routes.length / routesPerPage);

                        if (currentPage < totalPages) {
                            currentPage++;
                            loadDeliveryRoutes();
                        }
                    }

                    // Filter routes
                    function filterRoutes() {
                        currentPage = 1;
                        loadDeliveryRoutes();
                    }

                    // Search routes
                    function searchRoutes() {
                        currentPage = 1;
                        loadDeliveryRoutes();
                    }

                    // Update analytics based on time range
                    function updateAnalytics() {
                        const timeRange = document.getElementById('analyticsTimeRange').value;
                        alert(`In a real application, this would update analytics for the ${timeRange} time range.`);
                        // Here you would typically reload chart data based on the selected time range
                    }
                </script>
                <script>
                    
                </script>

                

                <!-- Quality Testing Section ... (your HTML content as before) ... -->

                <script>
                    // Chart.js chart instances
                    let qtResultPieChart = null;
                    let qtTypeBarChart = null;

                    // Initial demo data for Quality Tests
                    const initialQualityTests = [
                        { date: "2025-06-10", batch: "B-1001", type: "Fat Content", result: "Pass", remarks: "Good quality" },
                        { date: "2025-06-11", batch: "B-1002", type: "SNF", result: "Fail", remarks: "Low SNF" },
                        { date: "2025-06-11", batch: "B-1003", type: "Adulteration", result: "Pass", remarks: "No adulteration detected" },
                        { date: "2025-06-12", batch: "B-1004", type: "Microbial", result: "Pending", remarks: "Awaiting lab results" },
                        { date: "2025-06-12", batch: "B-1005", type: "Fat Content", result: "Fail", remarks: "Below standard" },
                        { date: "2025-06-13", batch: "B-1006", type: "SNF", result: "Pass", remarks: "Acceptable SNF" }
                    ];

                    function getQualityTests() {
                        let arr = [];
                        try {
                            arr = JSON.parse(localStorage.getItem('qualityTests') || "[]");
                        } catch (e) { arr = []; }
                        // If not valid or empty, inject demo data
                        if (!Array.isArray(arr) || arr.length === 0) {
                            setQualityTests(initialQualityTests);
                            return [...initialQualityTests];
                        }
                        return arr;
                    }
                    function setQualityTests(tests) {
                        localStorage.setItem('qualityTests', JSON.stringify(tests));
                    }

                    function renderQualityTests() {
                        const table = document.getElementById('quality-test-table').getElementsByTagName('tbody')[0];
                        table.innerHTML = '';
                        let tests = getQualityTests();
                        if (tests.length === 0) {
                            table.innerHTML = `<tr><td colspan="6" style="text-align:center;">No quality tests found.</td></tr>`;
                        } else {
                            tests.forEach((test, idx) => {
                                let row = table.insertRow();
                                row.insertCell(0).innerText = test.date ? test.date.split('T')[0] : '';
                                row.insertCell(1).innerText = test.batch || '';
                                row.insertCell(2).innerText = test.type || '';
                                row.insertCell(3).innerHTML = test.result ? `<span class="status ${test.result.toLowerCase()}">${test.result}</span>` : '';
                                row.insertCell(4).innerText = test.remarks || '';
                                row.insertCell(5).innerHTML = `
                    <button class="edit-btn" onclick="editQualityTest(${idx})">Edit</button>
                    <button class="btn-primary" style="margin-left:5px;" onclick="deleteQualityTest(${idx})">Delete</button>
                `;
                            });
                        }
                        updateQualityTestCharts(tests);
                        updateQualityTestStats(tests);
                    }

                    function showQualityTestForm(edit = false, idx = null) {
                        document.getElementById('quality-test-form').style.display = 'block';
                        if (!edit) {
                            document.getElementById('qtForm').reset();
                            document.getElementById('qtIndex').value = '';
                        }
                    }
                    function hideQualityTestForm() {
                        document.getElementById('quality-test-form').style.display = 'none';
                        document.getElementById('qtForm').reset();
                        document.getElementById('qtIndex').value = '';
                    }
                    function editQualityTest(idx) {
                        let tests = getQualityTests();
                        let test = tests[idx];
                        document.getElementById('qtIndex').value = idx;
                        document.getElementById('qtDate').value = test.date;
                        document.getElementById('qtBatch').value = test.batch;
                        document.getElementById('qtType').value = test.type;
                        document.getElementById('qtResult').value = test.result;
                        document.getElementById('qtRemarks').value = test.remarks;
                        showQualityTestForm(true, idx);
                    }
                    function deleteQualityTest(idx) {
                        if (!confirm('Are you sure you want to delete this test?')) return;
                        let tests = getQualityTests();
                        tests.splice(idx, 1);
                        setQualityTests(tests);
                        renderQualityTests();
                    }
                    document.getElementById('qtForm').addEventListener('submit', function (e) {
                        e.preventDefault();
                        const idx = document.getElementById('qtIndex').value;
                        let test = {
                            date: document.getElementById('qtDate').value,
                            batch: document.getElementById('qtBatch').value,
                            type: document.getElementById('qtType').value,
                            result: document.getElementById('qtResult').value,
                            remarks: document.getElementById('qtRemarks').value
                        };
                        let tests = getQualityTests();
                        if (idx === '') {
                            tests.push(test);
                        } else {
                            tests[idx] = test;
                        }
                        setQualityTests(tests);
                        hideQualityTestForm();
                        renderQualityTests();
                    });

                    function updateQualityTestStats(tests) {
                        let total = tests.length;
                        let pass = tests.filter(t => t.result === "Pass").length;
                        let fail = tests.filter(t => t.result === "Fail").length;
                        let passRate = total > 0 ? Math.round((pass / total) * 100) : 0;
                        if (document.getElementById('qt-total-tests')) document.getElementById('qt-total-tests').innerText = total;
                        if (document.getElementById('qt-pass-rate')) document.getElementById('qt-pass-rate').innerText = passRate + "%";
                        if (document.getElementById('qt-failed-tests')) document.getElementById('qt-failed-tests').innerText = fail;
                    }

                    function updateQualityTestCharts(tests) {
                        const results = { Pass: 0, Fail: 0, Pending: 0 };
                        const types = {};
                        tests.forEach(t => {
                            if (t.result) results[t.result] = (results[t.result] || 0) + 1;
                            if (t.type) types[t.type] = (types[t.type] || 0) + 1;
                        });

                        // Pie Data
                        const pieLabels = ["Pass", "Fail", "Pending"];
                        const pieData = pieLabels.map(label => results[label] || 0);
                        // Bar Data
                        const barLabels = Object.keys(types);
                        const barData = barLabels.map(label => types[label]);

                        // Pie Chart
                        if (qtResultPieChart) qtResultPieChart.destroy();
                        const pieCtx = document.getElementById('qtResultPie').getContext('2d');
                        qtResultPieChart = new Chart(pieCtx, {
                            type: 'pie',
                            data: {
                                labels: pieLabels,
                                datasets: [{
                                    data: pieData,
                                    backgroundColor: ['#2a9d8f', '#e76f51', '#e9c46a']
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: true, position: 'bottom' } }
                            }
                        });
                        // Bar Chart
                        if (qtTypeBarChart) qtTypeBarChart.destroy();
                        const barCtx = document.getElementById('qtTypeBar').getContext('2d');
                        qtTypeBarChart = new Chart(barCtx, {
                            type: 'bar',
                            data: {
                                labels: barLabels,
                                datasets: [{
                                    label: 'Number of Tests',
                                    data: barData,
                                    backgroundColor: '#0077b6'
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: {
                                    y: { beginAtZero: true, ticks: { precision: 0, stepSize: 1 } }
                                }
                            }
                        });
                    }

                    // CSV Export (optional, if you use this button)
                    function exportQualityTests() {
                        let tests = getQualityTests();
                        if (!tests.length) return alert("No data to export!");
                        let csv = "Date,Batch,Test Type,Result,Remarks\n";
                        tests.forEach(t => {
                            csv += `"${t.date ? t.date.split('T')[0] : ''}","${t.batch || ''}","${t.type || ''}","${t.result || ''}","${t.remarks || ''}"\n`;
                        });
                        let blob = new Blob([csv], { type: "text/csv" });
                        let a = document.createElement('a');
                        a.href = URL.createObjectURL(blob);
                        a.download = "quality_tests.csv";
                        a.click();
                    }

                    // Section switching logic
                    function showSection(sectionId) {
                        document.querySelectorAll('.child-section').forEach(sec => sec.classList.remove('active'));
                        document.getElementById(sectionId).classList.add('active');
                        if (sectionId === 'quality-testing-section') {
                            renderQualityTests();
                        }
                        // ... existing logic for other sections
                    }

                    // On first load, load demo data if needed and show the section
                    document.addEventListener('DOMContentLoaded', function () {
                        // Optionally, auto-show the section on page load:
                        // showSection('quality-testing-section');
                        // Otherwise, demo data will load on first manual showSection call.
                    });
                </script>
                <script>
                    // Retail Outlets Management JavaScript
                    document.addEventListener('DOMContentLoaded', function () {
                        // Sample data for retail outlets
                        const outletsData = [
                            {
                                id: 'RT-1001',
                                name: 'Ahmedabad Main',
                                location: 'Ahmedabad',
                                manager: 'Rajesh Patel',
                                contact: '+91 9876543210',
                                status: 'active',
                                lastRestock: '2023-06-15'
                            },
                            {
                                id: 'RT-1002',
                                name: 'Gandhinagar Central',
                                location: 'Gandhinagar',
                                manager: 'Priya Sharma',
                                contact: '+91 9876543211',
                                status: 'active',
                                lastRestock: '2023-06-14'
                            },
                            {
                                id: 'RT-1003',
                                name: 'Vadodara West',
                                location: 'Vadodara',
                                manager: 'Vijay Singh',
                                contact: '+91 9876543212',
                                status: 'active',
                                lastRestock: '2023-06-13'
                            },
                            {
                                id: 'RT-1004',
                                name: 'Surat South',
                                location: 'Surat',
                                manager: 'Meena Desai',
                                contact: '+91 9876543213',
                                status: 'active',
                                lastRestock: '2023-06-12'
                            },
                            {
                                id: 'RT-1005',
                                name: 'Rajkot East',
                                location: 'Rajkot',
                                manager: 'Arun Gupta',
                                contact: '+91 9876543214',
                                status: 'active',
                                lastRestock: '2023-06-11'
                            },
                            {
                                id: 'RT-1006',
                                name: 'Bhavnagar North',
                                location: 'Bhavnagar',
                                manager: 'Sunil Verma',
                                contact: '+91 9876543215',
                                status: 'inactive',
                                lastRestock: '2023-05-28'
                            },
                            {
                                id: 'RT-1007',
                                name: 'Anand Plaza',
                                location: 'Anand',
                                manager: 'Ramesh Patel',
                                contact: '+91 9876543216',
                                status: 'active',
                                lastRestock: '2023-06-10'
                            },
                            {
                                id: 'RT-1008',
                                name: 'Jamnagar Central',
                                location: 'Jamnagar',
                                manager: 'Kiran Shah',
                                contact: '+91 9876543217',
                                status: 'active',
                                lastRestock: '2023-06-09'
                            }
                        ];

                        // DOM elements
                        const outletsTableBody = document.getElementById('outletsTableBody');
                        const outletSearch = document.getElementById('outletSearch');
                        const outletFilter = document.getElementById('outletFilter');
                        const outletPrevPage = document.getElementById('outletPrevPage');
                        const outletNextPage = document.getElementById('outletNextPage');
                        const outletShowingFrom = document.getElementById('outletShowingFrom');
                        const outletShowingTo = document.getElementById('outletShowingTo');
                        const outletTotalCount = document.getElementById('outletTotalCount');
                        const addOutletBtn = document.getElementById('addOutletBtn');
                        const addOutletForm = document.getElementById('addOutletForm');
                        const closeOutletForm = document.getElementById('closeOutletForm');
                        const cancelOutletForm = document.getElementById('cancelOutletForm');
                        const outletForm = document.getElementById('outletForm');
                        const refreshMapBtn = document.getElementById('refreshMapBtn');
                        const exportOutletsPdfBtn = document.getElementById('exportOutletsPdfBtn');
                        const exportOutletsExcelBtn = document.getElementById('exportOutletsExcelBtn');
                        const printOutletsReportBtn = document.getElementById('printOutletsReportBtn');

                        // Pagination variables
                        let currentPage = 1;
                        const rowsPerPage = 5;

                        // Initialize the outlets table
                        function initOutletsTable() {
                            renderOutletsTable();
                            updatePaginationInfo();
                        }

                        // Render outlets table with current data and pagination
                        function renderOutletsTable() {
                            const filteredData = filterOutlets();
                            const paginatedData = paginateData(filteredData);

                            outletsTableBody.innerHTML = '';

                            paginatedData.forEach(outlet => {
                                const row = document.createElement('tr');

                                row.innerHTML = `
                <td>${outlet.id}</td>
                <td>${outlet.name}</td>
                <td>${outlet.location}</td>
                <td>${outlet.manager}</td>
                <td>${outlet.contact}</td>
                <td><span class="status ${outlet.status === 'active' ? 'completed' : 'pending'}">${outlet.status === 'active' ? 'Active' : 'Inactive'}</span></td>
                <td>${formatDate(outlet.lastRestock)}</td>
                <td>
                    <button class="btn-primary" onclick="viewOutletDetails('${outlet.id}')"><i class="fas fa-eye"></i></button>
                    <button class="btn-success" onclick="editOutlet('${outlet.id}')"><i class="fas fa-edit"></i></button>
                </td>
            `;

                                outletsTableBody.appendChild(row);
                            });

                            // Update pagination buttons state
                            outletPrevPage.disabled = currentPage === 1;
                            outletNextPage.disabled = currentPage * rowsPerPage >= filteredData.length;
                        }

                        // Filter outlets based on search and filter criteria
                        function filterOutlets() {
                            const searchTerm = outletSearch.value.toLowerCase();
                            const filterValue = outletFilter.value;

                            return outletsData.filter(outlet => {
                                const matchesSearch =
                                    outlet.id.toLowerCase().includes(searchTerm) ||
                                    outlet.name.toLowerCase().includes(searchTerm) ||
                                    outlet.location.toLowerCase().includes(searchTerm) ||
                                    outlet.manager.toLowerCase().includes(searchTerm);

                                const matchesFilter =
                                    filterValue === 'all' ||
                                    (filterValue === 'active' && outlet.status === 'active') ||
                                    (filterValue === 'inactive' && outlet.status === 'inactive') ||
                                    (filterValue === 'low-stock' && outlet.status === 'active'); // Simplified for demo

                                return matchesSearch && matchesFilter;
                            });
                        }

                        // Paginate the data
                        function paginateData(data) {
                            const startIndex = (currentPage - 1) * rowsPerPage;
                            const endIndex = startIndex + rowsPerPage;
                            return data.slice(startIndex, endIndex);
                        }

                        // Update pagination information
                        function updatePaginationInfo() {
                            const filteredData = filterOutlets();
                            const totalItems = filteredData.length;
                            const startItem = (currentPage - 1) * rowsPerPage + 1;
                            const endItem = Math.min(currentPage * rowsPerPage, totalItems);

                            outletShowingFrom.textContent = startItem;
                            outletShowingTo.textContent = endItem;
                            outletTotalCount.textContent = totalItems;
                        }

                        // Format date for display
                        function formatDate(dateString) {
                            const options = { year: 'numeric', month: 'short', day: 'numeric' };
                            return new Date(dateString).toLocaleDateString('en-US', options);
                        }

                        // Event listeners
                        outletSearch.addEventListener('input', () => {
                            currentPage = 1;
                            renderOutletsTable();
                            updatePaginationInfo();
                        });

                        outletFilter.addEventListener('change', () => {
                            currentPage = 1;
                            renderOutletsTable();
                            updatePaginationInfo();
                        });

                        outletPrevPage.addEventListener('click', () => {
                            if (currentPage > 1) {
                                currentPage--;
                                renderOutletsTable();
                                updatePaginationInfo();
                            }
                        });

                        outletNextPage.addEventListener('click', () => {
                            const filteredData = filterOutlets();
                            if (currentPage * rowsPerPage < filteredData.length) {
                                currentPage++;
                                renderOutletsTable();
                                updatePaginationInfo();
                            }
                        });

                        addOutletBtn.addEventListener('click', () => {
                            addOutletForm.style.display = 'block';
                        });

                        closeOutletForm.addEventListener('click', () => {
                            addOutletForm.style.display = 'none';
                            outletForm.reset();
                        });

                        cancelOutletForm.addEventListener('click', () => {
                            addOutletForm.style.display = 'none';
                            outletForm.reset();
                        });

                        outletForm.addEventListener('submit', (e) => {
                            e.preventDefault();

                            // In a real app, you would validate the form data first
                            const newOutlet = {
                                id: `RT-${Math.floor(1000 + Math.random() * 9000)}`,
                                name: document.getElementById('outletName').value,
                                location: document.getElementById('outletLocation').value,
                                manager: document.getElementById('outletManager').value,
                                contact: document.getElementById('outletContact').value,
                                status: document.getElementById('outletStatus').value,
                                lastRestock: new Date().toISOString().split('T')[0]
                            };

                            outletsData.unshift(newOutlet);
                            addOutletForm.style.display = 'none';
                            outletForm.reset();

                            currentPage = 1;
                            renderOutletsTable();
                            updatePaginationInfo();

                            // Show success message
                            alert('New outlet added successfully!');
                        });

                        refreshMapBtn.addEventListener('click', () => {
                            // In a real app, this would refresh the map data
                            alert('Map data refreshed!');
                        });

                        exportOutletsPdfBtn.addEventListener('click', () => {
                            // In a real app, this would generate a PDF
                            alert('PDF export functionality would be implemented here');
                        });

                        exportOutletsExcelBtn.addEventListener('click', () => {
                            // In a real app, this would generate an Excel file
                            alert('Excel export functionality would be implemented here');
                        });

                        printOutletsReportBtn.addEventListener('click', () => {
                            // In a real app, this would print the report
                            alert('Print functionality would be implemented here');
                        });

                        // Initialize charts (simplified for demo)
                        function initCharts() {
                            // Sales Performance Chart
                            const salesCtx = document.getElementById('salesPerformanceChart').getContext('2d');
                            new Chart(salesCtx, {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                    datasets: [{
                                        label: 'Sales (₹)',
                                        data: [120000, 150000, 180000, 140000, 160000, 200000],
                                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                        borderColor: 'rgba(54, 162, 235, 1)',
                                        borderWidth: 2
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Sales Performance Trend'
                                        }
                                    }
                                }
                            });

                            // Stock Availability Chart
                            const stockCtx = document.getElementById('stockAvailabilityChart').getContext('2d');
                            new Chart(stockCtx, {
                                type: 'bar',
                                data: {
                                    labels: ['Milk', 'Cheese', 'Ghee', 'Paneer', 'Yogurt'],
                                    datasets: [{
                                        label: 'Stock Availability',
                                        data: [85, 72, 90, 65, 78],
                                        backgroundColor: [
                                            'rgba(75, 192, 192, 0.6)',
                                            'rgba(54, 162, 235, 0.6)',
                                            'rgba(255, 206, 86, 0.6)',
                                            'rgba(153, 102, 255, 0.6)',
                                            'rgba(255, 159, 64, 0.6)'
                                        ]
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Stock Availability by Product'
                                        }
                                    },
                                    scales: {
                                        y: {
                                            beginAtZero: true,
                                            max: 100
                                        }
                                    }
                                }
                            });

                            // Customer Footfall Chart
                            const footfallCtx = document.getElementById('footfallChart').getContext('2d');
                            new Chart(footfallCtx, {
                                type: 'doughnut',
                                data: {
                                    labels: ['Weekdays', 'Weekends', 'Holidays'],
                                    datasets: [{
                                        data: [60, 30, 10],
                                        backgroundColor: [
                                            'rgba(54, 162, 235, 0.6)',
                                            'rgba(255, 99, 132, 0.6)',
                                            'rgba(255, 206, 86, 0.6)'
                                        ]
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Customer Footfall Distribution'
                                        }
                                    }
                                }
                            });
                        }

                        // Initialize the page
                        initOutletsTable();
                        initCharts();
                    });

                    // Global functions for outlet actions
                    function viewOutletDetails(outletId) {
                        alert(`Viewing details for outlet ${outletId}`);
                        // In a real app, this would open a modal or navigate to a details page
                    }

                    function editOutlet(outletId) {
                        alert(`Editing outlet ${outletId}`);
                        // In a real app, this would populate the form with the outlet's data
                    }
                </script>
                <script>
                    // Payments Section JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // Initialize payments data from local storage or create empty array
    let payments = JSON.parse(localStorage.getItem('payments')) || [];
    let currentPage = 1;
    const itemsPerPage = 5;
    
    // DOM elements
    const paymentsTableBody = document.getElementById('paymentsTableBody');
    const paymentForm = document.getElementById('paymentForm');
    const addPaymentForm = document.getElementById('addPaymentForm');
    const addPaymentBtn = document.getElementById('addPaymentBtn');
    const closePaymentForm = document.getElementById('closePaymentForm');
    const cancelPaymentForm = document.getElementById('cancelPaymentForm');
    const editPaymentModal = document.getElementById('editPaymentModal');
    const editPaymentForm = document.getElementById('editPaymentForm');
    const paymentSearch = document.getElementById('paymentSearch');
    const paymentFilter = document.getElementById('paymentFilter');
    const paymentDateFilter = document.getElementById('paymentDateFilter');
    const applyFiltersBtn = document.getElementById('applyFiltersBtn');
    const resetFiltersBtn = document.getElementById('resetFiltersBtn');
    const prevPaymentPage = document.getElementById('prevPaymentPage');
    const nextPaymentPage = document.getElementById('nextPaymentPage');
    const paymentPaginationInfo = document.getElementById('paymentPaginationInfo');
    const exportPaymentPdfBtn = document.getElementById('exportPaymentPdfBtn');
    const generateInvoiceBtn = document.getElementById('generateInvoiceBtn');
    const totalPaymentsValue = document.getElementById('totalPaymentsValue');
    const pendingPaymentsValue = document.getElementById('pendingPaymentsValue');
    const avgPaymentValue = document.getElementById('avgPaymentValue');
    const paymentChange = document.getElementById('paymentChange');
    const pendingChange = document.getElementById('pendingChange');
    const avgPaymentChange = document.getElementById('avgPaymentChange');

    // Initialize charts
    initPaymentCharts();
    
    // Load initial data
    loadPayments();
    updatePaymentStats();
    
    // Event listeners
    addPaymentBtn.addEventListener('click', showAddPaymentForm);
    closePaymentForm.addEventListener('click', hideAddPaymentForm);
    cancelPaymentForm.addEventListener('click', hideAddPaymentForm);
    paymentForm.addEventListener('submit', savePayment);
    paymentSearch.addEventListener('input', filterPayments);
    paymentFilter.addEventListener('change', filterPayments);
    paymentDateFilter.addEventListener('change', filterPayments);
    applyFiltersBtn.addEventListener('click', filterPayments);
    resetFiltersBtn.addEventListener('click', resetFilters);
    prevPaymentPage.addEventListener('click', goToPrevPage);
    nextPaymentPage.addEventListener('click', goToNextPage);
    exportPaymentPdfBtn.addEventListener('click', exportPaymentsToPDF);
    generateInvoiceBtn.addEventListener('click', generateInvoice);
    
    // Functions
    function loadPayments(filteredData = null) {
        const dataToDisplay = filteredData || payments;
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const paginatedData = dataToDisplay.slice(startIndex, endIndex);
        
        paymentsTableBody.innerHTML = '';
        
        if (paginatedData.length === 0) {
            paymentsTableBody.innerHTML = '<tr><td colspan="8" style="text-align: center;">No payments found</td></tr>';
            return;
        }
        
        paginatedData.forEach((payment, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${payment.id}</td>
                <td>${payment.date}<br>${formatDate(payment.date)}</td>
                <td>${payment.recipient}</td>
                <td>₹${payment.amount.toFixed(2)}</td>
                <td>${formatMethod(payment.method)}</td>
                <td>${payment.reference || '-'}</td>
                <td><span class="status ${getStatusClass(payment.status)}">${formatStatus(payment.status)}</span></td>
                <td>
                    <button class="btn-primary" onclick="viewPaymentDetails('${payment.id}')">View</button>
                    <button class="btn-success" onclick="editPayment('${payment.id}')" style="margin-left: 5px;">Edit</button>
                    <button class="btn-danger" onclick="deletePayment('${payment.id}')" style="margin-left: 5px;">Delete</button>
                </td>
            `;
            paymentsTableBody.appendChild(row);
        });
        
        updatePaginationInfo(dataToDisplay.length);
        updatePaymentCharts(dataToDisplay);
    }
    
    function formatDate(dateString) {
        const options = { year: 'numeric', month: 'short', day: 'numeric' };
        return new Date(dateString).toLocaleDateString('en-US', options);
    }
    
    function formatMethod(method) {
        const methods = {
            'cash': 'Cash',
            'bank_transfer': 'Bank Transfer',
            'credit': 'Credit Card',
            'upi': 'UPI',
            'other': 'Other'
        };
        return methods[method] || method;
    }
    
    function formatStatus(status) {
        const statuses = {
            'completed': 'Paid',
            'pending': 'Pending',
            'failed': 'Failed'
        };
        return statuses[status] || status;
    }
    
    function getStatusClass(status) {
        const classes = {
            'completed': 'completed',
            'pending': 'pending',
            'failed': 'pending'
        };
        return classes[status] || '';
    }
    
    function updatePaginationInfo(totalItems) {
        const startItem = ((currentPage - 1) * itemsPerPage) + 1;
        const endItem = Math.min(currentPage * itemsPerPage, totalItems);
        
        paymentPaginationInfo.textContent = `Showing ${startItem} to ${endItem} of ${totalItems} payments`;
        
        prevPaymentPage.disabled = currentPage === 1;
        nextPaymentPage.disabled = currentPage * itemsPerPage >= totalItems;
    }
    
    function goToPrevPage() {
        if (currentPage > 1) {
            currentPage--;
            loadPayments();
        }
    }
    
    function goToNextPage() {
        if (currentPage * itemsPerPage < payments.length) {
            currentPage++;
            loadPayments();
        }
    }
    
    function showAddPaymentForm() {
        addPaymentForm.style.display = 'block';
        addPaymentBtn.style.display = 'none';
        
        // Reset form and generate new ID
        paymentForm.reset();
        document.getElementById('paymentDate').valueAsDate = new Date();
    }
    
    function hideAddPaymentForm() {
        addPaymentForm.style.display = 'none';
        addPaymentBtn.style.display = 'inline-block';
    }
    
    function savePayment(e) {
        e.preventDefault();
        
        const paymentId = 'PAY-' + Date.now().toString().slice(-6);
        const paymentDate = document.getElementById('paymentDate').value;
        const paymentRecipient = document.getElementById('paymentRecipient').value;
        const paymentRecipientId = document.getElementById('paymentRecipientId').value;
        const paymentAmount = parseFloat(document.getElementById('paymentAmount').value);
        const paymentMethod = document.getElementById('paymentMethod').value;
        const paymentReference = document.getElementById('paymentReference').value;
        const paymentStatus = document.getElementById('paymentStatus').value;
        
        const newPayment = {
            id: paymentId,
            date: paymentDate,
            recipientType: paymentRecipient,
            recipient: paymentRecipientId,
            amount: paymentAmount,
            method: paymentMethod,
            reference: paymentReference,
            status: paymentStatus,
            createdAt: new Date().toISOString()
        };
        
        payments.unshift(newPayment);
        saveToLocalStorage();
        loadPayments();
        updatePaymentStats();
        hideAddPaymentForm();
        
        // Show success message
        alert('Payment saved successfully!');
    }
    
    function editPayment(paymentId) {
        const payment = payments.find(p => p.id === paymentId);
        if (!payment) return;
        
        // Fill the edit form
        document.getElementById('editPaymentId').value = payment.id;
        document.getElementById('editPaymentDate').value = payment.date;
        document.getElementById('editPaymentRecipient').value = payment.recipientType;
        document.getElementById('editPaymentRecipientId').value = payment.recipient;
        document.getElementById('editPaymentAmount').value = payment.amount;
        document.getElementById('editPaymentMethod').value = payment.method;
        document.getElementById('editPaymentReference').value = payment.reference;
        document.getElementById('editPaymentStatus').value = payment.status;
        
        // Show the modal
        editPaymentModal.style.display = 'flex';
    }
    
    function closeEditPaymentModal() {
        editPaymentModal.style.display = 'none';
    }
    
    // Add event listener for edit form submission
    editPaymentForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const paymentId = document.getElementById('editPaymentId').value;
        const paymentIndex = payments.findIndex(p => p.id === paymentId);
        
        if (paymentIndex === -1) return;
        
        // Update the payment
        payments[paymentIndex] = {
            ...payments[paymentIndex],
            date: document.getElementById('editPaymentDate').value,
            recipientType: document.getElementById('editPaymentRecipient').value,
            recipient: document.getElementById('editPaymentRecipientId').value,
            amount: parseFloat(document.getElementById('editPaymentAmount').value),
            method: document.getElementById('editPaymentMethod').value,
            reference: document.getElementById('editPaymentReference').value,
            status: document.getElementById('editPaymentStatus').value,
            updatedAt: new Date().toISOString()
        };
        
        saveToLocalStorage();
        loadPayments();
        updatePaymentStats();
        closeEditPaymentModal();
        
        // Show success message
        alert('Payment updated successfully!');
    });
    
    function deletePayment(paymentId) {
        if (confirm('Are you sure you want to delete this payment?')) {
            payments = payments.filter(p => p.id !== paymentId);
            saveToLocalStorage();
            loadPayments();
            updatePaymentStats();
            
            // Show success message
            alert('Payment deleted successfully!');
        }
    }
    
    function viewPaymentDetails(paymentId) {
        const payment = payments.find(p => p.id === paymentId);
        if (!payment) return;
        
        // In a real app, you might show a modal with more details
        alert(`Payment Details:\n
ID: ${payment.id}
Date: ${formatDate(payment.date)}
Recipient: ${payment.recipient} (${payment.recipientType})
Amount: ₹${payment.amount.toFixed(2)}
Method: ${formatMethod(payment.method)}
Status: ${formatStatus(payment.status)}
Reference: ${payment.reference || 'N/A'}`);
    }
    
    function filterPayments() {
        const searchTerm = paymentSearch.value.toLowerCase();
        const statusFilter = paymentFilter.value;
        const dateFilter = paymentDateFilter.value;
        
        let filtered = payments;
        
        // Apply search filter
        if (searchTerm) {
            filtered = filtered.filter(payment => 
                payment.id.toLowerCase().includes(searchTerm) ||
                payment.recipient.toLowerCase().includes(searchTerm) ||
                payment.reference?.toLowerCase().includes(searchTerm) ||
                payment.amount.toString().includes(searchTerm)
            );
        }
        
        // Apply status filter
        if (statusFilter !== 'all') {
            filtered = filtered.filter(payment => payment.status === statusFilter);
        }
        
        // Apply date filter
        if (dateFilter) {
            filtered = filtered.filter(payment => payment.date === dateFilter);
        }
        
        // Reset to first page when filtering
        currentPage = 1;
        loadPayments(filtered);
    }
    
    function resetFilters() {
        paymentSearch.value = '';
        paymentFilter.value = 'all';
        paymentDateFilter.value = '';
        currentPage = 1;
        loadPayments();
    }
    
    function saveToLocalStorage() {
        localStorage.setItem('payments', JSON.stringify(payments));
    }
    
    function updatePaymentStats() {
        // Total payments value
        const totalAmount = payments.reduce((sum, payment) => sum + payment.amount, 0);
        totalPaymentsValue.textContent = `₹${totalAmount.toFixed(2)}`;
        
        // Pending payments
        const pendingPayments = payments.filter(p => p.status === 'pending');
        const pendingAmount = pendingPayments.reduce((sum, payment) => sum + payment.amount, 0);
        pendingPaymentsValue.textContent = `₹${pendingAmount.toFixed(2)}`;
        
        // Average payment
        const avgPayment = payments.length > 0 ? totalAmount / payments.length : 0;
        avgPaymentValue.textContent = `₹${avgPayment.toFixed(2)}`;
        
        // Change indicators (simplified for demo)
        paymentChange.textContent = payments.length > 0 ? '5.7%' : '0%';
        pendingChange.textContent = pendingPayments.length > 0 ? pendingPayments.length : '0';
        avgPaymentChange.textContent = payments.length > 0 ? '2.3%' : '0%';
    }
    
    function initPaymentCharts() {
        // Initialize charts with empty data
        const ctx1 = document.getElementById('totalPaymentsChart').getContext('2d');
        const ctx2 = document.getElementById('pendingPaymentsChart').getContext('2d');
        const ctx3 = document.getElementById('avgPaymentChart').getContext('2d');
        const ctx4 = document.getElementById('paymentTrendChart').getContext('2d');
        
        window.totalPaymentsChart = new Chart(ctx1, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'Total Payments',
                    data: [],
                    borderColor: '#0077b6',
                    tension: 0.1,
                    fill: true,
                    backgroundColor: 'rgba(0, 119, 182, 0.1)'
                }]
            },
            options: getChartOptions('Total Payments Trend')
        });
        
        window.pendingPaymentsChart = new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'Pending Payments',
                    data: [],
                    backgroundColor: '#e76f51'
                }]
            },
            options: getChartOptions('Pending Payments')
        });
        
        window.avgPaymentChart = new Chart(ctx3, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'Average Payment',
                    data: [],
                    borderColor: '#2a9d8f',
                    tension: 0.1,
                    fill: true,
                    backgroundColor: 'rgba(42, 157, 143, 0.1)'
                }]
            },
            options: getChartOptions('Average Payment Amount')
        });
        
        window.paymentTrendChart = new Chart(ctx4, {
            type: 'bar',
            data: {
                labels: ['Completed', 'Pending', 'Failed'],
                datasets: [{
                    label: 'Payment Status',
                    data: [],
                    backgroundColor: [
                        'rgba(42, 157, 143, 0.7)',
                        'rgba(231, 111, 81, 0.7)',
                        'rgba(173, 181, 189, 0.7)'
                    ]
                }]
            },
            options: getChartOptions('Payment Status Distribution')
        });
    }
    
    function updatePaymentCharts(data) {
        // For demo purposes, we'll generate some random data based on the actual data length
        const baseValue = data.length > 0 ? data.length * 1000 : 1000;
        
        // Update total payments chart
        window.totalPaymentsChart.data.datasets[0].data = [
            baseValue * 0.8,
            baseValue * 0.9,
            baseValue * 1.1,
            baseValue * 1.3,
            baseValue * 1.2,
            baseValue * 1.4
        ];
        window.totalPaymentsChart.update();
        
        // Update pending payments chart
        const pendingCount = data.filter(p => p.status === 'pending').length;
        window.pendingPaymentsChart.data.datasets[0].data = [
            pendingCount * 0.7,
            pendingCount * 0.9,
            pendingCount * 1.2,
            pendingCount * 1.0,
            pendingCount * 0.8,
            pendingCount
        ];
        window.pendingPaymentsChart.update();
        
        // Update average payment chart
        const avgPayment = data.length > 0 ? 
            data.reduce((sum, p) => sum + p.amount, 0) / data.length : 0;
        window.avgPaymentChart.data.datasets[0].data = [
            avgPayment * 0.9,
            avgPayment * 0.95,
            avgPayment * 1.05,
            avgPayment * 1.1,
            avgPayment * 1.0,
            avgPayment
        ];
        window.avgPaymentChart.update();
        
        // Update payment trend chart
        const completedCount = data.filter(p => p.status === 'completed').length;
        const failedCount = data.filter(p => p.status === 'failed').length;
        window.paymentTrendChart.data.datasets[0].data = [
            completedCount,
            pendingCount,
            failedCount
        ];
        window.paymentTrendChart.update();
    }
    
    function getChartOptions(title) {
        return {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: title
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        };
    }
    
    function exportPaymentsToPDF() {
        // In a real app, you would use jsPDF to generate a PDF
        alert('PDF export functionality would be implemented here. For now, showing data in console.');
        console.log('Payments data:', payments);
        
        // This is a simplified example using jsPDF (would need to include the library)
        if (typeof jsPDF !== 'undefined') {
            const doc = new jsPDF();
            doc.text('Payments Report', 10, 10);
            
            let y = 20;
            payments.forEach(payment => {
                doc.text(`${payment.id} - ${payment.recipient}: ₹${payment.amount.toFixed(2)} (${formatStatus(payment.status)})`, 10, y);
                y += 10;
                if (y > 280) {
                    doc.addPage();
                    y = 20;
                }
            });
            
            doc.save('payments_report.pdf');
        } else {
            alert('jsPDF library not loaded. PDF export not available.');
        }
    }
    
    function generateInvoice() {
        // In a real app, you would generate an invoice for selected payment
        alert('Invoice generation functionality would be implemented here.');
    }
    
    // Make functions available globally for inline event handlers
    window.viewPaymentDetails = viewPaymentDetails;
    window.editPayment = editPayment;
    window.deletePayment = deletePayment;
    window.closeEditPaymentModal = closeEditPaymentModal;
});

// Sample data initialization if localStorage is empty
function initializeSamplePayments() {
    if (!localStorage.getItem('payments')) {
        const samplePayments = [
            {
                id: 'PAY-1001',
                date: '2023-06-15',
                recipientType: 'farmer',
                recipient: 'Rajesh Patel (F-10045)',
                amount: 12500,
                method: 'bank_transfer',
                reference: 'INV-2023-06-15',
                status: 'completed',
                createdAt: '2023-06-15T10:30:00Z'
            },
            {
                id: 'PAY-1002',
                date: '2023-06-14',
                recipientType: 'supplier',
                recipient: 'Milk Packaging Inc.',
                amount: 18500,
                method: 'credit',
                reference: 'INV-SUP-0614',
                status: 'completed',
                createdAt: '2023-06-14T14:15:00Z'
            },
            {
                id: 'PAY-1003',
                date: '2023-06-10',
                recipientType: 'employee',
                recipient: 'Sunil Sharma (EMP-1003)',
                amount: 25000,
                method: 'bank_transfer',
                reference: 'SAL-JUN-1003',
                status: 'completed',
                createdAt: '2023-06-10T09:00:00Z'
            },
            {
                id: 'PAY-1004',
                date: '2023-06-08',
                recipientType: 'farmer',
                recipient: 'Priya Sharma (F-10044)',
                amount: 9800,
                method: 'upi',
                reference: 'INV-2023-06-08',
                status: 'completed',
                createdAt: '2023-06-08T11:45:00Z'
            },
            {
                id: 'PAY-1005',
                date: '2023-06-05',
                recipientType: 'supplier',
                recipient: 'Dairy Equipment Co.',
                amount: 42500,
                method: 'bank_transfer',
                reference: 'INV-EQP-0605',
                status: 'completed',
                createdAt: '2023-06-05T16:20:00Z'
            },
            {
                id: 'PAY-1006',
                date: '2023-06-16',
                recipientType: 'farmer',
                recipient: 'Vijay Singh (F-10043)',
                amount: 15200,
                method: 'cash',
                reference: '',
                status: 'pending',
                createdAt: '2023-06-16T09:30:00Z'
            },
            {
                id: 'PAY-1007',
                date: '2023-06-12',
                recipientType: 'other',
                recipient: 'Office Maintenance',
                amount: 7500,
                method: 'cash',
                reference: 'MAINT-JUN',
                status: 'completed',
                createdAt: '2023-06-12T13:10:00Z'
            }
        ];
        
        localStorage.setItem('payments', JSON.stringify(samplePayments));
    }
}

// Initialize sample data when the page loads
initializeSamplePayments();
                </script>

                <script>
                    // Initialize charts when the section is loaded
                    function initFleetManagementCharts() {
                        // Total Vehicles Chart
                        const totalVehiclesCtx = document.getElementById('totalVehiclesChart').getContext('2d');
                        new Chart(totalVehiclesCtx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    label: 'Total Vehicles',
                                    data: [38, 39, 40, 40, 41, 42],
                                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                    borderColor: 'rgba(54, 162, 235, 1)',
                                    borderWidth: 2,
                                    tension: 0.1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: { display: false }
                                },
                                scales: {
                                    y: { beginAtZero: false }
                                }
                            }
                        });

                        // Active Vehicles Chart
                        const activeVehiclesCtx = document.getElementById('activeVehiclesChart').getContext('2d');
                        new Chart(activeVehiclesCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    label: 'Active Vehicles',
                                    data: [34, 35, 35, 36, 36, 36],
                                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                    borderColor: 'rgba(75, 192, 192, 1)',
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: { display: false }
                                },
                                scales: {
                                    y: { beginAtZero: false }
                                }
                            }
                        });

                        // Utilization Rate Chart
                        const utilizationCtx = document.getElementById('utilizationRateChart').getContext('2d');
                        new Chart(utilizationCtx, {
                            type: 'line',
                            data: {
                                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                                datasets: [{
                                    label: 'Utilization Rate (%)',
                                    data: [78, 82, 85, 81],
                                    backgroundColor: 'rgba(153, 102, 255, 0.2)',
                                    borderColor: 'rgba(153, 102, 255, 1)',
                                    borderWidth: 2,
                                    tension: 0.1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: { display: false }
                                }
                            }
                        });

                        // Distance Covered Chart
                        const distanceCtx = document.getElementById('distanceCoveredChart').getContext('2d');
                        new Chart(distanceCtx, {
                            type: 'bar',
                            data: {
                                labels: ['Trucks', 'Vans', 'Pickups', 'Tankers'],
                                datasets: [{
                                    label: 'Avg. Monthly Distance (km)',
                                    data: [4500, 3200, 1800, 3800],
                                    backgroundColor: [
                                        'rgba(255, 99, 132, 0.2)',
                                        'rgba(54, 162, 235, 0.2)',
                                        'rgba(255, 206, 86, 0.2)',
                                        'rgba(75, 192, 192, 0.2)'
                                    ],
                                    borderColor: [
                                        'rgba(255, 99, 132, 1)',
                                        'rgba(54, 162, 235, 1)',
                                        'rgba(255, 206, 86, 1)',
                                        'rgba(75, 192, 192, 1)'
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: { display: false }
                                }
                            }
                        });
                    }

                    // Form validation functions
                    function validateVehicleForm() {
                        const regNumber = document.getElementById('registrationNumber').value;
                        const chassisNumber = document.getElementById('chassisNumber').value;
                        const purchaseDate = new Date(document.getElementById('purchaseDate').value);
                        const today = new Date();

                        // Validate registration number format (GJ-01-AB-1234)
                        const regNumberRegex = /^[A-Za-z]{2}-[0-9]{1,2}-[A-Za-z]{1,2}-[0-9]{4}$/;
                        if (!regNumberRegex.test(regNumber)) {
                            alert('Please enter a valid registration number (e.g., GJ-01-AB-1234)');
                            return false;
                        }

                        // Validate chassis number length (17 characters)
                        if (chassisNumber.length !== 17) {
                            alert('Chassis number must be exactly 17 characters long');
                            return false;
                        }

                        // Validate purchase date (not in future)
                        if (purchaseDate > today) {
                            alert('Purchase date cannot be in the future');
                            return false;
                        }

                        // Validate current value <= purchase cost
                        const purchaseCost = parseFloat(document.getElementById('purchaseCost').value);
                        const currentValue = parseFloat(document.getElementById('currentValue').value);
                        if (currentValue > purchaseCost) {
                            alert('Current value cannot be greater than purchase cost');
                            return false;
                        }

                        return true;
                    }

                    function validateDriverForm() {
                        const licenseNumber = document.getElementById('driverLicense').value;
                        const contactNumber = document.getElementById('driverContact').value;
                        const emergencyContact = document.getElementById('driverEmergencyContact').value;
                        const dob = new Date(document.getElementById('driverDob').value);
                        const joiningDate = new Date(document.getElementById('driverJoiningDate').value);
                        const today = new Date();

                        // Validate license number length (15-20 characters)
                        if (licenseNumber.length < 15 || licenseNumber.length > 20) {
                            alert('License number must be between 15-20 characters');
                            return false;
                        }

                        // Validate contact numbers (10 digits)
                        const phoneRegex = /^[0-9]{10}$/;
                        if (!phoneRegex.test(contactNumber)) {
                            alert('Please enter a valid 10-digit contact number');
                            return false;
                        }
                        if (!phoneRegex.test(emergencyContact)) {
                            alert('Please enter a valid 10-digit emergency contact number');
                            return false;
                        }

                        // Validate date of birth (at least 18 years old)
                        const minDob = new Date();
                        minDob.setFullYear(minDob.getFullYear() - 18);
                        if (dob > minDob) {
                            alert('Driver must be at least 18 years old');
                            return false;
                        }

                        // Validate joining date (not in future)
                        if (joiningDate > today) {
                            alert('Joining date cannot be in the future');
                            return false;
                        }

                        return true;
                    }

                    // Show/hide forms
                    document.getElementById('addVehicleBtn').addEventListener('click', function () {
                        document.getElementById('addVehicleForm').style.display = 'block';
                        document.getElementById('vehicleForm').reset();
                    });

                    document.getElementById('cancelVehicleForm').addEventListener('click', function () {
                        document.getElementById('addVehicleForm').style.display = 'none';
                    });

                    document.getElementById('addDriverBtn').addEventListener('click', function () {
                        document.getElementById('addDriverForm').style.display = 'block';
                        document.getElementById('driverForm').reset();
                    });

                    document.getElementById('closeDriverForm').addEventListener('click', function () {
                        document.getElementById('addDriverForm').style.display = 'none';
                    });

                    document.getElementById('cancelDriverForm').addEventListener('click', function () {
                        document.getElementById('addDriverForm').style.display = 'none';
                    });

                    // Vehicle modal functions
                    function viewVehicleDetails(vehicleId) {
                        // In a real application, you would fetch this data from an API
                        const vehicleData = {
                            'VH-1001': {
                                id: 'VH-1001',
                                regNumber: 'GJ-01-AB-1234',
                                type: 'Refrigerated Truck',
                                make: 'Tata',
                                model: 'Ultra 1518',
                                year: 2020,
                                capacity: '8,000 kg',
                                chassis: 'MAJ3P2B3X4D123456',
                                engine: '4SPCRS3X4D789012',
                                fuelType: 'Diesel',
                                purchaseDate: '2020-03-15',
                                purchaseCost: '₹1,850,000',
                                currentValue: '₹1,200,000',
                                insurance: 'ICICI456789 (exp 2024-03-14)',
                                fitnessExpiry: '2025-03-14',
                                permitExpiry: '2025-03-14',
                                driver: 'Rajesh Patel (DR-1001)',
                                status: 'Active',
                                notes: 'Regularly used for long-distance milk transport. Requires frequent refrigeration unit maintenance.'
                            },
                            // Add data for other vehicles similarly
                        };

                        const vehicle = vehicleData[vehicleId] || {
                            id: vehicleId,
                            regNumber: 'N/A',
                            type: 'Unknown',
                            make: 'Unknown',
                            model: 'Unknown',
                            year: 'Unknown',
                            capacity: 'Unknown',
                            chassis: 'Unknown',
                            engine: 'Unknown',
                            fuelType: 'Unknown',
                            purchaseDate: 'Unknown',
                            purchaseCost: 'Unknown',
                            currentValue: 'Unknown',
                            insurance: 'Unknown',
                            fitnessExpiry: 'Unknown',
                            permitExpiry: 'Unknown',
                            driver: 'None',
                            status: 'Unknown',
                            notes: 'No information available'
                        };

                        document.getElementById('modalVehicleTitle').textContent = `Vehicle ${vehicle.id} Details`;

                        const content = `
        <div class="vehicle-details-grid">
            <div><strong>Registration:</strong> ${vehicle.regNumber}</div>
            <div><strong>Type:</strong> ${vehicle.type}</div>
            <div><strong>Make/Model:</strong> ${vehicle.make} ${vehicle.model}</div>
            <div><strong>Year:</strong> ${vehicle.year}</div>
            <div><strong>Capacity:</strong> ${vehicle.capacity}</div>
            <div><strong>Chassis:</strong> ${vehicle.chassis}</div>
            <div><strong>Engine:</strong> ${vehicle.engine}</div>
            <div><strong>Fuel Type:</strong> ${vehicle.fuelType}</div>
            <div><strong>Purchase Date:</strong> ${vehicle.purchaseDate}</div>
            <div><strong>Purchase Cost:</strong> ${vehicle.purchaseCost}</div>
            <div><strong>Current Value:</strong> ${vehicle.currentValue}</div>
            <div><strong>Insurance:</strong> ${vehicle.insurance}</div>
            <div><strong>Fitness Expiry:</strong> ${vehicle.fitnessExpiry}</div>
            <div><strong>Permit Expiry:</strong> ${vehicle.permitExpiry}</div>
            <div><strong>Assigned Driver:</strong> ${vehicle.driver}</div>
            <div><strong>Status:</strong> <span class="status completed">${vehicle.status}</span></div>
            <div><strong>Notes:</strong> ${vehicle.notes}</div>
        </div>
        
        <div style="margin-top: 20px;">
            <h3>Maintenance History</h3>
            <table class="recent-orders">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Service Type</th>
                        <th>Odometer</th>
                        <th>Cost</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>2023-06-12</td>
                        <td>Brake Replacement</td>
                        <td>62,300 km</td>
                        <td>₹12,000</td>
                        <td>All brake pads replaced</td>
                    </tr>
                    <tr>
                        <td>2023-03-10</td>
                        <td>Oil Change</td>
                        <td>58,000 km</td>
                        <td>₹5,500</td>
                        <td>Full service with oil change</td>
                    </tr>
                    <tr>
                        <td>2022-12-05</td>
                        <td>Tire Rotation</td>
                        <td>52,400 km</td>
                        <td>₹3,200</td>
                        <td>Rotated all tires</td>
                    </tr>
                </tbody>
            </table>
        </div>
    `;

                        document.getElementById('vehicleDetailsContent').innerHTML = content;
                        document.getElementById('vehicleDetailsModal').style.display = 'flex';
                    }

                    function closeVehicleModal() {
                        document.getElementById('vehicleDetailsModal').style.display = 'none';
                    }

                    function editVehicle(vehicleId) {
                        // In a real application, you would fetch the vehicle data and populate the form
                        alert(`Edit vehicle ${vehicleId} - this would open the edit form with pre-filled data`);
                        // For demo purposes, we'll just show the add vehicle form
                        document.getElementById('addVehicleForm').style.display = 'block';
                    }

                    // Initialize charts when the fleet management section is shown
                    document.getElementById('fleet-management-section').addEventListener('show', function () {
                        initFleetManagementCharts();
                    });

                    // Search functionality for vehicle table
                    document.getElementById('vehicleSearch').addEventListener('input', function (e) {
                        const searchTerm = e.target.value.toLowerCase();
                        const rows = document.querySelectorAll('#vehiclesTable tbody tr');

                        rows.forEach(row => {
                            const text = row.textContent.toLowerCase();
                            row.style.display = text.includes(searchTerm) ? '' : 'none';
                        });
                    });

                    // Filter functionality for vehicle table
                    document.getElementById('vehicleFilter').addEventListener('change', function (e) {
                        const filterValue = e.target.value;
                        const rows = document.querySelectorAll('#vehiclesTable tbody tr');

                        rows.forEach(row => {
                            if (filterValue === 'all') {
                                row.style.display = '';
                                return;
                            }

                            const status = row.querySelector('.status').textContent.toLowerCase();
                            const type = row.cells[2].textContent.toLowerCase();

                            if (filterValue === 'active' && status === 'active') {
                                row.style.display = '';
                            } else if (filterValue === 'maintenance' && (status === 'maintenance' || status === 'scheduled service')) {
                                row.style.display = '';
                            } else if (filterValue === 'truck' && type.includes('truck')) {
                                row.style.display = '';
                            } else if (filterValue === 'van' && type.includes('van')) {
                                row.style.display = '';
                            } else if (filterValue === 'refrigerated' && type.includes('refrigerated')) {
                                row.style.display = '';
                            } else {
                                row.style.display = 'none';
                            }
                        });
                    });
                </script>

                <script>
                    // Profile Section JavaScript
                    document.addEventListener('DOMContentLoaded', function () {
                        // Initialize profile data
                        loadProfileData();

                        // Set up event listeners for profile section
                        document.getElementById('editProfileBtn').addEventListener('click', enableProfileEditing);
                        document.getElementById('saveProfileBtn').addEventListener('click', saveProfile);
                        document.getElementById('cancelEditBtn').addEventListener('click', cancelProfileEditing);
                        document.getElementById('changeAvatarBtn').addEventListener('click', function (e) {
                            e.preventDefault();
                            document.getElementById('avatarInput').click();
                        });
                        document.getElementById('avatarInput').addEventListener('change', handleAvatarUpload);

                        // Initialize delivery schedule
                        loadDeliveries();

                        // Set up event listeners for delivery section
                        document.getElementById('addDeliveryBtn').addEventListener('click', showAddDeliveryForm);
                        document.getElementById('saveDeliveryBtn').addEventListener('click', saveDelivery);
                        document.getElementById('cancelDeliveryBtn').addEventListener('click', hideAddDeliveryForm);
                        document.getElementById('exportPdfBtn').addEventListener('click', exportDeliveryToPDF);
                        document.getElementById('printScheduleBtn').addEventListener('click', printDeliverySchedule);

                        // Initialize payment methods
                        loadPayments();

                        // Set up event listeners for payment section
                        document.getElementById('addPaymentBtn').addEventListener('click', showAddPaymentForm);
                        document.getElementById('savePaymentBtn').addEventListener('click', savePayment);
                        document.getElementById('cancelPaymentBtn').addEventListener('click', hideAddPaymentForm);
                        document.getElementById('exportPaymentPdfBtn').addEventListener('click', exportPaymentsToPDF);
                        document.getElementById('generateInvoiceBtn').addEventListener('click', generateInvoice);
                    });

                    // Profile Functions
                    function loadProfileData() {
                        const profileData = JSON.parse(localStorage.getItem('userProfile')) || {
                            fullName: 'D. JOY',
                            phone: '+91',
                            email: '',
                            address: ''
                        };

                        document.getElementById('fullName').value = profileData.fullName;
                        document.getElementById('phone').value = profileData.phone;
                        document.getElementById('email').value = profileData.email;
                        document.getElementById('address').value = profileData.address;

                        // Update avatar initials
                        const names = profileData.fullName.split(' ');
                        const initials = names[0].charAt(0) + (names.length > 1 ? names[names.length - 1].charAt(0) : '');
                        document.getElementById('avatarDisplay').textContent = initials;

                        // Update avatar image if exists
                        if (profileData.avatar) {
                            document.getElementById('avatarDisplay').style.backgroundImage = `url(${profileData.avatar})`;
                            document.getElementById('avatarDisplay').style.backgroundSize = 'cover';
                            document.getElementById('avatarDisplay').textContent = '';
                        }
                    }

                    function enableProfileEditing() {
                        const inputs = document.querySelectorAll('#profileForm input, #profileForm textarea');
                        inputs.forEach(input => {
                            input.readOnly = false;
                            input.style.backgroundColor = 'white';
                            input.style.border = '1px solid var(--primary)';
                        });

                        document.getElementById('formActions').style.display = 'block';
                        document.getElementById('editProfileBtn').style.display = 'none';
                    }

                    function cancelProfileEditing() {
                        const inputs = document.querySelectorAll('#profileForm input, #profileForm textarea');
                        inputs.forEach(input => {
                            input.readOnly = true;
                            input.style.backgroundColor = '';
                            input.style.border = '1px solid var(--dark)';
                        });

                        document.getElementById('formActions').style.display = 'none';
                        document.getElementById('editProfileBtn').style.display = 'block';

                        // Reload original data
                        loadProfileData();
                    }

                    function saveProfile() {
                        const profileData = {
                            fullName: document.getElementById('fullName').value,
                            phone: document.getElementById('phone').value,
                            email: document.getElementById('email').value,
                            address: document.getElementById('address').value,
                            avatar: localStorage.getItem('userAvatar') || ''
                        };

                        localStorage.setItem('userProfile', JSON.stringify(profileData));

                        // Update avatar initials
                        const names = profileData.fullName.split(' ');
                        const initials = names[0].charAt(0) + (names.length > 1 ? names[names.length - 1].charAt(0) : '');
                        document.getElementById('avatarDisplay').textContent = initials;

                        // Disable editing
                        cancelProfileEditing();

                        alert('Profile saved successfully!');
                    }

                    function handleAvatarUpload(event) {
                        const file = event.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = function (e) {
                                const avatarDisplay = document.getElementById('avatarDisplay');
                                avatarDisplay.style.backgroundImage = `url(${e.target.result})`;
                                avatarDisplay.style.backgroundSize = 'cover';
                                avatarDisplay.textContent = '';

                                // Save to localStorage
                                localStorage.setItem('userAvatar', e.target.result);

                                // Update profile data
                                const profileData = JSON.parse(localStorage.getItem('userProfile')) || {};
                                profileData.avatar = e.target.result;
                                localStorage.setItem('userProfile', JSON.stringify(profileData));
                            };
                            reader.readAsDataURL(file);
                        }
                    }

                    // Delivery Schedule Functions
                    function loadDeliveries() {
                        const deliveries = JSON.parse(localStorage.getItem('deliveries')) || [
                            {
                                id: 'DL-2023-105',
                                date: '2023-05-15T09:00',
                                customer: 'John Smith\n123 Market St',
                                products: 'Standard Milk, Paneer',
                                quantity: '20L, 2kg',
                                status: 'completed'
                            },
                            {
                                id: 'DL-2023-104',
                                date: '2023-05-14T10:30',
                                customer: 'Sarah Johnson\n456 Dairy Lane',
                                products: 'Toned Milk, Ghee',
                                quantity: '15L, 1kg',
                                status: 'completed'
                            },
                            {
                                id: 'DL-2023-103',
                                date: '2023-05-13T11:00',
                                customer: 'Robert Williams\n789 Farm Rd',
                                products: 'Standard Milk, Curd',
                                quantity: '25L, 5kg',
                                status: 'completed'
                            },
                            {
                                id: 'DL-2023-106',
                                date: '2023-05-16T08:00',
                                customer: 'Emily Brown\n321 Cream Ave',
                                products: 'Toned Milk, Paneer, Ghee',
                                quantity: '30L, 3kg, 2kg',
                                status: 'scheduled'
                            }
                        ];

                        const tbody = document.getElementById('deliveryTableBody');
                        tbody.innerHTML = '';

                        deliveries.forEach(delivery => {
                            const row = document.createElement('tr');

                            // Format date for display
                            const dateObj = new Date(delivery.date);
                            const formattedDate = dateObj.toLocaleDateString() + '<br>' + dateObj.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                            // Get status badge class
                            const statusClass = delivery.status === 'completed' ? 'completed' :
                                delivery.status === 'scheduled' ? 'scheduled' : 'pending';

                            row.innerHTML = `
            <td>${delivery.id}</td>
            <td>${formattedDate}</td>
            <td>${delivery.customer}</td>
            <td>${delivery.products}</td>
            <td>${delivery.quantity}</td>
            <td><span class="status ${statusClass}">${delivery.status.charAt(0).toUpperCase() + delivery.status.slice(1)}</span></td>
            <td>
                <button class="btn-primary view-delivery" data-id="${delivery.id}">View Details</button>
                ${delivery.status === 'scheduled' ?
                                    `<button class="btn-warning reschedule-delivery" data-id="${delivery.id}" style="margin-left: 5px;">Reschedule</button>
                     <button class="btn-danger cancel-delivery" data-id="${delivery.id}" style="margin-left: 5px;">Cancel</button>` : ''}
            </td>
        `;

                            tbody.appendChild(row);
                        });

                        // Add event listeners to action buttons
                        document.querySelectorAll('.view-delivery').forEach(btn => {
                            btn.addEventListener('click', function () {
                                viewDeliveryDetails(this.getAttribute('data-id'));
                            });
                        });

                        document.querySelectorAll('.reschedule-delivery').forEach(btn => {
                            btn.addEventListener('click', function () {
                                rescheduleDelivery(this.getAttribute('data-id'));
                            });
                        });

                        document.querySelectorAll('.cancel-delivery').forEach(btn => {
                            btn.addEventListener('click', function () {
                                cancelDelivery(this.getAttribute('data-id'));
                            });
                        });
                    }

                    function showAddDeliveryForm() {
                        document.getElementById('addDeliveryForm').style.display = 'block';
                        document.getElementById('deliveryID').value = 'DL-' + new Date().getFullYear() + '-' + Math.floor(100 + Math.random() * 900);
                        document.getElementById('deliveryDate').valueAsDate = new Date();
                    }

                    function hideAddDeliveryForm() {
                        document.getElementById('addDeliveryForm').style.display = 'none';
                        document.getElementById('addDeliveryForm').reset();
                    }

                    function saveDelivery() {
                        const delivery = {
                            id: document.getElementById('deliveryID').value,
                            date: document.getElementById('deliveryDate').value,
                            customer: document.getElementById('customer').value,
                            products: document.getElementById('products').value,
                            quantity: document.getElementById('quantity').value,
                            status: document.getElementById('status').value
                        };

                        if (!delivery.customer || !delivery.products || !delivery.quantity) {
                            alert('Please fill in all required fields');
                            return;
                        }

                        const deliveries = JSON.parse(localStorage.getItem('deliveries')) || [];
                        deliveries.push(delivery);
                        localStorage.setItem('deliveries', JSON.stringify(deliveries));

                        loadDeliveries();
                        hideAddDeliveryForm();
                    }

                    function viewDeliveryDetails(deliveryId) {
                        const deliveries = JSON.parse(localStorage.getItem('deliveries'));
                        const delivery = deliveries.find(d => d.id === deliveryId);

                        if (delivery) {
                            alert(`Delivery Details:\n\nID: ${delivery.id}\nDate: ${new Date(delivery.date).toLocaleString()}\nCustomer: ${delivery.customer}\nProducts: ${delivery.products}\nQuantity: ${delivery.quantity}\nStatus: ${delivery.status}`);
                        }
                    }

                    function rescheduleDelivery(deliveryId) {
                        const deliveries = JSON.parse(localStorage.getItem('deliveries'));
                        const delivery = deliveries.find(d => d.id === deliveryId);

                        if (delivery) {
                            const newDate = prompt('Enter new date and time (YYYY-MM-DDTHH:MM):', delivery.date);
                            if (newDate) {
                                delivery.date = newDate;
                                localStorage.setItem('deliveries', JSON.stringify(deliveries));
                                loadDeliveries();
                            }
                        }
                    }

                    function cancelDelivery(deliveryId) {
                        if (confirm('Are you sure you want to cancel this delivery?')) {
                            const deliveries = JSON.parse(localStorage.getItem('deliveries'));
                            const updatedDeliveries = deliveries.filter(d => d.id !== deliveryId);
                            localStorage.setItem('deliveries', JSON.stringify(updatedDeliveries));
                            loadDeliveries();
                        }
                    }

                    function exportDeliveryToPDF() {
                        const deliveryTable = document.getElementById('deliveryTable');

                        html2canvas(deliveryTable).then(canvas => {
                            const imgData = canvas.toDataURL('image/png');
                            const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
                            const pageWidth = pdf.internal.pageSize.getWidth();
                            const imgProps = pdf.getImageProperties(imgData);
                            const pdfWidth = pageWidth;
                            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

                            pdf.addImage(imgData, 'PNG', 0, 10, pdfWidth, pdfHeight);
                            pdf.save('delivery-schedule.pdf');
                        });
                    }

                    function printDeliverySchedule() {
                        const printContent = document.getElementById('deliveryTable').outerHTML;
                        const originalContent = document.body.innerHTML;

                        document.body.innerHTML = printContent;
                        window.print();
                        document.body.innerHTML = originalContent;
                        loadDeliveries(); // Reload to reattach event listeners
                    }

                    // Payment Methods Functions
                    function loadPayments() {
                        const payments = JSON.parse(localStorage.getItem('payments')) || [
                            {
                                date: '2023-05-01',
                                amount: '176.00',
                                method: 'Credit Card',
                                status: 'paid'
                            },
                            {
                                date: '2023-04-01',
                                amount: '168.00',
                                method: 'Bank Transfer',
                                status: 'paid'
                            },
                            {
                                date: '2023-03-01',
                                amount: '155.00',
                                method: 'Cash',
                                status: 'paid'
                            },
                            {
                                date: '2023-06-01',
                                amount: '185.00',
                                method: '',
                                status: 'pending'
                            }
                        ];

                        const tbody = document.getElementById('paymentTableBody');
                        tbody.innerHTML = '';

                        payments.forEach(payment => {
                            const row = document.createElement('tr');

                            // Format date for display
                            const dateObj = new Date(payment.date);
                            const formattedDate = dateObj.toLocaleDateString();

                            // Get status badge class
                            const statusClass = payment.status === 'paid' ? 'completed' : 'pending';

                            row.innerHTML = `
            <td>${formattedDate}</td>
            <td>$${payment.amount}</td>
            <td>${payment.method || '-'}</td>
            <td><span class="status ${statusClass}">${payment.status.charAt(0).toUpperCase() + payment.status.slice(1)}</span></td>
            <td>
                <button class="btn-primary view-payment" data-date="${payment.date}">View Receipt</button>
                ${payment.status === 'pending' ?
                                    `<button class="btn-warning send-reminder" data-date="${payment.date}" style="margin-left: 5px;">Send Reminder</button>
                     <button class="btn-success record-payment" data-date="${payment.date}" style="margin-left: 5px;">Record Payment</button>` : ''}
            </td>
        `;

                            tbody.appendChild(row);
                        });

                        // Add event listeners to action buttons
                        document.querySelectorAll('.view-payment').forEach(btn => {
                            btn.addEventListener('click', function () {
                                viewPaymentDetails(this.getAttribute('data-date'));
                            });
                        });

                        document.querySelectorAll('.send-reminder').forEach(btn => {
                            btn.addEventListener('click', function () {
                                sendPaymentReminder(this.getAttribute('data-date'));
                            });
                        });

                        document.querySelectorAll('.record-payment').forEach(btn => {
                            btn.addEventListener('click', function () {
                                recordPayment(this.getAttribute('data-date'));
                            });
                        });
                    }

                    function showAddPaymentForm() {
                        document.getElementById('addPaymentForm').style.display = 'block';
                        document.getElementById('paymentDate').valueAsDate = new Date();
                    }

                    function hideAddPaymentForm() {
                        document.getElementById('addPaymentForm').style.display = 'none';
                        document.getElementById('addPaymentForm').reset();
                    }

                    function savePayment() {
                        const payment = {
                            date: document.getElementById('paymentDate').value,
                            amount: parseFloat(document.getElementById('paymentAmount').value).toFixed(2),
                            method: document.getElementById('paymentMethod').value === 'credit' ? 'Credit Card' :
                                document.getElementById('paymentMethod').value === 'bank' ? 'Bank Transfer' :
                                    document.getElementById('paymentMethod').value === 'cash' ? 'Cash' : 'Other',
                            status: document.getElementById('paymentStatus').value
                        };

                        if (!payment.date || isNaN(payment.amount) || !payment.method) {
                            alert('Please fill in all required fields');
                            return;
                        }

                        const payments = JSON.parse(localStorage.getItem('payments')) || [];
                        payments.push(payment);
                        localStorage.setItem('payments', JSON.stringify(payments));

                        loadPayments();
                        hideAddPaymentForm();
                    }

                    function viewPaymentDetails(paymentDate) {
                        const payments = JSON.parse(localStorage.getItem('payments'));
                        const payment = payments.find(p => p.date === paymentDate);

                        if (payment) {
                            alert(`Payment Details:\n\nDate: ${new Date(payment.date).toLocaleDateString()}\nAmount: $${payment.amount}\nMethod: ${payment.method || 'Not specified'}\nStatus: ${payment.status}`);
                        }
                    }

                    function sendPaymentReminder(paymentDate) {
                        const payments = JSON.parse(localStorage.getItem('payments'));
                        const payment = payments.find(p => p.date === paymentDate);

                        if (payment) {
                            alert(`Reminder sent for payment due on ${new Date(payment.date).toLocaleDateString()}`);
                        }
                    }

                    function recordPayment(paymentDate) {
                        const payments = JSON.parse(localStorage.getItem('payments'));
                        const payment = payments.find(p => p.date === paymentDate);

                        if (payment) {
                            const method = prompt('Enter payment method (Credit Card, Bank Transfer, Cash, Other):');
                            if (method) {
                                payment.method = method;
                                payment.status = 'paid';
                                localStorage.setItem('payments', JSON.stringify(payments));
                                loadPayments();
                            }
                        }
                    }

                    function exportPaymentsToPDF() {
                        const paymentTable = document.getElementById('paymentTable');

                        html2canvas(paymentTable).then(canvas => {
                            const imgData = canvas.toDataURL('image/png');
                            const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
                            const pageWidth = pdf.internal.pageSize.getWidth();
                            const imgProps = pdf.getImageProperties(imgData);
                            const pdfWidth = pageWidth;
                            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

                            pdf.addImage(imgData, 'PNG', 0, 10, pdfWidth, pdfHeight);
                            pdf.save('payment-history.pdf');
                        });
                    }

                    function generateInvoice() {
                        const payments = JSON.parse(localStorage.getItem('payments')) || [];
                        const pendingPayments = payments.filter(p => p.status === 'pending');

                        if (pendingPayments.length === 0) {
                            alert('No pending payments to generate invoice');
                            return;
                        }

                        let totalAmount = 0;
                        let tableRows = pendingPayments.map(payment => {
                            totalAmount += parseFloat(payment.amount);
                            return `<tr><td>${new Date(payment.date).toLocaleDateString()}</td><td>$${payment.amount}</td></tr>`;
                        }).join('');

                        const invoiceHTML = `
        <html>
        <head>
            <title>Invoice</title>
            <style>
                body { font-family: Arial, sans-serif; padding: 20px; }
                table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
                th { background-color: #f9f9f9; }
            
.sidebar.collapsed {
    transform: translateX(-100%);
}

.content-area.expanded {
    margin-left: 0 !important;
    flex: 1;
}


.sidebar.collapsed {
    display: none !important;
}

.content-area.expanded {
    width: 100% !important;
    margin: 0 !important;
    padding: 20px;
}

</style>
        </head>
        <body>
            <h2>Invoice</h2>
            <table border="1">
                <tr><th>Date</th><th>Amount</th></tr>
                ${tableRows}
                <tr><td><strong>Total</strong></td><td><strong>$${totalAmount.toFixed(2)}</strong></td></tr>
            </table>
        
<script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const content = document.querySelector('.content-area');

    sidebar.classList.toggle('collapsed');
    content.classList.toggle('expanded');
}
                </script>


                <script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const content = document.querySelector('.content-area');

    if (sidebar.classList.contains('collapsed')) {
        sidebar.classList.remove('collapsed');
        content.classList.remove('expanded');
    } else {
        sidebar.classList.add('collapsed');
        content.classList.add('expanded');
    }
}
                </script>

</body>

</html>
`
</script>






<script>
    // Initialize charts when the section is loaded
    function initSalesCharts() {
        // Today's Sales Chart
        const todayCtx = document.getElementById('todaySalesChart').getContext('2d');
        new Chart(todayCtx, {
            type: 'line',
            data: {
                labels: ['6AM', '9AM', '12PM', '3PM', '6PM', '9PM'],
                datasets: [{
                    label: 'Sales (₹)',
                    data: [15000, 25000, 35000, 45000, 60000, 75000],
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Monthly Sales Chart
        const monthlyCtx = document.getElementById('monthlySalesChart').getContext('2d');
        new Chart(monthlyCtx, {
            type: 'bar',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [{
                    label: 'Sales (₹)',
                    data: [650000, 700000, 750000, 750000],
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Sales Trend Chart
        const trendCtx = document.getElementById('salesTrendChart').getContext('2d');
        new Chart(trendCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'Sales (₹)',
                    data: [2200000, 2400000, 2600000, 2500000, 2700000, 2850000],
                    backgroundColor: 'rgba(153, 102, 255, 0.2)',
                    borderColor: 'rgba(153, 102, 255, 1)',
                    borderWidth: 2,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Monthly Sales Trend'
                    }
                }
            }
        });

        // Product Performance Chart
        const productCtx = document.getElementById('productPerformanceChart').getContext('2d');
        new Chart(productCtx, {
            type: 'doughnut',
            data: {
                labels: ['Standard Milk', 'Toned Milk', 'Flavored Milk', 'Ghee', 'Paneer', 'Yogurt'],
                datasets: [{
                    data: [35, 25, 15, 12, 8, 5],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.7)',
                        'rgba(54, 162, 235, 0.7)',
                        'rgba(255, 206, 86, 0.7)',
                        'rgba(75, 192, 192, 0.7)',
                        'rgba(153, 102, 255, 0.7)',
                        'rgba(255, 159, 64, 0.7)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Product Sales Distribution'
                    }
                }
            }
        });

        // Regional Sales Chart
        const regionCtx = document.getElementById('regionalSalesChart').getContext('2d');
        new Chart(regionCtx, {
            type: 'bar',
            data: {
                labels: ['North', 'South', 'East', 'West', 'Central'],
                datasets: [{
                    label: 'Sales (₹)',
                    data: [650000, 550000, 500000, 600000, 550000],
                    backgroundColor: 'rgba(255, 159, 64, 0.2)',
                    borderColor: 'rgba(255, 159, 64, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Regional Sales Performance'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Channel Distribution Chart
        const channelCtx = document.getElementById('channelDistributionChart').getContext('2d');
        new Chart(channelCtx, {
            type: 'pie',
            data: {
                labels: ['Retail', 'Wholesale', 'Online', 'Institutional'],
                datasets: [{
                    data: [45, 30, 15, 10],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.7)',
                        'rgba(54, 162, 235, 0.7)',
                        'rgba(255, 206, 86, 0.7)',
                        'rgba(75, 192, 192, 0.7)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Sales Channel Distribution'
                    }
                }
            }
        });

        // Customer Segmentation Chart
        const segmentCtx = document.getElementById('customerSegmentationChart').getContext('2d');
        new Chart(segmentCtx, {
            type: 'polarArea',
            data: {
                labels: ['Retail Stores', 'Restaurants', 'Institutions', 'Individuals'],
                datasets: [{
                    data: [40, 30, 20, 10],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.7)',
                        'rgba(54, 162, 235, 0.7)',
                        'rgba(255, 206, 86, 0.7)',
                        'rgba(75, 192, 192, 0.7)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Customer Segmentation'
                    }
                }
            }
        });

        // Purchase Frequency Chart
        const frequencyCtx = document.getElementById('purchaseFrequencyChart').getContext('2d');
        new Chart(frequencyCtx, {
            type: 'bar',
            data: {
                labels: ['Daily', 'Weekly', 'Bi-weekly', 'Monthly', 'Occasional'],
                datasets: [{
                    label: 'Customers',
                    data: [120, 350, 200, 150, 80],
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Purchase Frequency'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Customer Retention Chart
        const retentionCtx = document.getElementById('customerRetentionChart').getContext('2d');
        new Chart(retentionCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'New Customers',
                    data: [120, 110, 130, 140, 150, 160],
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2,
                    tension: 0.3
                }, {
                    label: 'Repeat Customers',
                    data: [80, 90, 100, 110, 120, 130],
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Customer Retention'
                    }
                }
            }
        });
    }

    // Toggle custom date range
    document.getElementById('salesDateRange').addEventListener('change', function() {
        const customRange = document.getElementById('customDateRange');
        if (this.value === 'custom') {
            customRange.style.display = 'block';
        } else {
            customRange.style.display = 'none';
        }
    });

    // Calculate total amount when quantity or unit price changes
    document.getElementById('salesQuantity').addEventListener('input', calculateTotal);
    document.getElementById('salesUnitPrice').addEventListener('input', calculateTotal);

    function calculateTotal() {
        const quantity = parseFloat(document.getElementById('salesQuantity').value) || 0;
        const unitPrice = parseFloat(document.getElementById('salesUnitPrice').value) || 0;
        const total = quantity * unitPrice;
        document.getElementById('salesTotal').value = total.toFixed(2);
    }

    // Show/hide add sales form
    document.getElementById('addSalesRecordBtn').addEventListener('click', function() {
        document.getElementById('addSalesForm').style.display = 'block';
    });

    document.getElementById('closeSalesForm').addEventListener('click', function() {
        document.getElementById('addSalesForm').style.display = 'none';
    });

    document.getElementById('cancelSalesForm').addEventListener('click', function() {
        document.getElementById('addSalesForm').style.display = 'none';
    });

    // Form submission
    document.getElementById('salesForm').addEventListener('submit', function(e) {
        e.preventDefault();
        // Here you would typically send the data to your backend
        alert('Sales record added successfully!');
        document.getElementById('addSalesForm').style.display = 'none';
        // Reset form
        this.reset();
    });

    // Initialize charts when the section is shown
    function showSalesSection() {
        initSalesCharts();
    }
</script>









<script>
// Payment Methods Functions
function loadPayments() {
    const payments = JSON.parse(localStorage.getItem('payments')) || [
        {
            date: '2023-05-01',
            amount: '176.00',
            method: 'Credit Card',
            status: 'paid'
        },
        {
            date: '2023-04-01',
            amount: '168.00',
            method: 'Bank Transfer',
            status: 'paid'
        },
        {
            date: '2023-03-01',
            amount: '155.00',
            method: 'Cash',
            status: 'paid'
        },
        {
            date: '2023-06-01',
            amount: '185.00',
            method: '',
            status: 'pending'
        }
    ];

    const tbody = document.getElementById('paymentTableBody');
    tbody.innerHTML = '';

    payments.forEach(payment => {
        const row = document.createElement('tr');
        const dateObj = new Date(payment.date);
        const formattedDate = '#INV-' + dateObj.getFullYear() + '-' +
            (dateObj.getMonth() + 1).toString().padStart(2, '0') +
            '<br>' + dateObj.toLocaleDateString();
        const statusClass = payment.status === 'paid' ? 'completed' : 'pending';
        row.innerHTML = `
                            < td > ${ formattedDate }</td >
            <td>$${payment.amount}</td>
            <td>${payment.method}</td>
            <td><span class="status ${statusClass}">${payment.status.charAt(0).toUpperCase() + payment.status.slice(1)}</span></td>
            <td>
                ${payment.status === 'paid' ? 
                    '<button class="btn-primary view-receipt" data-id="' + payment.date + '">View Receipt</button>' : 
                    '<button class="btn-primary send-reminder" data-id="' + payment.date + '">Send Reminder</button>' + 
                    '<button class="btn-success record-payment" data-id="' + payment.date + '" style="margin-left: 5px;">Record Payment</button>'}
            </td>
                        `;
        tbody.appendChild(row);
    });
    document.querySelectorAll('.view-receipt').forEach(btn => {
        btn.addEventListener('click', function() {
            viewReceipt(this.getAttribute('data-id'));
        });
    });
    document.querySelectorAll('.send-reminder').forEach(btn => {
        btn.addEventListener('click', function() {
            sendReminder(this.getAttribute('data-id'));
        });
    });
    document.querySelectorAll('.record-payment').forEach(btn => {
        btn.addEventListener('click', function() {
            recordPayment(this.getAttribute('data-id'));
        });
    });
}
function showAddPaymentForm() {
    document.getElementById('addPaymentForm').style.display = 'block';
    document.getElementById('paymentDate').valueAsDate = new Date();
}
function hideAddPaymentForm() {
    document.getElementById('addPaymentForm').style.display = 'none';
    document.getElementById('addPaymentForm').reset();
}
function savePayment() {
    const payment = {
        date: document.getElementById('paymentDate').value,
        amount: document.getElementById('paymentAmount').value,
        method: document.getElementById('paymentMethod').value === 'credit' ? 'Credit Card' : 
                document.getElementById('paymentMethod').value === 'bank' ? 'Bank Transfer' : 
                document.getElementById('paymentMethod').value === 'cash' ? 'Cash' : 'Other',
        status: document.getElementById('paymentStatus').value
    };
    if (!payment.date || !payment.amount || !document.getElementById('paymentMethod').value || !payment.status) {
        alert('Please fill in all required fields');
        return;
    }
    const payments = JSON.parse(localStorage.getItem('payments')) || [];
    payments.push(payment);
    localStorage.setItem('payments', JSON.stringify(payments));
    loadPayments();
    hideAddPaymentForm();
}
function viewReceipt(paymentDate) {
    const payments = JSON.parse(localStorage.getItem('payments'));
    const payment = payments.find(p => p.date === paymentDate);
    if (payment) {
        alert(`Payment Receipt: \n\nDate: ${ new Date(payment.date).toLocaleDateString() } \nAmount: $${ payment.amount } \nMethod: ${ payment.method } \nStatus: ${ payment.status } `);
    }
}
function sendReminder(paymentDate) {
    const payments = JSON.parse(localStorage.getItem('payments'));
    const payment = payments.find(p => p.date === paymentDate);
    if (payment) {
        alert(`Reminder sent for payment due on ${ new Date(payment.date).toLocaleDateString() }`);
    }
}
function recordPayment(paymentDate) {
    const payments = JSON.parse(localStorage.getItem('payments'));
    const payment = payments.find(p => p.date === paymentDate);
    if (payment) {
        const method = prompt('Enter payment method (Credit Card, Bank Transfer, Cash, Other):');
        if (method) {
            payment.method = method;
            payment.status = 'paid';
            localStorage.setItem('payments', JSON.stringify(payments));
            loadPayments();
        }
    }
}
function exportPaymentsToPDF() {
    const paymentTable = document.getElementById('paymentTable');
    html2canvas(paymentTable).then(canvas => {
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
        const pageWidth = pdf.internal.pageSize.getWidth();
        const imgProps = pdf.getImageProperties(imgData);
        const pdfWidth = pageWidth;
        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
        pdf.addImage(imgData, 'PNG', 0, 10, pdfWidth, pdfHeight);
        pdf.save('payment-history.pdf');
    });
}
function generateInvoice() {
    alert('Invoice generation functionality would go here');
}
</script>


<script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const content = document.querySelector('.content-area');

    sidebar.classList.toggle('collapsed');
    content.classList.toggle('expanded');
}
</script>


<script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const content = document.querySelector('.content-area');

    if (sidebar.classList.contains('collapsed')) {
        sidebar.classList.remove('collapsed');
        content.classList.remove('expanded');
    } else {
        sidebar.classList.add('collapsed');
        content.classList.add('expanded');
    }
}
</script>

</body>
</div>
</div>
</div>
<script>
// Add Payment - Show form
document.getElementById("addPaymentBtn")?.addEventListener('click', function() {
    document.getElementById("addPaymentForm").style.display = "block";
});

document.getElementById("cancelPaymentBtn")?.addEventListener('click', function() {
    document.getElementById("addPaymentForm").style.display = "none";
});

// Export to PDF - Use html2canvas and jsPDF
document.getElementById("exportPaymentPdfBtn")?.addEventListener('click', function() {
    const element = document.getElementById("paymentTable");
    html2canvas(element).then((canvas) => {
        const imgData = canvas.toDataURL("image/png");
        const pdf = new jspdf.jsPDF();
        pdf.addImage(imgData, "PNG", 10, 10, 190, 0);
        pdf.save("payment-details.pdf");
    });
});

// Generate Invoice - Dummy PDF content
document.getElementById("generateInvoiceBtn")?.addEventListener('click', function() {
    const pdf = new jspdf.jsPDF();
    pdf.text("Invoice Generated", 20, 20);
    pdf.save("invoice.pdf");
});

// Print Schedule
document.getElementById("printScheduleBtn")?.addEventListener('click', function() {
    window.print();
});
</script>

<script>
// Initialize Retail Section Charts
document.addEventListener('DOMContentLoaded', function() {
    if (document.getElementById('retail-section')) {
        initializeRetailCharts();
        setupRetailEventHandlers();
    }
});

function initializeRetailCharts() {
    // Mini Charts
    new Chart(document.getElementById('totalOutletsChart').getContext('2d'), {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                data: [1150, 1175, 1190, 1205, 1225, 1248],
                borderColor: '#0077b6',
                borderWidth: 2,
                fill: false,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { y: { display: false }, x: { display: false } }
        }
    });
    
    new Chart(document.getElementById('dailySalesChart').getContext('2d'), {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                data: [4.1, 4.3, 4.5, 4.8, 5.0, 5.2],
                borderColor: '#2a9d8f',
                borderWidth: 2,
                fill: false,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { 
                y: { 
                    display: false,
                    ticks: {
                        callback: function(value) {
                            return '₹' + value + 'M';
                        }
                    }
                }, 
                x: { display: false } 
            }
        }
    });
    
    new Chart(document.getElementById('avgOrderValueChart').getContext('2d'), {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                data: [460, 455, 452, 450, 448, 450],
                borderColor: '#e9c46a',
                borderWidth: 2,
                fill: false,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { 
                y: { 
                    display: false,
                    ticks: {
                        callback: function(value) {
                            return '₹' + value;
                        }
                    }
                }, 
                x: { display: false } 
            }
        }
    });
    
    new Chart(document.getElementById('customerSatisfactionChart').getContext('2d'), {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                data: [90, 90.5, 91, 91.5, 92, 92],
                borderColor: '#9b5de5',
                borderWidth: 2,
                fill: false,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { 
                y: { 
                    display: false,
                    ticks: {
                        callback: function(value) {
                            return value + '%';
                        }
                    }
                }, 
                x: { display: false } 
            }
        }
    });
    
    // Region Sales Chart
    new Chart(document.getElementById('regionSalesChart').getContext('2d'), {
        type: 'bar',
        data: {
            labels: ['Ahmedabad', 'Gandhinagar', 'Vadodara', 'Surat', 'Rajkot'],
            datasets: [{
                label: 'Sales (₹)',
                data: [1250000, 985000, 872000, 768000, 654000],
                backgroundColor: [
                    '#0077b6',
                    '#00b4d8',
                    '#2a9d8f',
                    '#e9c46a',
                    '#e76f51'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Sales by Region (Last 30 Days)'
                },
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return '₹' + (value / 1000) + 'K';
                        }
                    }
                }
            }
        }
    });
    
    // Region Growth Chart
    new Chart(document.getElementById('regionGrowthChart').getContext('2d'), {
        type: 'bar',
        data: {
            labels: ['Ahmedabad', 'Gandhinagar', 'Vadodara', 'Surat', 'Rajkot'],
            datasets: [{
                label: 'Growth %',
                data: [15.2, 12.7, 10.5, 8.3, 7.1],
                backgroundColor: [
                    '#0077b6',
                    '#00b4d8',
                    '#2a9d8f',
                    '#e9c46a',
                    '#e76f51'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Sales Growth by Region (%)'
                },
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return value + '%';
                        }
                    }
                }
            }
        }
    });
    
    // Top Products Chart
    new Chart(document.getElementById('topProductsChart').getContext('2d'), {
        type: 'bar',
        data: {
            labels: ['Standard Milk', 'Toned Milk', 'Pure Ghee', 'Paneer', 'Flavored Milk'],
            datasets: [{
                label: 'Units Sold',
                data: [12500, 10800, 3500, 4200, 6800],
                backgroundColor: '#2a9d8f',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Top Selling Products (Last 30 Days)'
                },
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
    
    // Product Category Chart
    new Chart(document.getElementById('productCategoryChart').getContext('2d'), {
        type: 'doughnut',
        data: {
            labels: ['Liquid Milk', 'Dairy Fat', 'Cheese', 'Fermented', 'Others'],
            datasets: [{
                data: [45, 25, 15, 10, 5],
                backgroundColor: [
                    '#0077b6',
                    '#00b4d8',
                    '#2a9d8f',
                    '#e9c46a',
                    '#e76f51'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Sales by Product Category (%)'
                }
            }
        }
    });
    
    // Age Distribution Chart
    new Chart(document.getElementById('ageDistributionChart').getContext('2d'), {
        type: 'pie',
        data: {
            labels: ['18-25', '26-35', '36-45', '46-55', '56+'],
            datasets: [{
                data: [15, 35, 30, 15, 5],
                backgroundColor: [
                    '#0077b6',
                    '#00b4d8',
                    '#2a9d8f',
                    '#e9c46a',
                    '#e76f51'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Customer Age Distribution'
                }
            }
        }
    });
    
    // Purchase Frequency Chart
    new Chart(document.getElementById('purchaseFrequencyChart').getContext('2d'), {
        type: 'polarArea',
        data: {
            labels: ['Daily', '2-3x Week', 'Weekly', 'Bi-Weekly', 'Monthly'],
            datasets: [{
                data: [25, 35, 20, 15, 5],
                backgroundColor: [
                    '#0077b6',
                    '#00b4d8',
                    '#2a9d8f',
                    '#e9c46a',
                    '#e76f51'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Purchase Frequency'
                }
            }
        }
    });
    
    // Payment Methods Chart
    new Chart(document.getElementById('paymentMethodsChart').getContext('2d'), {
        type: 'doughnut',
        data: {
            labels: ['Cash', 'Credit Card', 'Debit Card', 'UPI', 'Wallet'],
            datasets: [{
                data: [30, 25, 20, 15, 10],
                backgroundColor: [
                    '#0077b6',
                    '#00b4d8',
                    '#2a9d8f',
                    '#e9c46a',
                    '#e76f51'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Payment Methods'
                }
            }
        }
    });
}

function setupRetailEventHandlers() {
    // Add Outlet Button
    document.getElementById('addRetailOutletBtn').addEventListener('click', function() {
        document.getElementById('addOutletForm').style.display = 'block';
        document.getElementById('outletForm').reset();
        delete document.getElementById('outletForm').dataset.editingId;
    });
    
    // Close Outlet Form
    document.getElementById('closeOutletForm').addEventListener('click', function() {
        document.getElementById('addOutletForm').style.display = 'none';
    });
    
    // Cancel Outlet Form
    document.getElementById('cancelOutletForm').addEventListener('click', function() {
        document.getElementById('addOutletForm').style.display = 'none';
    });
    
    // Save Outlet Form
    document.getElementById('outletForm').addEventListener('submit', function(e) {
        e.preventDefault();
        // Here you would typically save the data to your backend
        alert('Outlet saved successfully!');
        document.getElementById('addOutletForm').style.display = 'none';
    });
    
    // Time Range Selectors
    document.getElementById('salesRegionTimeRange').addEventListener('change', function() {
        updateRegionCharts(this.value);
    });
    
    document.getElementById('productPerformanceTimeRange').addEventListener('change', function() {
        updateProductPerformanceCharts(this.value);
    });
}

function updateRegionCharts(timeRange) {
    // In a real application, you would fetch new data based on the time range
    console.log('Updating region charts for time range:', timeRange);
    // For demo purposes, we'll just show an alert
    alert('Charts updated for ' + timeRange + ' time range');
}

function updateProductPerformanceCharts(timeRange) {
    // In a real application, you would fetch new data based on the time range
    console.log('Updating product performance charts for time range:', timeRange);
    // For demo purposes, we'll just show an alert
    alert('Charts updated for ' + timeRange + ' time range');
}
</script>

<script>
document.getElementById("generateInvoiceBtn")?.addEventListener('click', function() {
    const doc = new jspdf.jsPDF();
    doc.setFontSize(16);
    doc.text("Payment Invoice", 105, 20, null, null, "center");

    const table = document.getElementById("paymentTable");
    let rows = [];
    let headers = [];

    // Extract table headers
    table.querySelectorAll("thead th").forEach(th => {
        headers.push(th.innerText.trim());
    });

    // Extract table rows
    table.querySelectorAll("tbody tr").forEach(tr => {
        let row = [];
        tr.querySelectorAll("td").forEach(td => {
            row.push(td.innerText.trim().replace(/\n/g, " "));
        });
        rows.push(row);
    });

    // AutoTable from jsPDF
    if (rows.length > 0) {
        doc.autoTable({
            head: [headers],
            body: rows,
            startY: 30
        });
    }

    doc.save("Payment_Invoice.pdf");
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    let editingIndex = -1;

    function showUserForm() {
        document.getElementById('userForm').style.display = 'block';
    }

    function hideUserForm() {
        document.getElementById('userForm').style.display = 'none';
        document.getElementById('userName').value = '';
        document.getElementById('userEmail').value = '';
        document.getElementById('userPassword').value = '';
        editingIndex = -1;
    }

    function saveUser() {
        let users = JSON.parse(localStorage.getItem('users') || '[]');
        const name = document.getElementById('userName').value;
        const email = document.getElementById('userEmail').value;
        const password = document.getElementById('userPassword').value;

        if (!name || !email || !password) {
            alert('All fields are required');
            return;
        }

        if (editingIndex === -1) {
            users.push({ name, email, password });
        } else {
            users[editingIndex] = { name, email, password };
        }

        localStorage.setItem('users', JSON.stringify(users));
        renderUsers();
        hideUserForm();
    }

    function renderUsers() {
        const users = JSON.parse(localStorage.getItem('users') || '[]');
        const tbody = document.getElementById('userTableBody');
        tbody.innerHTML = '';
        users.forEach((user, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                            < td > ${ user.name }</td >
                <td>${user.email}</td>
                <td>${user.password}</td>
                <td>
                    <button onclick="editUser(${index})">Edit</button>
                    <button onclick="deleteUser(${index})">Delete</button>
                </td>
            `;
            tbody.appendChild(row);
        });
    }

    window.editUser = function(index) {
        const users = JSON.parse(localStorage.getItem('users') || '[]');
        const user = users[index];
        document.getElementById('userName').value = user.name;
        document.getElementById('userEmail').value = user.email;
        document.getElementById('userPassword').value = user.password;
        editingIndex = index;
        showUserForm();
    }

    window.deleteUser = function(index) {
        if (confirm('Are you sure you want to delete this user?')) {
            let users = JSON.parse(localStorage.getItem('users') || '[]');
            users.splice(index, 1);
            localStorage.setItem('users', JSON.stringify(users));
            renderUsers();
        }
    }

    window.showUserForm = showUserForm;
    window.hideUserForm = hideUserForm;
    window.saveUser = saveUser;

    renderUsers();
});
</script>
<script>
    // Collection Schedule JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // Initialize collections data from local storage
    let collections = JSON.parse(localStorage.getItem('milkCollections')) || [];
    let currentPage = 1;
    const itemsPerPage = 10;
    
    // Sample farmer data
    const farmers = [
        { id: 'F-1001', name: 'Rajesh Patel', village: 'Anand' },
        { id: 'F-1002', name: 'Sunita Sharma', village: 'Mehsana' },
        { id: 'F-1003', name: 'Vijay Singh', village: 'Kheda' },
        { id: 'F-1004', name: 'Meena Desai', village: 'Sabarkantha' },
        { id: 'F-1005', name: 'Arun Gupta', village: 'Gandhinagar' }
    ];
    
    // Initialize the page
    initCollectionSchedule();
    
    // Event listeners
    document.getElementById('addCollectionBtn').addEventListener('click', showAddCollectionForm);
    document.getElementById('closeCollectionForm').addEventListener('click', hideCollectionForm);
    document.getElementById('cancelCollectionForm').addEventListener('click', hideCollectionForm);
    document.getElementById('collectionForm').addEventListener('submit', saveCollection);
    document.getElementById('applyFiltersBtn').addEventListener('click', applyFilters);
    document.getElementById('resetFiltersBtn').addEventListener('click', resetFilters);
    document.getElementById('prevCollectionPage').addEventListener('click', () => changeCollectionPage(-1));
    document.getElementById('nextCollectionPage').addEventListener('click', () => changeCollectionPage(1));
    
    // Initialize collection schedule
    function initCollectionSchedule() {
        // If no data in local storage, create sample data
        if (collections.length === 0) {
            createSampleCollections();
        }
        
        // Populate farmer dropdown
        const farmerSelect = document.getElementById('collectionFarmer');
        farmerSelect.innerHTML = '<option value="">Select Farmer</option>';
        farmers.forEach(farmer => {
            const option = document.createElement('option');
            option.value = farmer.id;
            option.textContent = `${ farmer.name } (${ farmer.id }) - ${ farmer.village } `;
            farmerSelect.appendChild(option);
        });
        
        // Load collections
        loadCollections();
        updateStats();
        initCharts();
    }
    
    // Create sample collections if none exist
    function createSampleCollections() {
        const today = new Date();
        const tomorrow = new Date();
        tomorrow.setDate(today.getDate() + 1);
        
        const sampleCollections = [
            {
                id: 'MC-' + Math.floor(Math.random() * 9000 + 1000),
                farmerId: 'F-1001',
                farmerName: 'Rajesh Patel',
                center: 'Ahmedabad',
                date: formatDate(today),
                expectedQty: 45.5,
                actualQty: 46.0,
                timeSlot: 'Morning (6-9 AM)',
                status: 'completed',
                notes: 'Good quality milk'
            },
            {
                id: 'MC-' + Math.floor(Math.random() * 9000 + 1000),
                farmerId: 'F-1002',
                farmerName: 'Sunita Sharma',
                center: 'Gandhinagar',
                date: formatDate(today),
                expectedQty: 38.0,
                actualQty: 37.5,
                timeSlot: 'Late Morning (9-12 PM)',
                status: 'completed',
                notes: 'Slightly less than expected'
            },
            {
                id: 'MC-' + Math.floor(Math.random() * 9000 + 1000),
                farmerId: 'F-1003',
                farmerName: 'Vijay Singh',
                center: 'Vadodara',
                date: formatDate(today),
                expectedQty: 52.0,
                actualQty: null,
                timeSlot: 'Afternoon (12-3 PM)',
                status: 'in-progress',
                notes: 'Expected high yield today'
            },
            {
                id: 'MC-' + Math.floor(Math.random() * 9000 + 1000),
                farmerId: 'F-1004',
                farmerName: 'Meena Desai',
                center: 'Surat',
                date: formatDate(tomorrow),
                expectedQty: 41.5,
                actualQty: null,
                timeSlot: 'Morning (6-9 AM)',
                status: 'scheduled',
                notes: ''
            },
            {
                id: 'MC-' + Math.floor(Math.random() * 9000 + 1000),
                farmerId: 'F-1005',
                farmerName: 'Arun Gupta',
                center: 'Rajkot',
                date: formatDate(tomorrow),
                expectedQty: 47.0,
                actualQty: null,
                timeSlot: 'Evening (3-6 PM)',
                status: 'scheduled',
                notes: ''
            }
        ];
        
        collections = sampleCollections;
        saveCollectionsToLocalStorage();
    }
    
    // Load collections into the table
    function loadCollections(filteredCollections = null) {
        const collectionsToDisplay = filteredCollections || collections;
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const paginatedCollections = collectionsToDisplay.slice(startIndex, endIndex);
        
        const tableBody = document.getElementById('collectionTableBody');
        tableBody.innerHTML = '';
        
        if (paginatedCollections.length === 0) {
            const row = document.createElement('tr');
            row.innerHTML = '<td colspan="9" style="text-align: center;">No collections found</td>';
            tableBody.appendChild(row);
        } else {
            paginatedCollections.forEach(collection => {
                const row = document.createElement('tr');
                
                // Format actual quantity display
                const actualQtyDisplay = collection.actualQty !== null ? 
                    collection.actualQty + ' L' : '--';
                
                // Format status badge
                let statusClass = '';
                let statusText = '';
                switch(collection.status) {
                    case 'scheduled':
                        statusClass = 'scheduled';
                        statusText = 'Scheduled';
                        break;
                    case 'in-progress':
                        statusClass = 'processing';
                        statusText = 'In Progress';
                        break;
                    case 'completed':
                        statusClass = 'completed';
                        statusText = 'Completed';
                        break;
                    case 'cancelled':
                        statusClass = 'pending';
                        statusText = 'Cancelled';
                        break;
                }
                
                row.innerHTML = `
                            < td > ${ collection.id }</td >
                    <td>${collection.date}</td>
                    <td>${collection.farmerName} (${collection.farmerId})</td>
                    <td>${collection.center} Center</td>
                    <td>${collection.expectedQty} L</td>
                    <td>${actualQtyDisplay}</td>
                    <td>${collection.timeSlot}</td>
                    <td><span class="status ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="btn-primary edit-collection" data-id="${collection.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-danger delete-collection" data-id="${collection.id}" style="margin-left: 5px;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                        `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-collection').forEach(button => {
                button.addEventListener('click', function() {
                    editCollection(this.getAttribute('data-id'));
                });
            });
            
            document.querySelectorAll('.delete-collection').forEach(button => {
                button.addEventListener('click', function() {
                    deleteCollection(this.getAttribute('data-id'));
                });
            });
        }
        
        // Update pagination info
        updatePaginationInfo(collectionsToDisplay.length);
    }
    
    // Update pagination information
    function updatePaginationInfo(totalItems) {
        const startItem = ((currentPage - 1) * itemsPerPage) + 1;
        const endItem = Math.min(currentPage * itemsPerPage, totalItems);
        
        document.getElementById('collectionPaginationInfo').textContent = 
            `Showing ${ startItem } to ${ endItem } of ${ totalItems } collections`;
            
        // Enable/disable pagination buttons
        document.getElementById('prevCollectionPage').disabled = currentPage === 1;
        document.getElementById('nextCollectionPage').disabled = 
            currentPage * itemsPerPage >= totalItems;
    }
    
    // Change page
    function changeCollectionPage(direction) {
        const totalPages = Math.ceil(collections.length / itemsPerPage);
        
        if (direction === 1 && currentPage < totalPages) {
            currentPage++;
            loadCollections();
        } else if (direction === -1 && currentPage > 1) {
            currentPage--;
            loadCollections();
        }
    }
    
    // Show add collection form
    function showAddCollectionForm() {
        document.getElementById('collectionFormTitle').textContent = 'Add New Collection';
        document.getElementById('collectionId').value = '';
        document.getElementById('collectionForm').reset();
        document.getElementById('collectionActualQty').disabled = false;
        
        // Set default date to today
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('collectionDate').value = today;
        
        document.getElementById('collectionFormContainer').style.display = 'block';
        document.getElementById('collectionTable').style.display = 'none';
    }
    
    // Hide collection form
    function hideCollectionForm() {
        document.getElementById('collectionFormContainer').style.display = 'none';
        document.getElementById('collectionTable').style.display = 'table';
    }
    
    // Edit collection
    function editCollection(id) {
        const collection = collections.find(c => c.id === id);
        if (!collection) return;
        
        document.getElementById('collectionFormTitle').textContent = 'Edit Collection';
        document.getElementById('collectionId').value = collection.id;
        document.getElementById('collectionFarmer').value = collection.farmerId;
        document.getElementById('collectionCenter').value = collection.center;
        document.getElementById('collectionDate').value = collection.date;
        document.getElementById('collectionTimeSlot').value = collection.timeSlot;
        document.getElementById('collectionExpectedQty').value = collection.expectedQty;
        document.getElementById('collectionActualQty').value = collection.actualQty || '';
        document.getElementById('collectionStatus').value = collection.status;
        document.getElementById('collectionNotes').value = collection.notes || '';
        
        // Disable actual quantity if status is scheduled
        document.getElementById('collectionActualQty').disabled = collection.status === 'scheduled';
        
        document.getElementById('collectionFormContainer').style.display = 'block';
        document.getElementById('collectionTable').style.display = 'none';
    }
    
    // Save collection (add or update)
    function saveCollection(e) {
        e.preventDefault();
        
        const id = document.getElementById('collectionId').value;
        const farmerId = document.getElementById('collectionFarmer').value;
        const center = document.getElementById('collectionCenter').value;
        const date = document.getElementById('collectionDate').value;
        const timeSlot = document.getElementById('collectionTimeSlot').value;
        const expectedQty = parseFloat(document.getElementById('collectionExpectedQty').value);
        const actualQty = document.getElementById('collectionActualQty').value ? 
            parseFloat(document.getElementById('collectionActualQty').value) : null;
        const status = document.getElementById('collectionStatus').value;
        const notes = document.getElementById('collectionNotes').value;
        
        // Find farmer name
        const farmer = farmers.find(f => f.id === farmerId);
        const farmerName = farmer ? farmer.name : '';
        
        if (id) {
            // Update existing collection
            const index = collections.findIndex(c => c.id === id);
            if (index !== -1) {
                collections[index] = {
                    id,
                    farmerId,
                    farmerName,
                    center,
                    date,
                    expectedQty,
                    actualQty,
                    timeSlot,
                    status,
                    notes
                };
            }
        } else {
            // Add new collection
            const newId = 'MC-' + Math.floor(Math.random() * 9000 + 1000);
            collections.push({
                id: newId,
                farmerId,
                farmerName,
                center,
                date,
                expectedQty,
                actualQty,
                timeSlot,
                status,
                notes
            });
        }
        
        saveCollectionsToLocalStorage();
        hideCollectionForm();
        loadCollections();
        updateStats();
    }
    
    // Delete collection
    function deleteCollection(id) {
        if (confirm('Are you sure you want to delete this collection?')) {
            collections = collections.filter(c => c.id !== id);
            saveCollectionsToLocalStorage();
            loadCollections();
            updateStats();
        }
    }
    
    // Apply filters
    function applyFilters() {
        const centerFilter = document.getElementById('collectionCenterFilter').value;
        const statusFilter = document.getElementById('collectionStatusFilter').value;
        const dateFilter = document.getElementById('collectionDateFilter').value;
        
        let filteredCollections = collections;
        
        if (centerFilter) {
            filteredCollections = filteredCollections.filter(c => c.center === centerFilter);
        }
        
        if (statusFilter) {
            filteredCollections = filteredCollections.filter(c => c.status === statusFilter);
        }
        
        if (dateFilter) {
            filteredCollections = filteredCollections.filter(c => c.date === dateFilter);
        }
        
        currentPage = 1;
        loadCollections(filteredCollections);
    }
    
    // Reset filters
    function resetFilters() {
        document.getElementById('collectionCenterFilter').value = '';
        document.getElementById('collectionStatusFilter').value = '';
        document.getElementById('collectionDateFilter').value = '';
        
        currentPage = 1;
        loadCollections();
    }
    
    // Update statistics
    function updateStats() {
        const today = formatDate(new Date());
        
        // Scheduled today
        const scheduledToday = collections.filter(c => 
            c.date === today && c.status === 'scheduled').length;
        document.getElementById('scheduledToday').textContent = scheduledToday;
        
        // Completed today
        const completedToday = collections.filter(c => 
            c.date === today && c.status === 'completed').length;
        document.getElementById('completedToday').textContent = completedToday;
        
        // Pending collections (scheduled or in-progress)
        const pendingCollections = collections.filter(c => 
            c.status === 'scheduled' || c.status === 'in-progress').length;
        document.getElementById('pendingCollections').textContent = pendingCollections;
        
        // Calculate changes (simplified for demo)
        document.getElementById('scheduledChange').textContent = '5%';
        document.getElementById('completedChange').textContent = '3%';
        document.getElementById('pendingChange').textContent = '2';
    }
    
    // Initialize charts
    function initCharts() {
        // Scheduled vs Completed Chart
        const scheduledCtx = document.getElementById('scheduledChart').getContext('2d');
        new Chart(scheduledCtx, {
            type: 'bar',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                datasets: [{
                    label: 'Scheduled',
                    data: [12, 15, 13, 14, 16, 10],
                    backgroundColor: '#0077b6'
                }, {
                    label: 'Completed',
                    data: [10, 12, 11, 13, 14, 8],
                    backgroundColor: '#2a9d8f'
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
        
        // Completed Chart
        const completedCtx = document.getElementById('completedChart').getContext('2d');
        new Chart(completedCtx, {
            type: 'line',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                datasets: [{
                    label: 'Completed Collections',
                    data: [10, 12, 11, 13, 14, 8],
                    borderColor: '#2a9d8f',
                    backgroundColor: 'rgba(42, 157, 143, 0.1)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
        
        // Pending Chart
        const pendingCtx = document.getElementById('pendingChart').getContext('2d');
        new Chart(pendingCtx, {
            type: 'doughnut',
            data: {
                labels: ['Scheduled', 'In Progress', 'Completed', 'Cancelled'],
                datasets: [{
                    data: [15, 8, 30, 2],
                    backgroundColor: [
                        '#0077b6',
                        '#e9c46a',
                        '#2a9d8f',
                        '#e76f51'
                    ]
                }]
            },
            options: {
                responsive: true
            }
        });
    }
    
    // Save collections to local storage
    function saveCollectionsToLocalStorage() {
        localStorage.setItem('milkCollections', JSON.stringify(collections));
    }
    
    // Helper function to format date as YYYY-MM-DD
    function formatDate(date) {
        const d = new Date(date);
        let month = '' + (d.getMonth() + 1);
        let day = '' + d.getDate();
        const year = d.getFullYear();
        
        if (month.length < 2) month = '0' + month;
        if (day.length < 2) day = '0' + day;
        
        return [year, month, day].join('-');
    }
    
    // Status change handler
    document.getElementById('collectionStatus').addEventListener('change', function() {
        const actualQtyField = document.getElementById('collectionActualQty');
        if (this.value === 'scheduled') {
            actualQtyField.disabled = true;
            actualQtyField.value = '';
        } else {
            actualQtyField.disabled = false;
        }
    });
});
</script>
<script>
    // ========== Farmer Registration & List Management ==========

// --- Utilities for Local Storage ---
function getFarmers() {
    let farmers = [];
    try { farmers = JSON.parse(localStorage.getItem('farmers') || "[]"); } catch { farmers = []; }
    return Array.isArray(farmers) ? farmers : [];
}
function setFarmers(arr) {
    localStorage.setItem('farmers', JSON.stringify(arr));
}
function generateFarmerId() {
    // FarmerID: FMR + 5-digit number
    let farmers = getFarmers();
    let maxId = farmers.reduce((max, f) => {
        let m = (f.farmerId || '').match(/^FMR(\d{5})$/);
        return m ? Math.max(max, parseInt(m[1],10)) : max;
    }, 0);
    let nextNum = maxId + 1;
    return "FMR" + ("0000" + nextNum).slice(-5);
}

// --- State for List View ---
let farmerListPage = 1;
const farmersPerPage = 10;
let farmerListSearch = "";

// --- Registration Form Logic ---
document.addEventListener('DOMContentLoaded', () => {
    // Set Farmer ID and Registration Date
    if (document.getElementById('farmerId')) {
        document.getElementById('farmerId').value = generateFarmerId();
    }
    if (document.getElementById('registrationDate')) {
        document.getElementById('registrationDate').valueAsDate = new Date();
    }
    showRegistrationForm();
    renderFarmersTable();
});

document.getElementById('farmerRegistrationForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const farmer = getFarmerFormData();
    if (!farmer) return; // Validation failed

    let farmers = getFarmers();
    if (farmers.some(f => f.aadharNumber === farmer.aadharNumber)) {
        alert("A farmer with this Aadhar number already exists.");
        return;
    }
    if (farmers.some(f => f.phoneNumber === farmer.phoneNumber)) {
        alert("A farmer with this phone number already exists.");
        return;
    }
    farmers.push(farmer);
    setFarmers(farmers);

    alert("Farmer registered successfully!");
    this.reset();
    document.getElementById('farmerId').value = generateFarmerId();
    document.getElementById('registrationDate').valueAsDate = new Date();
    showFarmerList();
    renderFarmersTable();
});

// --- Form Data Extraction & Validation ---
function getFarmerFormData() {
    const getVal = id => (document.getElementById(id) ? document.getElementById(id).value.trim() : "");
    const getFile = id => (document.getElementById(id) && document.getElementById(id).files.length > 0)
        ? document.getElementById(id).files[0].name : ""; // Save filename only for demo

    // Validate required fields
    const farmerId = getVal('farmerId');
    const registrationDate = getVal('registrationDate');
    const fullName = getVal('fullName');
    const gender = getVal('gender');
    const dob = getVal('dob');
    const aadharNumber = getVal('aadharNumber');
    const phoneNumber = getVal('phoneNumber');
    const email = getVal('email');
    const address = getVal('address');
    const village = getVal('village');
    const district = getVal('district');
    const state = getVal('state');
    const pincode = getVal('pincode');
    const farmName = getVal('farmName');
    const farmSize = getVal('farmSize');
    const cattleCount = getVal('cattleCount');
    const milkProduction = getVal('milkProduction');
    const cattleBreeds = Array.from(document.getElementById('cattleBreeds').selectedOptions).map(o => o.value);
    const bankName = getVal('bankName');
    const accountNumber = getVal('accountNumber');
    const ifscCode = getVal('ifscCode');
    const accountHolder = getVal('accountHolder');
    const aadharUpload = getFile('aadharUpload');
    const landProof = getFile('landProof');
    const bankProof = getFile('bankProof');
    const photo = getFile('photo');

    // Field validations
    if (!farmerId || !registrationDate || !fullName || !gender || !dob || !aadharNumber ||
        !phoneNumber || !address || !village || !district || !state || !pincode ||
        !cattleCount || !milkProduction || !bankName || !accountNumber || !ifscCode || !accountHolder) {
        alert("Please fill all required fields.");
        return null;
    }
    if (!/^[0-9]{12}$/.test(aadharNumber)) {
        alert("Aadhar number must be 12 digits.");
        return null;
    }
    if (!/^[0-9]{10}$/.test(phoneNumber)) {
        alert("Phone number must be 10 digits.");
        return null;
    }
    if (!/^[0-9]{6}$/.test(pincode)) {
        alert("Pincode must be 6 digits.");
        return null;
    }

    // Save as object
    return {
        farmerId, registrationDate, fullName, gender, dob, aadharNumber,
        phoneNumber, email, address, village, district, state, pincode,
        farmName, farmSize, cattleCount, milkProduction, cattleBreeds,
        bankName, accountNumber, ifscCode, accountHolder,
        aadharUpload, landProof, bankProof, photo,
        status: "Active"
    };
}

// --- Show/Hide Sections ---
function showFarmerList() {
    document.getElementById('farmerRegistrationForm').parentElement.style.display = "none";
    document.getElementById('registeredFarmersList').style.display = "";
    farmerListPage = 1;
    farmerListSearch = "";
    document.getElementById('farmerSearch').value = "";
    renderFarmersTable();
}
function showRegistrationForm() {
    document.getElementById('farmerRegistrationForm').parentElement.style.display = "";
    document.getElementById('registeredFarmersList').style.display = "none";
}

// --- Pagination, Search, and Render Table ---
function renderFarmersTable() {
    let farmers = getFarmers();
    // Search filter
    if (farmerListSearch) {
        const term = farmerListSearch.toLowerCase();
        farmers = farmers.filter(f => (
            f.farmerId.toLowerCase().includes(term) ||
            f.fullName.toLowerCase().includes(term) ||
            f.phoneNumber.includes(term) ||
            f.village.toLowerCase().includes(term)
        ));
    }
    const total = farmers.length;
    const totalPages = Math.ceil(total / farmersPerPage);
    const page = Math.min(Math.max(farmerListPage, 1), Math.max(totalPages, 1));
    const start = (page - 1) * farmersPerPage;
    const end = Math.min(start + farmersPerPage, total);

    // Render rows
    const tbody = document.getElementById('farmersTableBody');
    tbody.innerHTML = "";
    if (!farmers.length) {
        tbody.innerHTML = `<tr><td colspan="8" style="text-align:center;">No farmers found.</td></tr>`;
    } else {
        farmers.slice(start, end).forEach((f, idx) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${f.farmerId}</td>
                <td>${f.fullName}</td>
                <td>${f.phoneNumber}</td>
                <td>${f.village}</td>
                <td>${f.cattleCount}</td>
                <td>${f.milkProduction}</td>
                <td>${f.status || "Active"}</td>
                <td>
                    <button class="btn-primary" onclick="showFarmerDetails('${f.farmerId}')">View</button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }
    // Pagination info
    document.getElementById('farmerPaginationInfo').innerText = `Showing ${total ? start+1 : 0} to ${end} of ${total} farmers`;
    document.getElementById('prevPageBtn').disabled = (page <= 1);
    document.getElementById('nextPageBtn').disabled = (page >= totalPages);
}
function changePage(delta) {
    farmerListPage += delta;
    renderFarmersTable();
}
function searchFarmers() {
    farmerListSearch = document.getElementById('farmerSearch').value.trim();
    farmerListPage = 1;
    renderFarmersTable();
}

// --- Farmer Details Modal ---
function showFarmerDetails(farmerId) {
    const farmers = getFarmers();
    const farmer = farmers.find(f => f.farmerId === farmerId);
    if (!farmer) return;

    document.getElementById('farmerDetailsModal').style.display = "flex";
    document.getElementById('modalFarmerName').innerText = farmer.fullName;
    document.getElementById('editFarmerBtn').onclick = () => editFarmer(farmerId);
    document.getElementById('deleteFarmerBtn').onclick = () => deleteFarmer(farmerId);

    // Show all fields
    let content = `<table class="recent-orders" style="width:100%;">`;
    for (const key in farmer) {
        if (key === "status" || key === "farmerId") continue;
        let label = key.replace(/([A-Z])/g, " $1").replace(/^./, s=>s.toUpperCase());
        let val = Array.isArray(farmer[key]) ? farmer[key].join(", ") : farmer[key];
        content += `<tr><td style="font-weight:600;">${label}</td><td>${val ? val : '&mdash;'}</td></tr>`;
    }
    content += `<tr><td style="font-weight:600;">Status</td><td>${farmer.status}</td></tr>`;
    content += `</table>`;
    document.getElementById('farmerDetailsContent').innerHTML = content;
}
function closeFarmerModal() {
    document.getElementById('farmerDetailsModal').style.display = "none";
}

// --- Farmer Edit and Delete ---
function editFarmer(farmerId) {
    const farmers = getFarmers();
    const idx = farmers.findIndex(f => f.farmerId === farmerId);
    if (idx === -1) return alert("Farmer not found.");
    const f = farmers[idx];

    // Populate form with farmer data
    showRegistrationForm();
    document.getElementById('farmerId').value = f.farmerId;
    document.getElementById('registrationDate').value = f.registrationDate;
    document.getElementById('fullName').value = f.fullName;
    document.getElementById('gender').value = f.gender;
    document.getElementById('dob').value = f.dob;
    document.getElementById('aadharNumber').value = f.aadharNumber;
    document.getElementById('phoneNumber').value = f.phoneNumber;
    document.getElementById('email').value = f.email;
    document.getElementById('address').value = f.address;
    document.getElementById('village').value = f.village;
    document.getElementById('district').value = f.district;
    document.getElementById('state').value = f.state;
    document.getElementById('pincode').value = f.pincode;
    document.getElementById('farmName').value = f.farmName;
    document.getElementById('farmSize').value = f.farmSize;
    document.getElementById('cattleCount').value = f.cattleCount;
    document.getElementById('milkProduction').value = f.milkProduction;
    Array.from(document.getElementById('cattleBreeds').options).forEach(opt => {
        opt.selected = Array.isArray(f.cattleBreeds) && f.cattleBreeds.includes(opt.value);
    });
    document.getElementById('bankName').value = f.bankName;
    document.getElementById('accountNumber').value = f.accountNumber;
    document.getElementById('ifscCode').value = f.ifscCode;
    document.getElementById('accountHolder').value = f.accountHolder;
    // Note: file fields cannot be set for security reasons

    // Remove from array for update
    farmers.splice(idx, 1);
    setFarmers(farmers);
    closeFarmerModal();
    renderFarmersTable();
}

// Delete Farmer
function deleteFarmer(farmerId) {
    if (!confirm("Are you sure you want to delete this farmer?")) return;
    let farmers = getFarmers();
    farmers = farmers.filter(f => f.farmerId !== farmerId);
    setFarmers(farmers);
    closeFarmerModal();
    renderFarmersTable();
}

// --- Export and Print ---
function exportFarmersToExcel() {
    // Minimal CSV export
    const farmers = getFarmers();
    if (!farmers.length) return alert("No data to export.");
    const fields = ["farmerId", "fullName", "phoneNumber", "village", "cattleCount", "milkProduction", "status"];
    const csvRows = [
        fields.join(","),
        ...farmers.map(f => fields.map(k => `"${(f[k] || "").toString().replace(/"/g, '""')}"`).join(","))
    ];
    const blob = new Blob([csvRows.join("\n")], {type: "text/csv"});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = "farmers.csv";
    a.click();
}
function printFarmersList() {
    const farmers = getFarmers();
    let win = window.open('', '', 'width=900,height=700');
    win.document.write('<h2>Registered Farmers</h2>');
    win.document.write('<table border="1" cellspacing="0" cellpadding="8"><tr><th>Farmer ID</th><th>Name</th><th>Phone</th><th>Village</th><th>Cattle Count</th><th>Milk Production</th><th>Status</th></tr>');
    farmers.forEach(f => {
        win.document.write(`<tr>
            <td>${f.farmerId}</td>
            <td>${f.fullName}</td>
            <td>${f.phoneNumber}</td>
            <td>${f.village}</td>
            <td>${f.cattleCount}</td>
            <td>${f.milkProduction}</td>
            <td>${f.status || "Active"}</td>
        </tr>`);
    });
    win.document.write('</table>');
    win.print();
    win.close();
}

// --- Modal Logic ---
window.showFarmerList = showFarmerList;
window.showRegistrationForm = showRegistrationForm;
window.changePage = changePage;
window.showFarmerDetails = showFarmerDetails;
window.closeFarmerModal = closeFarmerModal;
window.searchFarmers = searchFarmers;
window.exportFarmersToExcel = exportFarmersToExcel;
window.printFarmersList = printFarmersList;
</script>


<script>
// Payment Methods Functions
function loadPayments() {
    const payments = JSON.parse(localStorage.getItem('payments')) || [
        {
            date: '2023-05-01',
            amount: '176.00',
            method: 'Credit Card',
            status: 'paid'
        },
        {
            date: '2023-04-01',
            amount: '168.00',
            method: 'Bank Transfer',
            status: 'paid'
        },
        {
            date: '2023-03-01',
            amount: '155.00',
            method: 'Cash',
            status: 'paid'
        },
        {
            date: '2023-06-01',
            amount: '185.00',
            method: '',
            status: 'pending'
        }
    ];

    const tbody = document.getElementById('paymentTableBody');
    tbody.innerHTML = '';

    payments.forEach(payment => {
        const row = document.createElement('tr');
        const dateObj = new Date(payment.date);
        const formattedDate = '#INV-' + dateObj.getFullYear() + '-' +
            (dateObj.getMonth() + 1).toString().padStart(2, '0') +
            '<br>' + dateObj.toLocaleDateString();
        const statusClass = payment.status === 'paid' ? 'completed' : 'pending';
        row.innerHTML = `
                            < td > ${ formattedDate }</td >
            <td>$${payment.amount}</td>
            <td>${payment.method}</td>
            <td><span class="status ${statusClass}">${payment.status.charAt(0).toUpperCase() + payment.status.slice(1)}</span></td>
            <td>
                ${payment.status === 'paid' ? 
                    '<button class="btn-primary view-receipt" data-id="' + payment.date + '">View Receipt</button>' : 
                    '<button class="btn-primary send-reminder" data-id="' + payment.date + '">Send Reminder</button>' + 
                    '<button class="btn-success record-payment" data-id="' + payment.date + '" style="margin-left: 5px;">Record Payment</button>'}
            </td>
                        `;
        tbody.appendChild(row);
    });
    document.querySelectorAll('.view-receipt').forEach(btn => {
        btn.addEventListener('click', function() {
            viewReceipt(this.getAttribute('data-id'));
        });
    });
    document.querySelectorAll('.send-reminder').forEach(btn => {
        btn.addEventListener('click', function() {
            sendReminder(this.getAttribute('data-id'));
        });
    });
    document.querySelectorAll('.record-payment').forEach(btn => {
        btn.addEventListener('click', function() {
            recordPayment(this.getAttribute('data-id'));
        });
    });
}
function showAddPaymentForm() {
    document.getElementById('addPaymentForm').style.display = 'block';
    document.getElementById('paymentDate').valueAsDate = new Date();
}
function hideAddPaymentForm() {
    document.getElementById('addPaymentForm').style.display = 'none';
    document.getElementById('addPaymentForm').reset();
}
function savePayment() {
    const payment = {
        date: document.getElementById('paymentDate').value,
        amount: document.getElementById('paymentAmount').value,
        method: document.getElementById('paymentMethod').value === 'credit' ? 'Credit Card' : 
                document.getElementById('paymentMethod').value === 'bank' ? 'Bank Transfer' : 
                document.getElementById('paymentMethod').value === 'cash' ? 'Cash' : 'Other',
        status: document.getElementById('paymentStatus').value
    };
    if (!payment.date || !payment.amount || !document.getElementById('paymentMethod').value || !payment.status) {
        alert('Please fill in all required fields');
        return;
    }
    const payments = JSON.parse(localStorage.getItem('payments')) || [];
    payments.push(payment);
    localStorage.setItem('payments', JSON.stringify(payments));
    loadPayments();
    hideAddPaymentForm();
}
function viewReceipt(paymentDate) {
    const payments = JSON.parse(localStorage.getItem('payments'));
    const payment = payments.find(p => p.date === paymentDate);
    if (payment) {
        alert(`Payment Receipt: \n\nDate: ${ new Date(payment.date).toLocaleDateString() } \nAmount: $${ payment.amount } \nMethod: ${ payment.method } \nStatus: ${ payment.status } `);
    }
}
function sendReminder(paymentDate) {
    const payments = JSON.parse(localStorage.getItem('payments'));
    const payment = payments.find(p => p.date === paymentDate);
    if (payment) {
        alert(`Reminder sent for payment due on ${ new Date(payment.date).toLocaleDateString() }`);
    }
}
function recordPayment(paymentDate) {
    const payments = JSON.parse(localStorage.getItem('payments'));
    const payment = payments.find(p => p.date === paymentDate);
    if (payment) {
        const method = prompt('Enter payment method (Credit Card, Bank Transfer, Cash, Other):');
        if (method) {
            payment.method = method;
            payment.status = 'paid';
            localStorage.setItem('payments', JSON.stringify(payments));
            loadPayments();
        }
    }
}
function exportPaymentsToPDF() {
    const paymentTable = document.getElementById('paymentTable');
    html2canvas(paymentTable).then(canvas => {
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
        const pageWidth = pdf.internal.pageSize.getWidth();
        const imgProps = pdf.getImageProperties(imgData);
        const pdfWidth = pageWidth;
        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
        pdf.addImage(imgData, 'PNG', 0, 10, pdfWidth, pdfHeight);
        pdf.save('payment-history.pdf');
    });
}
function generateInvoice() {
    alert('Invoice generation functionality would go here');
}
</script>


<script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const content = document.querySelector('.content-area');

    sidebar.classList.toggle('collapsed');
    content.classList.toggle('expanded');
}
</script>


<script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const content = document.querySelector('.content-area');

    if (sidebar.classList.contains('collapsed')) {
        sidebar.classList.remove('collapsed');
        content.classList.remove('expanded');
    } else {
        sidebar.classList.add('collapsed');
        content.classList.add('expanded');
    }
}
</script>




<script>
document.addEventListener('DOMContentLoaded', function () {
    const addDeliveryBtn = document.getElementById('addDeliveryBtn');
    const addDeliveryForm = document.getElementById('addDeliveryForm');
    const saveDeliveryBtn = document.getElementById('saveDeliveryBtn');
    const cancelDeliveryBtn = document.getElementById('cancelDeliveryBtn');
    const deliveryTableBody = document.getElementById('deliveryTableBody');

    addDeliveryBtn.addEventListener('click', function () {
        addDeliveryForm.style.display = 'block';
    });

    cancelDeliveryBtn.addEventListener('click', function () {
        addDeliveryForm.style.display = 'none';
        clearDeliveryForm();
    });

    saveDeliveryBtn.addEventListener('click', function () {
        const id = document.getElementById('deliveryID').value;
        const date = document.getElementById('deliveryDate').value;
        const customer = document.getElementById('customer').value;
        const products = document.getElementById('products').value;
        const quantity = document.getElementById('quantity').value;
        const status = document.getElementById('status').value;

        if (!id || !date || !customer || !products || !quantity || !status) {
            alert("Please fill all fields.");
            return;
        }

        const newRow = document.createElement('tr');
        newRow.innerHTML = `
                            < td > ${ id }</td >
            <td>${new Date(date).toLocaleDateString()}<br>${new Date(date).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</td>
            <td>${customer}</td>
            <td>${products}</td>
            <td>${quantity}</td>
            <td><span class="status ${status}">${capitalize(status)}</span></td>
            <td><button>View Details</button></td>
        `;
        deliveryTableBody.appendChild(newRow);

        addDeliveryForm.style.display = 'none';
        clearDeliveryForm();
    });

    function clearDeliveryForm() {
        document.getElementById('deliveryID').value = '';
        document.getElementById('deliveryDate').value = '';
        document.getElementById('customer').value = '';
        document.getElementById('products').value = '';
        document.getElementById('quantity').value = '';
        document.getElementById('status').value = '';
    }

    function capitalize(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
    }
});

// Initialize Product Inventory Charts
document.addEventListener('DOMContentLoaded', function() {
    if (document.getElementById('product-inventory-section')) {
        // Total Products Chart
        new Chart(document.getElementById('totalProductsChart').getContext('2d'), {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    data: [20, 22, 23, 25, 26, 28],
                    borderColor: '#0077b6',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { y: { display: false }, x: { display: false } }
            }
        });

        // Stock Value Chart
        new Chart(document.getElementById('stockValueChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    data: [1.8, 2.0, 2.2, 2.4, 2.6, 2.8],
                    backgroundColor: '#00b4d8',
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { y: { display: false }, x: { display: false } }
            }
        });

        // Stock Days Chart
        new Chart(document.getElementById('stockDaysChart').getContext('2d'), {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    data: [18, 17, 16, 15, 15, 14],
                    borderColor: '#2a9d8f',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { y: { display: false }, x: { display: false } }
            }
        });

        // Low Stock Chart
        new Chart(document.getElementById('lowStockChart').getContext('2d'), {
            type: 'doughnut',
            data: {
                labels: ['Normal', 'Low'],
                datasets: [{
                    data: [23, 5],
                    backgroundColor: ['#2a9d8f', '#e76f51'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                cutout: '70%'
            }
        });

        // Stock by Category Chart
        new Chart(document.getElementById('stockCategoryChart').getContext('2d'), {
            type: 'pie',
            data: {
                labels: ['Liquid Milk', 'Cheese', 'Dairy Fat', 'Fermented', 'Other'],
                datasets: [{
                    data: [45, 20, 15, 12, 8],
                    backgroundColor: ['#0077b6', '#00b4d8', '#2a9d8f', '#e9c46a', '#e76f51']
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right'
                    },
                    title: {
                        display: true,
                        text: 'Stock Distribution by Category',
                        font: { size: 14 }
                    }
                }
            }
        });

        // Inventory Turnover Chart
        new Chart(document.getElementById('inventoryTurnoverChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['Liquid Milk', 'Cheese', 'Dairy Fat', 'Fermented', 'Other'],
                datasets: [{
                    label: 'Turnover (Days)',
                    data: [7, 14, 21, 10, 15],
                    backgroundColor: ['#0077b6', '#00b4d8', '#2a9d8f', '#e9c46a', '#e76f51']
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: 'Average Inventory Turnover',
                        font: { size: 14 }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Days'
                        }
                    }
                }
            }
        });

        // Add Product button functionality
        document.getElementById('addInventoryBtn').addEventListener('click', function() {
            document.getElementById('addProductForm').style.display = 'block';
        });

        document.getElementById('closeProductForm').addEventListener('click', function() {
            document.getElementById('addProductForm').style.display = 'none';
        });

        document.getElementById('cancelProductForm').addEventListener('click', function() {
            document.getElementById('addProductForm').style.display = 'none';
        });

        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Product added successfully!');
            document.getElementById('productForm').reset();
            document.getElementById('addProductForm').style.display = 'none';
        });

        document.getElementById('inventoryFilter').addEventListener('change', function() {
            console.log('Filtering by:', this.value);
        });
        document.getElementById('inventoryTimeRange').addEventListener('change', function() {
            console.log('Loading data for:', this.value);
        });
        document.getElementById('exportMovementsBtn').addEventListener('click', function() {
            alert('Exporting inventory movements data...');
        });
        document.getElementById('viewAllExpiryBtn').addEventListener('click', function() {

            alert('Showing all products expiring soon...');
        });
    }
});




</script>

</body>

</html>